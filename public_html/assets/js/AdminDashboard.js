var qa=Object.defineProperty,Ga=Object.defineProperties;var Ya=Object.getOwnPropertyDescriptors;var ws=Object.getOwnPropertySymbols;var dt=Object.prototype.hasOwnProperty,ot=Object.prototype.propertyIsEnumerable;var it=(s,t,r)=>t in s?qa(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,x=(s,t)=>{for(var r in t||(t={}))dt.call(t,r)&&it(s,r,t[r]);if(ws)for(var r of ws(t))ot.call(t,r)&&it(s,r,t[r]);return s},S=(s,t)=>Ga(s,Ya(t));var X=(s,t)=>{var r={};for(var l in s)dt.call(s,l)&&t.indexOf(l)<0&&(r[l]=s[l]);if(s!=null&&ws)for(var l of ws(s))t.indexOf(l)<0&&ot.call(s,l)&&(r[l]=s[l]);return r};var ue=(s,t,r)=>new Promise((l,i)=>{var a=g=>{try{o(r.next(g))}catch(h){i(h)}},N=g=>{try{o(r.throw(g))}catch(h){i(h)}},o=g=>g.done?l(g.value):Promise.resolve(g.value).then(a,N);o((r=r.apply(s,t)).next())});import{c as Te,b as ve,r as c,j as e,d as E,s as Ss,T as Gs,e as Vs,f as ht,g as xt,h as ys,i as Ys,t as Ks,k as Ka,S as Qe,a as mt,D as ut}from"./index.js";import{S as Ts,A as qe,C as ye,a as Ge,c as Dt,R as Ha,W as Ja,b as Wa,T as Xa,D as Qa,d as Bt,P as Za,O as er,e as sr,f as De,g as Be,h as xe,i as q,j as Pe,k as M,E as rs,l as Ce,m as Fe,n as Se,o as Ee,p as ts,q as Hs,B as Es,r as Pt,s as ks,I as tr,t as ar,F as As,L as rr,u as lr,v as nr,N as cr}from"./NotificationsPage.js";import{C as V,b as me,a as z,B as G,u as Ue,c as Ie,d as It,e as Tt,f as Xs,g as gt}from"./card.js";import{B as le,C as $e}from"./badge.js";import{C as Le,T as He,P as Ze,a as ir,b as dr,S as zs,E as jt}from"./checkbox.js";import{L as $,S as ce,a as ie,b as de,c as oe,d as _,I as ae,e as Rs,f as je,u as kt,P as ze,g as or,h as hr,i as xr,j as Rt,k as Mt,l as mr,R as ur,A as gr,m as jr,n as pr,o as Nr,p as br,q as fr,F as vr,D as wr,C as yr,r as Cr,s as pt,t as Ye}from"./select.js";import{X as ds,U as pe}from"./x.js";import{U as Ke,S as Fr,P as Nt,C as bt}from"./StudentResultSheet.js";import{L as Ms,S as Re,T as $t,F as _t,a as Qs}from"./textarea.js";import{S as ls,a as ft,A as Cs,b as Fs,U as Sr}from"./avatar.js";import{A as cs,B as we}from"./book-open.js";import{G as Me,M as Er}from"./message-square.js";import{C as is,R as Ar}from"./refresh-cw.js";import{D as as}from"./download.js";import{D as Ds}from"./dollar-sign.js";import"./school.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dr=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Br=Te("activity",Dr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Ir=Te("arrow-left",Pr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tr=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],kr=Te("arrow-right",Tr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rr=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],Mr=Te("calculator",Rr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $r=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],Js=Te("database",$r);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _r=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],Lt=Te("ellipsis-vertical",_r);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lr=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],qs=Te("file-down",Lr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]],Ur=Te("key-round",Or);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Oe=Te("link",Vr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],qr=Te("list",zr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]],Yr=Te("unlink",Gr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=[["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m14.305 16.53.923-.382",key:"1itpsq"}],["path",{d:"m15.228 13.852-.923-.383",key:"eplpkm"}],["path",{d:"m16.852 12.228-.383-.923",key:"13v3q0"}],["path",{d:"m16.852 17.772-.383.924",key:"1i8mnm"}],["path",{d:"m19.148 12.228.383-.923",key:"1q8j1v"}],["path",{d:"m19.53 18.696-.382-.924",key:"vk1qj3"}],["path",{d:"m20.772 13.852.924-.383",key:"n880s0"}],["path",{d:"m20.772 16.148.924.383",key:"1g6xey"}],["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],vt=Te("user-cog",Kr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],_e=Te("user-plus",Hr);function Jr(){var H;const{addTeacher:s,addParent:t,addAccountant:r,addUser:l,classes:i}=ve(),[a,N]=c.useState(""),[o,g]=c.useState(""),[h,I]=c.useState(!1),[j,w]=c.useState({firstName:"",lastName:"",email:"",phone:"",username:"",password:"",qualification:"",employeeId:"",isClassTeacher:!1,classTeacherId:null,specialization:"",accountantId:"",department:"",employeeLevel:"",occupation:"",address:"",studentIds:[],dateOfBirth:"",gender:"",photoUrl:""}),b=C=>{var f;const O=(f=C.target.files)==null?void 0:f[0];if(O){if(!O.type.startsWith("image/")){E.error("Please upload an image file");return}if(O.size>5*1024*1024){E.error("Image size should be less than 5MB");return}const F=new FileReader;F.onloadend=()=>{const u=F.result;g(u),w(S(x({},j),{photoUrl:u}))},F.readAsDataURL(O)}},y=()=>{g(""),w(S(x({},j),{photoUrl:""}))},A=(C,O)=>{const f=[];switch((!C.fullName||C.fullName.trim().length<2)&&f.push("Full name is required (minimum 2 characters)"),(!C.email||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(C.email))&&f.push("Valid email address is required"),(!C.password||C.password.length<8)&&f.push("Password must be at least 8 characters long"),(!C.phone||C.phone.length<10)&&f.push("Valid phone number is required (minimum 10 digits)"),O){case"teacher":(!C.qualification||C.qualification.trim().length<2)&&f.push("Qualification is required for teachers"),(!C.employeeId||C.employeeId.trim().length<3)&&f.push("Employee ID is required for teachers (minimum 3 characters)"),C.isClassTeacher&&(!C.classTeacherId||C.classTeacherId<=0)&&f.push("Please select a valid class for class teacher assignment");break;case"parent":(!C.studentIds||C.studentIds.length===0)&&f.push("At least one student must be linked to parent account"),(!C.occupation||C.occupation.trim().length<2)&&f.push("Occupation is required for parents"),(!C.address||C.address.trim().length<10)&&f.push("Address is required for parents (minimum 10 characters)");break;case"accountant":(!C.employeeId||C.employeeId.trim().length<3)&&f.push("Employee ID is required for accountants (minimum 3 characters)"),(!C.department||C.department.trim().length<2)&&f.push("Department is required for accountants");break}return f},D=C=>ue(this,null,function*(){var O,f,F,u,T;if(C.preventDefault(),!a){E.error("Please select a role");return}I(!0);try{const L={fullName:`${j.firstName} ${j.lastName}`,email:j.email||"",phone:j.phone,password:j.password,role:a,status:"Active",photoUrl:j.photoUrl,dateOfBirth:j.dateOfBirth||null,gender:j.gender||null};a==="teacher"?(L.employeeId=j.employeeId||`TCH${Date.now()}`,L.qualification=j.qualification,L.specialization=j.specialization?[j.specialization]:[],L.isClassTeacher=j.isClassTeacher,L.classTeacherId=j.classTeacherId):a==="parent"?(L.studentIds=j.studentIds||[],L.occupation=j.occupation||"",L.address=j.address||""):a==="accountant"&&(L.employeeId=j.accountantId||`ACC${Date.now()}`,L.department=j.department,L.employeeLevel=j.employeeLevel||"Junior");const ee=A(L,a);if(ee.length>0){E.error(ee.join(`
`));return}yield l(L),E.success(`${a.charAt(0).toUpperCase()+a.slice(1)} registered successfully!`),w({firstName:"",lastName:"",email:"",phone:"",username:"",password:"",qualification:"",employeeId:"",isClassTeacher:!1,classTeacherId:null,accountantId:"",department:"",employeeLevel:"",occupation:"",address:"",studentIds:[],specialization:"",dateOfBirth:"",gender:"",photoUrl:""}),g(""),N("")}catch(L){let ee="Failed to register user. Please try again.";((O=L==null?void 0:L.response)==null?void 0:O.status)===409?ee="A user with this email already exists":((f=L==null?void 0:L.response)==null?void 0:f.status)===400?ee=((u=(F=L==null?void 0:L.response)==null?void 0:F.data)==null?void 0:u.message)||"Invalid data provided":((T=L==null?void 0:L.response)==null?void 0:T.status)>=500?ee="Server error occurred. Please try again later":L!=null&&L.message&&(ee=L.message),E.error(ee),console.error("Registration error:",L)}finally{I(!1)}}),v=()=>{w({firstName:"",lastName:"",email:"",phone:"",username:"",password:"",qualification:"",employeeId:"",isClassTeacher:!1,classTeacherId:null,accountantId:"",department:"",employeeLevel:"",occupation:"",address:"",studentIds:[],specialization:"",dateOfBirth:"",gender:"",photoUrl:""}),g(""),N("")};return e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-[#3B82F6] to-[#2563EB] flex items-center justify-center shadow-lg",children:e.jsx(_e,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-[#1F2937] mb-1",children:"Register User"}),e.jsx("p",{className:"text-[#6B7280]",children:"Register teachers, parents, or accountants with login credentials"})]})]})}),e.jsxs("form",{onSubmit:D,children:[e.jsxs(V,{className:"rounded-xl bg-white border border-[#E5E7EB] shadow-clinical hover:shadow-clinical-lg transition-all",children:[e.jsx(me,{className:"bg-gradient-to-r from-[#F9FAFB] to-white p-6 border-b border-[#E5E7EB]",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-[#3B82F6] flex items-center justify-center shadow-sm",children:e.jsx(_e,{className:"w-5 h-5 text-white"})}),e.jsx("h3",{className:"text-[#1F2937]",children:"User Information"})]})}),e.jsxs(z,{className:"p-8 space-y-8",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs($,{className:"text-[#1F2937]",children:["Select Role ",e.jsx("span",{className:"text-[#EF4444]",children:"*"})]}),e.jsxs(ce,{value:a,onValueChange:C=>N(C),children:[e.jsx(ie,{className:"h-14 rounded-xl border-2 border-[#E5E7EB] focus:border-[#3B82F6] bg-[#F9FAFB] text-[#1F2937] hover:bg-white transition-all shadow-sm",children:e.jsx(de,{placeholder:"Choose user role to continue"})}),e.jsxs(oe,{className:"bg-white border-[#E5E7EB] rounded-xl shadow-lg",children:[e.jsx(_,{value:"teacher",className:"text-[#1F2937] hover:bg-[#F9FAFB] rounded-lg m-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-[#10B981]"}),"Teacher"]})}),e.jsx(_,{value:"parent",className:"text-[#1F2937] hover:bg-[#F9FAFB] rounded-lg m-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-[#3B82F6]"}),"Parent/Guardian"]})}),e.jsx(_,{value:"accountant",className:"text-[#1F2937] hover:bg-[#F9FAFB] rounded-lg m-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-[#F59E0B]"}),"Accountant"]})})]})]}),e.jsx("p",{className:"text-xs text-[#6B7280]",children:"Select the role for the user you want to register"})]}),a&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-3 p-6 bg-[#F9FAFB] rounded-xl border-2 border-dashed border-[#E5E7EB]",children:[e.jsx($,{className:"text-[#1F2937]",children:"Profile Photo (Optional)"}),e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsx("div",{className:"flex-shrink-0",children:o?e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:o,alt:"Preview",className:"w-32 h-32 rounded-xl object-cover border-4 border-white shadow-lg ring-2 ring-[#3B82F6]/20"}),e.jsx("button",{type:"button",onClick:y,className:"absolute -top-2 -right-2 bg-[#EF4444] hover:bg-[#DC2626] text-white rounded-full p-2 shadow-lg opacity-0 group-hover:opacity-100 transition-all transform hover:scale-110",children:e.jsx(ds,{className:"w-4 h-4"})})]}):e.jsxs("div",{className:"w-32 h-32 rounded-xl border-2 border-dashed border-[#CBD5E1] flex flex-col items-center justify-center bg-white hover:border-[#3B82F6] transition-all group cursor-pointer",children:[e.jsx(Ke,{className:"w-8 h-8 text-[#94A3B8] group-hover:text-[#3B82F6] mb-2 transition-colors"}),e.jsx("span",{className:"text-xs text-[#6B7280]",children:"Click to upload"})]})}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsx("input",{type:"file",id:"photo-upload",accept:"image/*",onChange:b,className:"hidden"}),e.jsxs(G,{type:"button",variant:"outline",onClick:()=>{var C;return(C=document.getElementById("photo-upload"))==null?void 0:C.click()},className:"rounded-xl border-2 border-[#E5E7EB] text-[#1F2937] hover:bg-white hover:border-[#3B82F6] transition-all shadow-sm",children:[e.jsx(Ke,{className:"w-4 h-4 mr-2"}),o?"Change Photo":"Upload Photo"]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-[#6B7280]",children:"• Accepted formats: JPG, PNG, GIF"}),e.jsx("p",{className:"text-xs text-[#6B7280]",children:"• Maximum file size: 5MB"}),e.jsx("p",{className:"text-xs text-[#6B7280]",children:"• Recommended: Square image 500x500px"})]})]})]})]}),e.jsxs("div",{className:"space-y-4 pt-6 border-t-2 border-[#E5E7EB]",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-[#3B82F6]/10 flex items-center justify-center",children:e.jsx("span",{className:"text-[#3B82F6]",children:"1"})}),e.jsx("h4",{className:"text-[#1F2937]",children:"Personal Details"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{className:"text-[#1F2937]",children:["First Name ",e.jsx("span",{className:"text-[#EF4444]",children:"*"})]}),e.jsx(ae,{required:!0,value:j.firstName,onChange:C=>w(S(x({},j),{firstName:C.target.value})),placeholder:"Enter first name",className:"h-12 rounded-xl border-2 border-[#E5E7EB] focus:border-[#3B82F6] bg-white text-[#1F2937] transition-all"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{className:"text-[#1F2937]",children:["Last Name ",e.jsx("span",{className:"text-[#EF4444]",children:"*"})]}),e.jsx(ae,{required:!0,value:j.lastName,onChange:C=>w(S(x({},j),{lastName:C.target.value})),placeholder:"Enter last name",className:"h-12 rounded-xl border-2 border-[#E5E7EB] focus:border-[#3B82F6] bg-white text-[#1F2937] transition-all"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#1F2937]",children:"Email Address (Optional)"}),e.jsx(ae,{type:"email",value:j.email,onChange:C=>w(S(x({},j),{email:C.target.value})),placeholder:"email@example.com",className:"h-12 rounded-xl border-2 border-[#E5E7EB] focus:border-[#3B82F6] bg-white text-[#1F2937] transition-all"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{className:"text-[#1F2937]",children:["Phone Number ",e.jsx("span",{className:"text-[#EF4444]",children:"*"})]}),e.jsx(ae,{required:!0,type:"tel",value:j.phone,onChange:C=>w(S(x({},j),{phone:C.target.value})),placeholder:"080XXXXXXXX",className:"h-12 rounded-xl border-2 border-[#E5E7EB] focus:border-[#3B82F6] bg-white text-[#1F2937] transition-all"})]})]})]}),a==="teacher"&&e.jsxs("div",{className:"space-y-4 pt-6 border-t-2 border-[#E5E7EB]",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-[#10B981]/10 flex items-center justify-center",children:e.jsx("span",{className:"text-[#10B981]",children:"2"})}),e.jsx("h4",{className:"text-[#1F2937]",children:"Teacher Details"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{className:"text-[#1F2937]",children:["Employee ID ",e.jsx("span",{className:"text-[#EF4444]",children:"*"})]}),e.jsx(ae,{required:!0,value:j.employeeId,onChange:C=>w(S(x({},j),{employeeId:C.target.value})),placeholder:"e.g., GRA/T/001",className:"h-12 rounded-xl border-2 border-[#E5E7EB] focus:border-[#3B82F6] bg-white text-[#1F2937] transition-all"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{className:"text-[#1F2937]",children:["Qualification ",e.jsx("span",{className:"text-[#EF4444]",children:"*"})]}),e.jsxs(ce,{required:!0,value:j.qualification,onValueChange:C=>w(S(x({},j),{qualification:C})),children:[e.jsx(ie,{className:"h-12 rounded-xl border-2 border-[#E5E7EB] focus:border-[#3B82F6] bg-white text-[#1F2937] transition-all",children:e.jsx(de,{placeholder:"Select qualification"})}),e.jsxs(oe,{className:"bg-white border-[#E5E7EB] rounded-xl",children:[e.jsx(_,{value:"NCE",className:"text-[#1F2937] rounded-lg",children:"NCE"}),e.jsx(_,{value:"B.Ed",className:"text-[#1F2937] rounded-lg",children:"B.Ed"}),e.jsx(_,{value:"B.Sc",className:"text-[#1F2937] rounded-lg",children:"B.Sc"}),e.jsx(_,{value:"B.A",className:"text-[#1F2937] rounded-lg",children:"B.A"}),e.jsx(_,{value:"M.Ed",className:"text-[#1F2937] rounded-lg",children:"M.Ed"}),e.jsx(_,{value:"M.Sc",className:"text-[#1F2937] rounded-lg",children:"M.Sc"}),e.jsx(_,{value:"PhD",className:"text-[#1F2937] rounded-lg",children:"PhD"})]})]})]})]}),e.jsxs("div",{className:"p-6 bg-gradient-to-br from-[#EBF5FF] to-[#F0F9FF] rounded-xl border-2 border-[#BFDBFE] space-y-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Le,{id:"classTeacher",checked:j.isClassTeacher,onCheckedChange:C=>w(S(x({},j),{isClassTeacher:C,classTeacherId:C?j.classTeacherId:null})),className:"border-2 border-[#3B82F6] data-[state=checked]:bg-[#3B82F6]"}),e.jsx($,{htmlFor:"classTeacher",className:"text-[#1F2937] cursor-pointer",children:"Assign as Class Teacher"})]}),j.isClassTeacher&&e.jsxs("div",{className:"space-y-2 animate-in slide-in-from-top-2 duration-200",children:[e.jsxs($,{className:"text-[#1F2937]",children:["Assigned Class ",e.jsx("span",{className:"text-[#EF4444]",children:"*"})]}),e.jsxs(ce,{value:((H=j.classTeacherId)==null?void 0:H.toString())||"",onValueChange:C=>w(S(x({},j),{classTeacherId:parseInt(C)})),children:[e.jsx(ie,{className:"h-12 rounded-xl border-2 border-[#BFDBFE] focus:border-[#3B82F6] bg-white text-[#1F2937] transition-all",children:e.jsx(de,{placeholder:"Select class for this teacher"})}),e.jsx(oe,{className:"bg-white border-[#E5E7EB] rounded-xl",children:i.filter(C=>{var O;return((O=C.status)==null?void 0:O.toLowerCase())==="active"}).map(C=>e.jsx(_,{value:C.id.toString(),className:"text-[#1F2937] rounded-lg",children:C.name},C.id))})]})]})]})]}),a==="accountant"&&e.jsxs("div",{className:"space-y-4 pt-6 border-t-2 border-[#E5E7EB]",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-[#F59E0B]/10 flex items-center justify-center",children:e.jsx("span",{className:"text-[#F59E0B]",children:"2"})}),e.jsx("h4",{className:"text-[#1F2937]",children:"Accountant Details"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{className:"text-[#1F2937]",children:["Employee ID ",e.jsx("span",{className:"text-[#EF4444]",children:"*"})]}),e.jsx(ae,{required:!0,value:j.accountantId,onChange:C=>w(S(x({},j),{accountantId:C.target.value})),placeholder:"e.g., GRA/A/001",className:"h-12 rounded-xl border-2 border-[#E5E7EB] focus:border-[#3B82F6] bg-white text-[#1F2937] transition-all"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{className:"text-[#1F2937]",children:["Department ",e.jsx("span",{className:"text-[#EF4444]",children:"*"})]}),e.jsxs(ce,{required:!0,value:j.department,onValueChange:C=>w(S(x({},j),{department:C})),children:[e.jsx(ie,{className:"h-12 rounded-xl border-2 border-[#E5E7EB] focus:border-[#3B82F6] bg-white text-[#1F2937] transition-all",children:e.jsx(de,{placeholder:"Select department"})}),e.jsxs(oe,{className:"bg-white border-[#E5E7EB] rounded-xl",children:[e.jsx(_,{value:"Finance",className:"text-[#1F2937] rounded-lg",children:"Finance"}),e.jsx(_,{value:"Accounts",className:"text-[#1F2937] rounded-lg",children:"Accounts"}),e.jsx(_,{value:"Bursar",className:"text-[#1F2937] rounded-lg",children:"Bursar"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4 pt-6 border-t-2 border-[#E5E7EB]",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-[#8B5CF6]/10 flex items-center justify-center",children:e.jsx("span",{className:"text-[#8B5CF6]",children:a==="parent"?"2":"3"})}),e.jsx("h4",{className:"text-[#1F2937]",children:"Login Credentials"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{className:"text-[#1F2937]",children:["Username ",e.jsx("span",{className:"text-[#EF4444]",children:"*"})]}),e.jsx(ae,{required:!0,value:j.username,onChange:C=>w(S(x({},j),{username:C.target.value})),placeholder:"Username for login",className:"h-12 rounded-xl border-2 border-[#E5E7EB] focus:border-[#3B82F6] bg-white text-[#1F2937] transition-all"}),e.jsx("p",{className:"text-xs text-[#6B7280]",children:"This will be used for system login"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{className:"text-[#1F2937]",children:["Password ",e.jsx("span",{className:"text-[#EF4444]",children:"*"})]}),e.jsx(ae,{required:!0,type:"password",value:j.password,onChange:C=>w(S(x({},j),{password:C.target.value})),placeholder:"Initial password",className:"h-12 rounded-xl border-2 border-[#E5E7EB] focus:border-[#3B82F6] bg-white text-[#1F2937] transition-all"}),e.jsx("p",{className:"text-xs text-[#6B7280]",children:"User can change this after first login"})]})]})]})]})]})]}),a&&e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 mt-8 p-6 bg-[#F9FAFB] rounded-xl border border-[#E5E7EB]",children:[e.jsx("p",{className:"text-sm text-[#6B7280]",children:"Please review all information before submitting"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(G,{type:"button",onClick:v,variant:"outline",className:"rounded-xl border-2 border-[#E5E7EB] text-[#1F2937] hover:bg-white hover:border-[#CBD5E1] transition-all h-12 px-6",children:"Reset Form"}),e.jsx(G,{type:"submit",disabled:h,className:"bg-gradient-to-r from-[#10B981] to-[#059669] hover:from-[#059669] hover:to-[#047857] text-white rounded-xl shadow-lg hover:shadow-xl transition-all h-12 px-8 hover-lift disabled:opacity-50 disabled:cursor-not-allowed",children:h?e.jsxs(e.Fragment,{children:[e.jsx(Ms,{className:"w-5 h-5 mr-2 animate-spin"}),"Registering..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ts,{className:"w-5 h-5 mr-2"}),"Register ",a.charAt(0).toUpperCase()+a.slice(1)]})})]})]})]})]})}function Wr(){var O;const{classes:s,parents:t,addStudent:r,currentAcademicYear:l,students:i}=ve(),[a,N]=c.useState({firstName:"",lastName:"",dateOfBirth:"",gender:"",classId:"",parentId:"",photoUrl:"",phone:""}),[o,g]=c.useState(""),[h,I]=c.useState({}),[j,w]=c.useState(!1),b=f=>{const F={};if(f.firstName.trim()?f.firstName.trim().length<2?F.firstName="First name must be at least 2 characters":/^[a-zA-Z\s]+$/.test(f.firstName.trim())||(F.firstName="First name can only contain letters and spaces"):F.firstName="First name is required",f.lastName.trim()?f.lastName.trim().length<2?F.lastName="Last name must be at least 2 characters":/^[a-zA-Z\s]+$/.test(f.lastName.trim())||(F.lastName="Last name can only contain letters and spaces"):F.lastName="Last name is required",!f.dateOfBirth)F.dateOfBirth="Date of birth is required";else{const u=new Date(f.dateOfBirth),T=new Date,L=T.getFullYear()-u.getFullYear(),ee=T.getMonth()-u.getMonth();u>T?F.dateOfBirth="Date of birth cannot be in the future":L<5||L===5&&ee<0?F.dateOfBirth="Student must be at least 5 years old":(L>25||L===25&&ee>0)&&(F.dateOfBirth="Student age seems incorrect (too old)")}return f.gender||(F.gender="Gender is required"),f.phone&&f.phone.trim()&&(/^[0-9+\-\s()]+$/.test(f.phone.trim())?f.phone.replace(/\D/g,"").length<10&&(F.phone="Phone number must have at least 10 digits"):F.phone="Invalid phone number format"),F},y=f=>{var u;const F=(u=f.target.files)==null?void 0:u[0];if(F){if(!F.type.startsWith("image/")){E.error("Please upload an image file");return}if(F.size>5*1024*1024){E.error("Image size should be less than 5MB");return}const T=new FileReader;T.onloadend=()=>{const L=T.result;g(L),N(S(x({},a),{photoUrl:L}))},T.readAsDataURL(F)}},A=()=>{g(""),N(S(x({},a),{photoUrl:""}))},D=()=>{const f=new Date().getFullYear().toString().slice(-2),F=Math.floor(1e3+Math.random()*9e3);return`STU${f}${F}`},v=()=>{const f=b(a);return a.classId||(f.classId="Class is required"),a.parentId&&a.parentId!=="none"&&(t.find(u=>u.id===parseInt(a.parentId))||(f.parentId="Invalid parent selected")),Object.keys(f).length>0?(I(f),!1):!0},H=f=>ue(this,null,function*(){var u,T,L,ee,K,re,ge,he,se;if(f.preventDefault(),!v()){E.error("Please fix all validation errors");return}const F=s.find(Z=>Z.id===parseInt(a.classId));if(!F){E.error("Invalid class selected");return}if(F.capacity&&F.currentStudents&&F.currentStudents>=F.capacity){E.error("Selected class has reached maximum capacity");return}w(!0);try{const Z=D(),U={admissionNumber:Z,firstName:a.firstName.trim(),lastName:a.lastName.trim(),dateOfBirth:a.dateOfBirth,gender:a.gender==="Male"||a.gender==="Female"?a.gender:"Male",classId:parseInt(a.classId),parentId:a.parentId&&a.parentId!=="none"?parseInt(a.parentId):null,photoUrl:a.photoUrl||void 0,phone:a.phone||void 0,status:"Active"};yield Ss.create(U),E.success(`Student registered successfully! Admission Number: ${Z}`),N({firstName:"",lastName:"",dateOfBirth:"",gender:"",classId:"",parentId:"",photoUrl:"",phone:""}),g(""),I({})}catch(Z){if(console.error("Error creating student:",Z),((u=Z==null?void 0:Z.response)==null?void 0:u.status)===409)E.error("Registration number already exists. Please try again.");else if(((T=Z==null?void 0:Z.response)==null?void 0:T.status)===400){const U=((ee=(L=Z==null?void 0:Z.response)==null?void 0:L.data)==null?void 0:ee.errors)||{};Object.keys(U).length>0?(I(U),E.error("Please fix the validation errors")):E.error(((re=(K=Z==null?void 0:Z.response)==null?void 0:K.data)==null?void 0:re.message)||"Invalid student data")}else if(((ge=Z==null?void 0:Z.response)==null?void 0:ge.status)===422)E.error("Class has reached maximum capacity");else{const U=((se=(he=Z==null?void 0:Z.response)==null?void 0:he.data)==null?void 0:se.message)||(Z==null?void 0:Z.message)||"Failed to register student. Please try again.";E.error(U)}}finally{w(!1)}}),C=()=>{N({firstName:"",lastName:"",dateOfBirth:"",gender:"",classId:"",parentId:"",photoUrl:"",phone:""}),g(""),I({})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl text-gray-900 mb-2",children:"Register New Student"}),e.jsx("p",{className:"text-gray-600",children:"Add a new student to the school management system"})]}),e.jsxs(qe,{className:"bg-blue-50 border-blue-200 rounded-xl",children:[e.jsx(ye,{className:"h-4 w-4 text-blue-600"}),e.jsxs(Ge,{className:"text-gray-900",children:[e.jsx("strong",{children:"Student Registration Process:"}),e.jsx("br",{}),"1. Enter student personal information",e.jsx("br",{}),"2. Assign to a class (determines fee structure)",e.jsx("br",{}),"3. Optionally link to existing parent",e.jsx("br",{}),"4. Admission number will be auto-generated",e.jsx("br",{}),'• You can link parent later from "Link Student-Parent" page']})]}),e.jsxs("form",{onSubmit:H,children:[e.jsxs(V,{className:"rounded-xl bg-white border border-gray-200 shadow-sm",children:[e.jsx(me,{className:"p-5 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"w-5 h-5 text-[#2563EB]"}),e.jsx("h3",{className:"text-lg text-gray-900",children:"Student Information"})]})}),e.jsxs(z,{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-md text-gray-900 font-medium",children:"Personal Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-gray-700",children:"Student Photo (Optional)"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:o?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:o,alt:"Student preview",className:"w-32 h-32 rounded-xl object-cover border-2 border-gray-300"}),e.jsx("button",{type:"button",onClick:A,className:"absolute -top-2 -right-2 bg-red-500 hover:bg-red-600 text-white rounded-full p-1 shadow-md",children:e.jsx(ds,{className:"w-4 h-4"})})]}):e.jsx("div",{className:"w-32 h-32 rounded-xl border-2 border-dashed border-gray-300 flex items-center justify-center bg-gray-50",children:e.jsx(Ke,{className:"w-8 h-8 text-gray-400"})})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("input",{type:"file",id:"photo-upload",accept:"image/*",onChange:y,className:"hidden"}),e.jsxs(G,{type:"button",variant:"outline",onClick:()=>{var f;return(f=document.getElementById("photo-upload"))==null?void 0:f.click()},className:"rounded-xl border-gray-300 text-gray-700 hover:bg-gray-50",children:[e.jsx(Ke,{className:"w-4 h-4 mr-2"}),o?"Change Photo":"Upload Photo"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Upload a passport-size photo (JPG, PNG). Max size: 5MB"})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{className:"text-gray-700",children:["First Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ae,{placeholder:"Enter first name",value:a.firstName,onChange:f=>N(S(x({},a),{firstName:f.target.value})),className:`h-12 rounded-xl border ${h.firstName?"border-red-500":"border-gray-300"} bg-white text-gray-900`}),h.firstName&&e.jsx("p",{className:"text-xs text-red-500",children:h.firstName})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{className:"text-gray-700",children:["Last Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ae,{placeholder:"Enter last name",value:a.lastName,onChange:f=>N(S(x({},a),{lastName:f.target.value})),className:`h-12 rounded-xl border ${h.lastName?"border-red-500":"border-gray-300"} bg-white text-gray-900`}),h.lastName&&e.jsx("p",{className:"text-xs text-red-500",children:h.lastName})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{className:"text-gray-700",children:["Date of Birth ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ae,{type:"date",value:a.dateOfBirth,onChange:f=>N(S(x({},a),{dateOfBirth:f.target.value})),className:`h-12 rounded-xl border ${h.dateOfBirth?"border-red-500":"border-gray-300"} bg-white text-gray-900`}),h.dateOfBirth&&e.jsx("p",{className:"text-xs text-red-500",children:h.dateOfBirth})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{className:"text-gray-700",children:["Gender ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(ce,{value:a.gender,onValueChange:f=>N(S(x({},a),{gender:f})),children:[e.jsx(ie,{className:`h-12 rounded-xl border ${h.gender?"border-red-500":"border-gray-300"} bg-white text-gray-900`,children:e.jsx(de,{placeholder:"Select gender"})}),e.jsxs(oe,{className:"bg-white border-gray-200",children:[e.jsx(_,{value:"Male",className:"text-gray-900",children:"Male"}),e.jsx(_,{value:"Female",className:"text-gray-900",children:"Female"})]})]}),h.gender&&e.jsx("p",{className:"text-xs text-red-500",children:h.gender})]})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-200",children:[e.jsx("h4",{className:"text-md text-gray-900 font-medium",children:"Academic Details"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{className:"text-gray-700",children:["Assign to Class ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(ce,{value:a.classId,onValueChange:f=>N(S(x({},a),{classId:f})),children:[e.jsx(ie,{className:`h-12 rounded-xl border ${h.classId?"border-red-500":"border-gray-300"} bg-white text-gray-900`,children:e.jsx(de,{placeholder:"Select class"})}),e.jsx(oe,{className:"bg-white border-gray-200",children:s.filter(f=>f.status.toLowerCase()==="active").map(f=>e.jsxs(_,{value:f.id.toString(),className:"text-gray-900",children:[f.name," - ",f.level," (",f.currentStudents,"/",f.capacity," students)"]},f.id))})]}),h.classId&&e.jsx("p",{className:"text-xs text-red-500",children:h.classId})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-gray-700",children:"Phone Number (Optional)"}),e.jsx(ae,{placeholder:"Enter phone number",value:a.phone,onChange:f=>N(S(x({},a),{phone:f.target.value})),className:`h-12 rounded-xl border ${h.phone?"border-red-500":"border-gray-300"} bg-white text-gray-900`}),h.phone&&e.jsx("p",{className:"text-xs text-red-500",children:h.phone})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-gray-700",children:"Academic Year"}),e.jsx(ae,{value:l,disabled:!0,className:"h-12 rounded-xl border border-gray-300 bg-gray-100 text-gray-900"})]})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-200",children:[e.jsx("h4",{className:"text-md text-gray-900 font-medium",children:"Parent/Guardian Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-gray-700",children:"Link to Existing Parent (Optional)"}),e.jsxs(ce,{value:a.parentId,onValueChange:f=>N(S(x({},a),{parentId:f})),children:[e.jsx(ie,{className:"h-12 rounded-xl border border-gray-300 bg-white text-gray-900",children:e.jsx(de,{placeholder:"Select parent (optional)"})}),e.jsxs(oe,{className:"bg-white border-gray-200",children:[e.jsx(_,{value:"none",className:"text-gray-900",children:"No parent linked"}),t.filter(f=>f.status.toLowerCase()==="active").map(f=>e.jsxs(_,{value:f.id.toString(),className:"text-gray-900",children:[f.firstName," ",f.lastName," - ",f.phone]},f.id))]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:'You can link parent now or later from "Link Student-Parent" page'})]})]}),a.firstName&&a.lastName&&e.jsxs("div",{className:"p-4 bg-blue-50 rounded-xl border border-blue-200",children:[e.jsx("p",{className:"text-sm text-gray-700",children:e.jsx("strong",{children:"Preview:"})}),e.jsxs("p",{className:"text-gray-900",children:["Student: ",a.firstName," ",a.lastName]}),a.classId&&e.jsxs("p",{className:"text-gray-600 text-sm",children:["Class: ",(O=s.find(f=>f.id===parseInt(a.classId)))==null?void 0:O.name]}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["Admission Number: ",D()," (will be auto-generated)"]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(G,{type:"button",onClick:C,variant:"outline",className:"rounded-xl border-gray-300 text-gray-700 hover:bg-gray-50",children:"Reset Form"}),e.jsx(G,{type:"submit",disabled:j,className:"bg-[#10B981] hover:bg-[#059669] text-white rounded-xl shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",children:j?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 mr-2 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Registering..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Register Student"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(V,{className:"rounded-xl bg-white border border-gray-200 shadow-sm",children:e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Students"}),e.jsx(pe,{className:"w-5 h-5 text-[#2563EB]"})]}),e.jsx("p",{className:"text-2xl text-gray-900",children:i.length})]})}),e.jsx(V,{className:"rounded-xl bg-white border border-gray-200 shadow-sm",children:e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Active Classes"}),e.jsx(pe,{className:"w-5 h-5 text-[#10B981]"})]}),e.jsx("p",{className:"text-2xl text-gray-900",children:s.filter(f=>f.status.toLowerCase()==="active").length})]})}),e.jsx(V,{className:"rounded-xl bg-white border border-gray-200 shadow-sm",children:e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Registered Parents"}),e.jsx(pe,{className:"w-5 h-5 text-[#3B82F6]"})]}),e.jsx("p",{className:"text-2xl text-gray-900",children:t.length})]})})]})]})}var Xr=Symbol("radix.slottable");function Qr(s){const t=({children:r})=>e.jsx(e.Fragment,{children:r});return t.displayName=`${s}.Slottable`,t.__radixId=Xr,t}var Ot="AlertDialog",[Zr]=Rs(Ot,[Dt]),Ve=Dt(),Ut=s=>{const i=s,{__scopeAlertDialog:t}=i,r=X(i,["__scopeAlertDialog"]),l=Ve(t);return e.jsx(Ha,S(x(x({},l),r),{modal:!0}))};Ut.displayName=Ot;var el="AlertDialogTrigger",sl=c.forwardRef((s,t)=>{const a=s,{__scopeAlertDialog:r}=a,l=X(a,["__scopeAlertDialog"]),i=Ve(r);return e.jsx(sr,S(x(x({},i),l),{ref:t}))});sl.displayName=el;var tl="AlertDialogPortal",Vt=s=>{const i=s,{__scopeAlertDialog:t}=i,r=X(i,["__scopeAlertDialog"]),l=Ve(t);return e.jsx(Za,x(x({},l),r))};Vt.displayName=tl;var al="AlertDialogOverlay",zt=c.forwardRef((s,t)=>{const a=s,{__scopeAlertDialog:r}=a,l=X(a,["__scopeAlertDialog"]),i=Ve(r);return e.jsx(er,S(x(x({},i),l),{ref:t}))});zt.displayName=al;var es="AlertDialogContent",[rl,ll]=Zr(es),nl=Qr("AlertDialogContent"),qt=c.forwardRef((s,t)=>{const h=s,{__scopeAlertDialog:r,children:l}=h,i=X(h,["__scopeAlertDialog","children"]),a=Ve(r),N=c.useRef(null),o=Ue(t,N),g=c.useRef(null);return e.jsx(Ja,{contentName:es,titleName:Gt,docsSlug:"alert-dialog",children:e.jsx(rl,{scope:r,cancelRef:g,children:e.jsxs(Wa,S(x(x({role:"alertdialog"},a),i),{ref:o,onOpenAutoFocus:je(i.onOpenAutoFocus,I=>{var j;I.preventDefault(),(j=g.current)==null||j.focus({preventScroll:!0})}),onPointerDownOutside:I=>I.preventDefault(),onInteractOutside:I=>I.preventDefault(),children:[e.jsx(nl,{children:l}),e.jsx(il,{contentRef:N})]}))})})});qt.displayName=es;var Gt="AlertDialogTitle",Yt=c.forwardRef((s,t)=>{const a=s,{__scopeAlertDialog:r}=a,l=X(a,["__scopeAlertDialog"]),i=Ve(r);return e.jsx(Xa,S(x(x({},i),l),{ref:t}))});Yt.displayName=Gt;var Kt="AlertDialogDescription",Ht=c.forwardRef((s,t)=>{const a=s,{__scopeAlertDialog:r}=a,l=X(a,["__scopeAlertDialog"]),i=Ve(r);return e.jsx(Qa,S(x(x({},i),l),{ref:t}))});Ht.displayName=Kt;var cl="AlertDialogAction",Jt=c.forwardRef((s,t)=>{const a=s,{__scopeAlertDialog:r}=a,l=X(a,["__scopeAlertDialog"]),i=Ve(r);return e.jsx(Bt,S(x(x({},i),l),{ref:t}))});Jt.displayName=cl;var Wt="AlertDialogCancel",Xt=c.forwardRef((s,t)=>{const o=s,{__scopeAlertDialog:r}=o,l=X(o,["__scopeAlertDialog"]),{cancelRef:i}=ll(Wt,r),a=Ve(r),N=Ue(t,i);return e.jsx(Bt,S(x(x({},a),l),{ref:N}))});Xt.displayName=Wt;var il=({contentRef:s})=>{const t=`\`${es}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${es}\` by passing a \`${Kt}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${es}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return c.useEffect(()=>{var l;document.getElementById((l=s.current)==null?void 0:l.getAttribute("aria-describedby"))||console.warn(t)},[t,s]),null},dl=Ut,ol=Vt,hl=zt,xl=qt,ml=Jt,ul=Xt,gl=Yt,jl=Ht;function xs(t){var s=X(t,[]);return e.jsx(dl,x({"data-slot":"alert-dialog"},s))}function pl(t){var s=X(t,[]);return e.jsx(ol,x({"data-slot":"alert-dialog-portal"},s))}function Nl(r){var l=r,{className:s}=l,t=X(l,["className"]);return e.jsx(hl,x({"data-slot":"alert-dialog-overlay",className:Ie("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s)},t))}function ms(r){var l=r,{className:s}=l,t=X(l,["className"]);return e.jsxs(pl,{children:[e.jsx(Nl,{}),e.jsx(xl,x({"data-slot":"alert-dialog-content",className:Ie("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s)},t))]})}function us(r){var l=r,{className:s}=l,t=X(l,["className"]);return e.jsx("div",x({"data-slot":"alert-dialog-header",className:Ie("flex flex-col gap-2 text-center sm:text-left",s)},t))}function gs(r){var l=r,{className:s}=l,t=X(l,["className"]);return e.jsx("div",x({"data-slot":"alert-dialog-footer",className:Ie("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s)},t))}function js(r){var l=r,{className:s}=l,t=X(l,["className"]);return e.jsx(gl,x({"data-slot":"alert-dialog-title",className:Ie("text-lg font-semibold",s)},t))}function ps(r){var l=r,{className:s}=l,t=X(l,["className"]);return e.jsx(jl,x({"data-slot":"alert-dialog-description",className:Ie("text-muted-foreground text-sm",s)},t))}function Ns(r){var l=r,{className:s}=l,t=X(l,["className"]);return e.jsx(ml,x({className:Ie(It(),s)},t))}function bs(r){var l=r,{className:s}=l,t=X(l,["className"]);return e.jsx(ul,x({className:Ie(It({variant:"outline"}),s)},t))}function wt({onNavigateToLink:s}){const{students:t,classes:r,addStudent:l,updateStudent:i,deleteStudent:a,parents:N}=ve(),[o,g]=c.useState(!0),[h,I]=c.useState(""),[j,w]=c.useState(""),[b,y]=c.useState(null),[A,D]=c.useState(!1),[v,H]=c.useState(!1),[C,O]=c.useState(!1),[f,F]=c.useState(null),[u,T]=c.useState(!1),[L,ee]=c.useState(!1),[K,re]=c.useState({}),ge=n=>{if(!n)return null;const m=N.find(P=>P.id===n);return m?`${m.firstName} ${m.lastName}`:null},he=t.filter(n=>{var J;const m=!h||`${n.firstName} ${n.lastName}`.toLowerCase().includes(h.toLowerCase())||n.admissionNumber.toLowerCase().includes(h.toLowerCase())||n.className.toLowerCase().includes(h.toLowerCase()),P=!j||((J=n.classId)==null?void 0:J.toString())===j.toString();return m&&P}),[se,Z]=c.useState({firstName:"",lastName:"",admissionNumber:"",classId:"",gender:"",dateOfBirth:"",status:"Active"}),U=n=>{y(n),D(!0)},d=n=>{var m;y(n),Z({firstName:n.firstName||"",lastName:n.lastName||"",admissionNumber:n.admissionNumber||"",classId:((m=n.classId)==null?void 0:m.toString())||"",gender:n.gender||"",dateOfBirth:n.dateOfBirth||"",status:n.status||"Active"}),H(!0)},B=(n,m)=>{F({id:n,name:m}),O(!0)},k=()=>ue(this,null,function*(){var n,m;if(f){T(!0);try{yield a(f.id),E.success(`${f.name} has been deleted successfully`),O(!1),F(null)}catch(P){console.error("Error deleting student:",P);const J=((m=(n=P==null?void 0:P.response)==null?void 0:n.data)==null?void 0:m.message)||(P==null?void 0:P.message)||"Failed to delete student";E.error(J)}finally{T(!1)}}}),p=()=>{O(!1),F(null)},Q=()=>{const n={};if(se.firstName.trim()?se.firstName.trim().length<2&&(n.firstName="First name must be at least 2 characters"):n.firstName="First name is required",se.lastName.trim()?se.lastName.trim().length<2&&(n.lastName="Last name must be at least 2 characters"):n.lastName="Last name is required",se.admissionNumber.trim()||(n.admissionNumber="Admission number is required"),se.gender||(n.gender="Gender is required"),!se.dateOfBirth)n.dateOfBirth="Date of birth is required";else{const m=new Date(se.dateOfBirth),J=new Date().getFullYear()-m.getFullYear();(J<3||J>25)&&(n.dateOfBirth="Student age should be between 3 and 25 years")}return re(n),Object.keys(n).length===0},W=()=>ue(this,null,function*(){var n,m;if(!b||!Q()){E.error("Please fix all validation errors");return}ee(!0);try{const P={firstName:se.firstName.trim(),lastName:se.lastName.trim(),admissionNumber:se.admissionNumber.trim(),classId:se.classId?parseInt(se.classId):void 0,gender:se.gender,dateOfBirth:se.dateOfBirth,status:se.status};yield i(b.id,P),E.success("Student information updated successfully"),H(!1),re({})}catch(P){console.error("Error updating student:",P);const J=((m=(n=P==null?void 0:P.response)==null?void 0:n.data)==null?void 0:m.message)||(P==null?void 0:P.message)||"Failed to update student";E.error(J)}finally{ee(!1)}}),R=()=>{s?s():E.info("Navigating to Link Student-Parent page")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-white mb-2",children:"Manage Students"}),e.jsx("p",{className:"text-[#C0C8D3]",children:"View, edit, and manage all registered students"})]}),e.jsxs(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:[e.jsx(me,{className:"p-5 border-b border-white/10",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Re,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#C0C8D3]"}),e.jsx(ae,{value:h,onChange:n=>I(n.target.value),placeholder:"Search by name or admission number...",className:"h-12 pl-10 rounded-xl border border-white/10 bg-[#0F243E] text-white"})]}),e.jsxs("div",{className:"flex gap-3 w-full md:w-auto",children:[e.jsxs(ce,{value:String(j),onValueChange:n=>w(n),children:[e.jsx(ie,{className:"h-12 w-full md:w-40 rounded-xl border border-white/10 bg-[#0F243E] text-white",children:e.jsx(de,{placeholder:"Filter by class"})}),e.jsxs(oe,{className:"bg-[#0F243E] border-white/10",children:[e.jsx(_,{value:"all",className:"text-white hover:bg-[#1E90FF]",children:"All Classes"}),e.jsx(_,{value:"Primary",className:"text-white hover:bg-[#1E90FF]",children:"Primary"}),e.jsx(_,{value:"JSS",className:"text-white hover:bg-[#1E90FF]",children:"JSS"}),e.jsx(_,{value:"SS",className:"text-white hover:bg-[#1E90FF]",children:"SS"})]})]}),e.jsxs(G,{onClick:R,className:"h-12 bg-[#28A745] hover:bg-[#28A745]/90 text-white rounded-xl shadow-md hover:scale-105 transition-all whitespace-nowrap",children:[e.jsx(Oe,{className:"w-5 h-5 mr-2"}),"Link to Parent"]}),e.jsxs(G,{onClick:()=>E.info("Navigate to Add Student page"),className:"h-12 bg-[#1E90FF] hover:bg-[#00BFFF] text-white rounded-xl shadow-md hover:scale-105 transition-all whitespace-nowrap",children:[e.jsx(_e,{className:"w-5 h-5 mr-2"}),"Add New"]})]})]})}),e.jsx(z,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(De,{children:[e.jsx(Be,{children:e.jsxs(xe,{className:"bg-gradient-to-r from-[#1E90FF] to-[#00BFFF] border-none hover:bg-gradient-to-r",children:[e.jsx(q,{className:"text-white",children:"Admission No."}),e.jsx(q,{className:"text-white",children:"Student Name"}),e.jsx(q,{className:"text-white",children:"Class"}),e.jsx(q,{className:"text-white",children:"Parent/Guardian"}),e.jsx(q,{className:"text-white",children:"Status"}),e.jsx(q,{className:"text-white text-center",children:"Actions"})]})}),e.jsx(Pe,{children:o?e.jsx(xe,{children:e.jsxs(M,{colSpan:6,className:"text-center py-8",children:[e.jsx(Ms,{className:"w-8 h-8 animate-spin mx-auto text-[#1E90FF]"}),e.jsx("p",{className:"text-[#C0C8D3] mt-2",children:"Loading students..."})]})}):t.length===0?e.jsx(xe,{children:e.jsx(M,{colSpan:6,className:"text-center py-8",children:e.jsx("p",{className:"text-[#C0C8D3]",children:"No students found"})})}):he.map(n=>e.jsxs(xe,{className:"bg-[#0F243E] border-b border-white/5 hover:bg-[#132C4A]",children:[e.jsx(M,{className:"text-[#C0C8D3]",children:n.admissionNumber||"N/A"}),e.jsx(M,{className:"text-white",children:`${n.firstName} ${n.lastName}`}),e.jsx(M,{className:"text-[#C0C8D3]",children:n.className||"N/A"}),e.jsx(M,{className:"text-[#C0C8D3]",children:ge(n.parentId)||"Not linked"}),e.jsx(M,{children:e.jsx(le,{className:n.status==="Active"?"bg-[#28A745] text-white border-0":"bg-[#DC3545] text-white border-0",children:n.status||"Active"})}),e.jsx(M,{children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(G,{onClick:()=>U(n),size:"sm",className:"h-8 w-8 p-0 bg-[#1E90FF] hover:bg-[#00BFFF] rounded-lg",title:"View Details",children:e.jsx(rs,{className:"w-4 h-4"})}),e.jsx(G,{onClick:R,size:"sm",className:"h-8 w-8 p-0 bg-[#28A745] hover:bg-[#28A745]/90 rounded-lg",title:"Link to Parent",children:e.jsx(Oe,{className:"w-4 h-4"})}),e.jsx(G,{onClick:()=>d(n),size:"sm",className:"h-8 w-8 p-0 bg-[#FFC107] hover:bg-[#FFC107]/90 rounded-lg",title:"Edit Student",children:e.jsx(ls,{className:"w-4 h-4"})}),e.jsx(G,{onClick:()=>B(n.id,n.firstName+" "+n.lastName),size:"sm",className:"h-8 w-8 p-0 bg-[#DC3545] hover:bg-[#DC3545]/90 rounded-lg",title:"Delete Student",children:e.jsx(He,{className:"w-4 h-4"})})]})})]},n.id))})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:e.jsxs(z,{className:"p-4",children:[e.jsx("p",{className:"text-[#C0C8D3] mb-1",children:"Total Students"}),e.jsx("p",{className:"text-white text-2xl font-bold",children:t.length})]})}),e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:e.jsxs(z,{className:"p-4",children:[e.jsx("p",{className:"text-[#C0C8D3] mb-1",children:"Active"}),e.jsx("p",{className:"text-[#28A745] text-2xl font-bold",children:t.filter(n=>n.status==="Active").length})]})}),e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:e.jsxs(z,{className:"p-4",children:[e.jsx("p",{className:"text-[#C0C8D3] mb-1",children:"Classes"}),e.jsx("p",{className:"text-[#1E90FF] text-2xl font-bold",children:r.length})]})}),e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:e.jsxs(z,{className:"p-4",children:[e.jsx("p",{className:"text-[#C0C8D3] mb-1",children:"Inactive"}),e.jsx("p",{className:"text-[#DC3545] text-2xl font-bold",children:t.filter(n=>n.status==="Inactive").length})]})})]}),e.jsx(Ce,{open:A,onOpenChange:D,children:e.jsxs(Fe,{className:"bg-[#132C4A] text-white border-white/10",children:[e.jsx(Se,{children:e.jsx(Ee,{children:"Student Details"})}),b&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx($,{className:"text-[#C0C8D3]",children:"Full Name"}),e.jsx("p",{className:"text-white font-medium",children:`${b.firstName} ${b.lastName}`})]}),e.jsxs("div",{children:[e.jsx($,{className:"text-[#C0C8D3]",children:"Registration Number"}),e.jsx("p",{className:"text-white",children:b.admissionNumber||"N/A"})]}),e.jsxs("div",{children:[e.jsx($,{className:"text-[#C0C8D3]",children:"Class"}),e.jsx("p",{className:"text-white",children:b.className||"N/A"})]}),e.jsxs("div",{children:[e.jsx($,{className:"text-[#C0C8D3]",children:"Gender"}),e.jsx("p",{className:"text-white",children:b.gender||"N/A"})]}),e.jsxs("div",{children:[e.jsx($,{className:"text-[#C0C8D3]",children:"Date of Birth"}),e.jsx("p",{className:"text-white",children:b.dateOfBirth||"N/A"})]}),e.jsxs("div",{children:[e.jsx($,{className:"text-[#C0C8D3]",children:"Status"}),e.jsx(le,{className:b.status==="Active"?"bg-[#28A745]":"bg-[#DC3545]",children:b.status||"Active"})]})]})]})}),e.jsx(Ce,{open:v,onOpenChange:H,children:e.jsxs(Fe,{className:"bg-[#132C4A] text-white border-white/10 max-w-md",children:[e.jsx(Se,{children:e.jsx(Ee,{children:"Edit Student"})}),b&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx($,{className:"text-[#C0C8D3]",children:"First Name"}),e.jsx(ae,{value:se.firstName,onChange:n=>Z(S(x({},se),{firstName:n.target.value})),className:`bg-[#1E3A5F] border ${K.firstName?"border-red-500":"border-white/20"} text-white`,placeholder:"Enter first name"}),K.firstName&&e.jsx("p",{className:"text-xs text-red-400 mt-1",children:K.firstName})]}),e.jsxs("div",{children:[e.jsx($,{className:"text-[#C0C8D3]",children:"Last Name"}),e.jsx(ae,{value:se.lastName,onChange:n=>Z(S(x({},se),{lastName:n.target.value})),className:`bg-[#1E3A5F] border ${K.lastName?"border-red-500":"border-white/20"} text-white`,placeholder:"Enter last name"}),K.lastName&&e.jsx("p",{className:"text-xs text-red-400 mt-1",children:K.lastName})]}),e.jsxs("div",{children:[e.jsx($,{className:"text-[#C0C8D3]",children:"Admission Number"}),e.jsx(ae,{value:se.admissionNumber,onChange:n=>Z(S(x({},se),{admissionNumber:n.target.value})),className:`bg-[#1E3A5F] border ${K.admissionNumber?"border-red-500":"border-white/20"} text-white`,placeholder:"Enter registration number"}),K.admissionNumber&&e.jsx("p",{className:"text-xs text-red-400 mt-1",children:K.admissionNumber})]}),e.jsxs("div",{children:[e.jsx($,{className:"text-[#C0C8D3]",children:"Class"}),e.jsxs(ce,{value:se.classId,onValueChange:n=>Z(m=>S(x({},m),{classId:n})),children:[e.jsx(ie,{className:`bg-[#1E3A5F] border ${K.classId?"border-red-500":"border-white/20"} text-white`,children:e.jsx(de,{placeholder:"Select Class"})}),e.jsx(oe,{className:"bg-[#1E3A5F] border-white/20",children:r.map(n=>e.jsx(_,{value:n.id.toString(),className:"text-white",children:n.name},n.id))})]}),K.classId&&e.jsx("p",{className:"text-xs text-red-400 mt-1",children:K.classId})]}),e.jsxs("div",{children:[e.jsx($,{className:"text-[#C0C8D3]",children:"Gender"}),e.jsxs(ce,{value:se.gender,onValueChange:n=>Z(m=>S(x({},m),{gender:n})),children:[e.jsx(ie,{className:`bg-[#1E3A5F] border ${K.gender?"border-red-500":"border-white/20"} text-white`,children:e.jsx(de,{placeholder:"Select Gender"})}),e.jsxs(oe,{className:"bg-[#1E3A5F] border-white/20",children:[e.jsx(_,{value:"Male",className:"text-white",children:"Male"}),e.jsx(_,{value:"Female",className:"text-white",children:"Female"})]})]}),K.gender&&e.jsx("p",{className:"text-xs text-red-400 mt-1",children:K.gender})]}),e.jsxs("div",{children:[e.jsx($,{className:"text-[#C0C8D3]",children:"Date of Birth"}),e.jsx(ae,{type:"date",value:se.dateOfBirth,onChange:n=>Z(S(x({},se),{dateOfBirth:n.target.value})),className:`bg-[#1E3A5F] border ${K.dateOfBirth?"border-red-500":"border-white/20"} text-white`}),K.dateOfBirth&&e.jsx("p",{className:"text-xs text-red-400 mt-1",children:K.dateOfBirth})]}),e.jsxs("div",{children:[e.jsx($,{className:"text-[#C0C8D3]",children:"Status"}),e.jsxs(ce,{value:se.status,onValueChange:n=>Z(m=>S(x({},m),{status:n})),children:[e.jsx(ie,{className:`bg-[#1E3A5F] border ${K.status?"border-red-500":"border-white/20"} text-white`,children:e.jsx(de,{placeholder:"Select Status"})}),e.jsxs(oe,{className:"bg-[#1E3A5F] border-white/20",children:[e.jsx(_,{value:"Active",className:"text-white",children:"Active"}),e.jsx(_,{value:"Inactive",className:"text-white",children:"Inactive"}),e.jsx(_,{value:"Graduated",className:"text-white",children:"Graduated"})]})]}),K.status&&e.jsx("p",{className:"text-xs text-red-400 mt-1",children:K.status})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(G,{variant:"outline",onClick:()=>{H(!1),re({})},className:"border-white/20 text-white hover:bg-white/10",disabled:L,children:"Cancel"}),e.jsx(G,{onClick:W,className:"bg-[#FFD700] text-[#0A2540] hover:bg-[#FFD700]/90 disabled:opacity-50 disabled:cursor-not-allowed",disabled:L,children:L?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 mr-2 border-2 border-[#0A2540] border-t-transparent rounded-full animate-spin"}),"Updating..."]}):"Update Student"})]})]})]})}),e.jsx(xs,{open:C,onOpenChange:O,children:e.jsxs(ms,{className:"bg-[#132C4A] text-white border-white/10",children:[e.jsxs(us,{children:[e.jsxs(js,{className:"text-white flex items-center gap-2",children:[e.jsx(Gs,{className:"w-5 h-5 text-red-400"}),"Delete Student"]}),e.jsxs(ps,{className:"text-[#C0C8D3]",children:["Are you sure you want to delete ",e.jsx("strong",{children:f==null?void 0:f.name}),"? This action cannot be undone and will permanently remove all student records, including scores and payment history."]})]}),e.jsxs(gs,{children:[e.jsx(bs,{onClick:p,className:"border-white/20 text-white hover:bg-white/10",disabled:u,children:"Cancel"}),e.jsx(Ns,{onClick:k,className:"bg-red-600 text-white hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:u,children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 mr-2 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Deleting..."]}):"Delete Student"})]})]})})]})}function yt(){const{teachers:s,deleteTeacher:t,updateTeacher:r,classes:l,subjectAssignments:i}=ve(),[a,N]=c.useState(""),[o,g]=c.useState(null),[h,I]=c.useState(!1),[j,w]=c.useState(!1),[b,y]=c.useState({firstName:"",lastName:"",email:"",phone:"",qualification:"",specialization:[]}),A=u=>l.filter(L=>L.classTeacherId===u),D=u=>i.filter(T=>T.teacherId===u),v=s.filter(u=>{const T=`${u.firstName} ${u.lastName}`.toLowerCase(),L=a.toLowerCase();return T.includes(L)||u.employeeId.toLowerCase().includes(L)||u.email.toLowerCase().includes(L)}),H=u=>{g(u),y({firstName:u.firstName,lastName:u.lastName,email:u.email,phone:u.phone,qualification:u.qualification,specialization:u.specialization}),w(!0)},C=()=>{o&&(r(o.id,b),E.success(`Teacher ${b.firstName} ${b.lastName} updated successfully`),w(!1),g(null))},O=(u,T)=>{confirm(`Are you sure you want to delete ${T}? This action cannot be undone.`)&&(t(u),E.success(`Teacher ${T} deleted successfully`))},f=u=>{g(u),I(!0)},F={total:s.length,active:s.filter(u=>u.status==="Active").length,classTeachers:s.filter(u=>u.isClassTeacher).length,inactive:s.filter(u=>u.status==="Inactive").length};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-[#1F2937] mb-2",children:"Manage Teachers"}),e.jsx("p",{className:"text-[#6B7280]",children:"View, edit, and manage all teaching staff"})]}),e.jsxs(qe,{className:"border-blue-200 bg-blue-50 rounded-xl",children:[e.jsx(ye,{className:"h-4 w-4 text-blue-600"}),e.jsxs(Ge,{className:"text-blue-900",children:[e.jsx("strong",{children:"Note:"}),' To add new teachers, please use the "Register User" page from the main menu. This page is for viewing and managing existing teachers only.']})]}),e.jsxs(V,{className:"rounded-xl bg-white border border-[#E5E7EB] shadow-clinical",children:[e.jsx(me,{className:"p-5 border-b border-[#E5E7EB]",children:e.jsx("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Re,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#6B7280]"}),e.jsx(ae,{value:a,onChange:u=>N(u.target.value),placeholder:"Search by name, email or employee ID...",className:"h-12 pl-10 rounded-xl border border-[#E5E7EB] bg-white text-[#1F2937]"})]})})}),e.jsx(z,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(De,{children:[e.jsx(Be,{children:e.jsxs(xe,{className:"bg-[#2563EB] border-none hover:bg-[#2563EB]",children:[e.jsx(q,{className:"text-white",children:"Employee ID"}),e.jsx(q,{className:"text-white",children:"Name"}),e.jsx(q,{className:"text-white",children:"Email"}),e.jsx(q,{className:"text-white",children:"Specialization"}),e.jsx(q,{className:"text-white",children:"Class Teacher"}),e.jsx(q,{className:"text-white",children:"Qualification"}),e.jsx(q,{className:"text-white",children:"Status"}),e.jsx(q,{className:"text-white text-center",children:"Actions"})]})}),e.jsx(Pe,{children:v.length===0?e.jsx(xe,{className:"bg-white",children:e.jsx(M,{colSpan:8,className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(Re,{className:"w-12 h-12 text-[#9CA3AF]"}),e.jsx("p",{className:"text-[#1F2937]",children:"No teachers found"}),e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Try adjusting your search criteria"})]})})}):v.map(u=>{const T=A(u.id);return e.jsxs(xe,{className:"bg-white border-b border-[#E5E7EB] hover:bg-[#F9FAFB]",children:[e.jsx(M,{className:"text-[#1F2937]",children:u.employeeId}),e.jsxs(M,{className:"text-[#1F2937]",children:[u.firstName," ",u.lastName]}),e.jsx(M,{className:"text-[#6B7280] text-sm",children:u.email}),e.jsx(M,{className:"text-[#6B7280] text-sm",children:u.specialization.join(", ")}),e.jsx(M,{children:T.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:T.map(L=>e.jsx(le,{className:"bg-[#10B981] text-white border-0 text-xs",children:L.name},L.id))}):e.jsx("span",{className:"text-[#9CA3AF] text-sm",children:"-"})}),e.jsx(M,{children:e.jsxs(le,{className:"bg-[#3B82F6] text-white border-0",children:[e.jsx(cs,{className:"w-3 h-3 mr-1"}),u.qualification]})}),e.jsx(M,{children:e.jsx(le,{className:u.status==="Active"?"bg-[#10B981] text-white border-0":"bg-[#EF4444] text-white border-0",children:u.status})}),e.jsx(M,{children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(G,{onClick:()=>f(u),size:"sm",className:"h-8 w-8 p-0 bg-[#3B82F6] hover:bg-[#2563EB] rounded-lg",title:"View Details",children:e.jsx(rs,{className:"w-4 h-4"})}),e.jsx(G,{onClick:()=>H(u),size:"sm",className:"h-8 w-8 p-0 bg-[#F59E0B] hover:bg-[#D97706] rounded-lg",title:"Edit Teacher",children:e.jsx(ls,{className:"w-4 h-4"})}),e.jsx(G,{onClick:()=>O(u.id,`${u.firstName} ${u.lastName}`),size:"sm",className:"h-8 w-8 p-0 bg-[#EF4444] hover:bg-[#DC2626] rounded-lg",title:"Delete Teacher",children:e.jsx(He,{className:"w-4 h-4"})})]})})]},u.id)})})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(V,{className:"rounded-xl bg-white border border-[#E5E7EB] shadow-clinical hover:shadow-clinical-lg transition-all",children:e.jsxs(z,{className:"p-4",children:[e.jsx("p",{className:"text-[#6B7280] mb-1",children:"Total Teachers"}),e.jsx("p",{className:"text-[#1F2937]",children:F.total})]})}),e.jsx(V,{className:"rounded-xl bg-white border border-[#E5E7EB] shadow-clinical hover:shadow-clinical-lg transition-all",children:e.jsxs(z,{className:"p-4",children:[e.jsx("p",{className:"text-[#6B7280] mb-1",children:"Active Teachers"}),e.jsx("p",{className:"text-[#10B981]",children:F.active})]})}),e.jsx(V,{className:"rounded-xl bg-white border border-[#E5E7EB] shadow-clinical hover:shadow-clinical-lg transition-all",children:e.jsxs(z,{className:"p-4",children:[e.jsx("p",{className:"text-[#6B7280] mb-1",children:"Class Teachers"}),e.jsx("p",{className:"text-[#3B82F6]",children:F.classTeachers})]})}),e.jsx(V,{className:"rounded-xl bg-white border border-[#E5E7EB] shadow-clinical hover:shadow-clinical-lg transition-all",children:e.jsxs(z,{className:"p-4",children:[e.jsx("p",{className:"text-[#6B7280] mb-1",children:"Inactive"}),e.jsx("p",{className:"text-[#EF4444]",children:F.inactive})]})})]}),e.jsx(Ce,{open:h,onOpenChange:I,children:e.jsxs(Fe,{className:"max-w-2xl rounded-xl bg-white border border-[#E5E7EB]",children:[e.jsxs(Se,{children:[e.jsx(Ee,{className:"text-[#1F2937]",children:"Teacher Details"}),e.jsx(ts,{className:"text-[#6B7280]",children:"View complete information about this teacher"})]}),o&&e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#6B7280]",children:"Employee ID"}),e.jsx("p",{className:"text-[#1F2937]",children:o.employeeId})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#6B7280]",children:"Status"}),e.jsx(le,{className:o.status==="Active"?"bg-[#10B981] text-white":"bg-[#EF4444] text-white",children:o.status})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#6B7280]",children:"First Name"}),e.jsx("p",{className:"text-[#1F2937]",children:o.firstName})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#6B7280]",children:"Last Name"}),e.jsx("p",{className:"text-[#1F2937]",children:o.lastName})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#6B7280]",children:"Email"}),e.jsx("p",{className:"text-[#1F2937]",children:o.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#6B7280]",children:"Phone"}),e.jsx("p",{className:"text-[#1F2937]",children:o.phone})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#6B7280]",children:"Qualification"}),e.jsx("p",{className:"text-[#1F2937]",children:o.qualification})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#6B7280]",children:"Specialization"}),e.jsx("p",{className:"text-[#1F2937]",children:o.specialization.join(", ")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#6B7280]",children:"Class Teacher Assignments"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[A(o.id).map(u=>e.jsx(le,{className:"bg-[#10B981] text-white",children:u.name},u.id)),A(o.id).length===0&&e.jsx("span",{className:"text-[#9CA3AF] text-sm",children:"No class teacher assignments"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#6B7280]",children:"Subject Assignments"}),e.jsxs("div",{className:"max-h-48 overflow-y-auto space-y-2",children:[D(o.id).map(u=>e.jsx("div",{className:"p-3 bg-[#F9FAFB] rounded-lg border border-[#E5E7EB]",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[#1F2937]",children:u.subjectName}),e.jsx("p",{className:"text-sm text-[#6B7280]",children:u.className})]}),e.jsx(le,{className:"bg-[#3B82F6] text-white text-xs",children:u.term})]})},u.id)),D(o.id).length===0&&e.jsx("p",{className:"text-[#9CA3AF] text-sm",children:"No subject assignments"})]})]})]}),e.jsx(Hs,{children:e.jsx(G,{onClick:()=>I(!1),className:"bg-[#3B82F6] hover:bg-[#2563EB] text-white rounded-xl",children:"Close"})})]})}),e.jsx(Ce,{open:j,onOpenChange:w,children:e.jsxs(Fe,{className:"max-w-2xl rounded-xl bg-white border border-[#E5E7EB]",children:[e.jsxs(Se,{children:[e.jsx(Ee,{className:"text-[#1F2937]",children:"Edit Teacher"}),e.jsx(ts,{className:"text-[#6B7280]",children:"Update teacher information"})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#1F2937]",children:"First Name"}),e.jsx(ae,{value:b.firstName,onChange:u=>y(S(x({},b),{firstName:u.target.value})),className:"rounded-xl border-[#E5E7EB] bg-white text-[#1F2937]"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#1F2937]",children:"Last Name"}),e.jsx(ae,{value:b.lastName,onChange:u=>y(S(x({},b),{lastName:u.target.value})),className:"rounded-xl border-[#E5E7EB] bg-white text-[#1F2937]"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#1F2937]",children:"Email"}),e.jsx(ae,{type:"email",value:b.email,onChange:u=>y(S(x({},b),{email:u.target.value})),className:"rounded-xl border-[#E5E7EB] bg-white text-[#1F2937]"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#1F2937]",children:"Phone"}),e.jsx(ae,{value:b.phone,onChange:u=>y(S(x({},b),{phone:u.target.value})),className:"rounded-xl border-[#E5E7EB] bg-white text-[#1F2937]"})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx($,{className:"text-[#1F2937]",children:"Qualification"}),e.jsx(ae,{value:b.qualification,onChange:u=>y(S(x({},b),{qualification:u.target.value})),className:"rounded-xl border-[#E5E7EB] bg-white text-[#1F2937]"})]})]})}),e.jsxs(Hs,{children:[e.jsx(G,{onClick:()=>w(!1),variant:"outline",className:"rounded-xl border-[#E5E7EB] text-[#1F2937]",children:"Cancel"}),e.jsx(G,{onClick:C,className:"bg-[#3B82F6] hover:bg-[#2563EB] text-white rounded-xl",children:"Save Changes"})]})]})})]})}function Ct({onNavigateToLink:s}){const[t,r]=c.useState(""),[l,i]=c.useState([]),[a,N]=c.useState(!0),[o,g]=c.useState(null),[h,I]=c.useState(!1),[j,w]=c.useState(!1),[b,y]=c.useState({name:"",email:"",phone:"",status:"active"});c.useEffect(()=>{A()},[]);const A=()=>ue(this,null,function*(){try{N(!0);const F=yield Vs.getAll();if(F.success){const u=F.data.filter(T=>T.role==="parent");i(u)}}catch(F){console.error("Error loading parents:",F),E.error("Failed to load parents")}finally{N(!1)}}),D=F=>{g(F),I(!0)},v=F=>{g(F),y({name:F.name||"",email:F.email||"",phone:F.phone||"",status:F.status||"active"}),w(!0)},H=()=>ue(this,null,function*(){if(o)try{(yield Vs.update(o.id,b))&&(E.success("Parent updated successfully"),w(!1),A())}catch(F){console.error("Error updating parent:",F);const u=(F==null?void 0:F.data)&&F.data.message||(F==null?void 0:F.message)||"Failed to update parent";E.error(u)}}),C=(F,u)=>ue(this,null,function*(){if(confirm(`Are you sure you want to delete ${u}? This action cannot be undone.`))try{yield Vs.delete(F),E.success("Parent deleted successfully"),A()}catch(T){console.error("Error deleting parent:",T);const L=(T==null?void 0:T.data)&&T.data.message||(T==null?void 0:T.message)||"Failed to delete parent";E.error(L)}}),O=()=>{s?s():E.info("Navigating to Link Student-Parent page")},f=l.filter(F=>{var u,T,L;return((u=F.name)==null?void 0:u.toLowerCase().includes(t.toLowerCase()))||((T=F.email)==null?void 0:T.toLowerCase().includes(t.toLowerCase()))||((L=F.phone)==null?void 0:L.includes(t))});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-white mb-2",children:"Manage Parents"}),e.jsx("p",{className:"text-[#C0C8D3]",children:"View, edit, and manage all registered parents/guardians"})]}),e.jsxs(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:[e.jsx(me,{className:"p-5 border-b border-white/10",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Re,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#C0C8D3]"}),e.jsx(ae,{value:t,onChange:F=>r(F.target.value),placeholder:"Search by name, email, or phone...",className:"h-12 pl-10 rounded-xl border border-white/10 bg-[#0F243E] text-white"})]}),e.jsxs("div",{className:"flex gap-3 w-full md:w-auto",children:[e.jsxs(G,{onClick:O,className:"h-12 bg-[#28A745] hover:bg-[#28A745]/90 text-white rounded-xl shadow-md hover:scale-105 transition-all whitespace-nowrap",children:[e.jsx(Oe,{className:"w-5 h-5 mr-2"}),"Link Child(ren)"]}),e.jsxs(G,{className:"h-12 bg-[#1E90FF] hover:bg-[#00BFFF] text-white rounded-xl shadow-md hover:scale-105 transition-all whitespace-nowrap",children:[e.jsx(_e,{className:"w-5 h-5 mr-2"}),"Add New"]})]})]})}),e.jsx(z,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(De,{children:[e.jsx(Be,{children:e.jsxs(xe,{className:"bg-gradient-to-r from-[#1E90FF] to-[#00BFFF] border-none hover:bg-gradient-to-r",children:[e.jsx(q,{className:"text-white",children:"Parent/Guardian Name"}),e.jsx(q,{className:"text-white",children:"Email"}),e.jsx(q,{className:"text-white",children:"Phone"}),e.jsx(q,{className:"text-white",children:"Linked Children"}),e.jsx(q,{className:"text-white",children:"Status"}),e.jsx(q,{className:"text-white text-center",children:"Actions"})]})}),e.jsx(Pe,{children:a?e.jsx(xe,{children:e.jsxs(M,{colSpan:6,className:"text-center py-8",children:[e.jsx(Ms,{className:"w-8 h-8 animate-spin mx-auto text-[#1E90FF]"}),e.jsx("p",{className:"text-[#C0C8D3] mt-2",children:"Loading parents..."})]})}):f.length===0?e.jsx(xe,{children:e.jsx(M,{colSpan:6,className:"text-center py-8",children:e.jsx("p",{className:"text-[#C0C8D3]",children:"No parents found"})})}):f.map(F=>e.jsxs(xe,{className:"bg-[#0F243E] border-b border-white/5 hover:bg-[#132C4A]",children:[e.jsx(M,{className:"text-white",children:F.name}),e.jsx(M,{className:"text-[#C0C8D3]",children:F.email}),e.jsx(M,{className:"text-[#C0C8D3]",children:F.phone||"N/A"}),e.jsx(M,{children:e.jsx(le,{className:"bg-[#1E90FF] text-white border-0",children:"0 children"})}),e.jsx(M,{children:e.jsx(le,{className:F.status==="active"?"bg-[#28A745] text-white border-0":"bg-[#DC3545] text-white border-0",children:F.status})}),e.jsx(M,{children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(G,{onClick:()=>D(F),size:"sm",className:"h-8 w-8 p-0 bg-[#1E90FF] hover:bg-[#00BFFF] rounded-lg",title:"View Details",children:e.jsx(rs,{className:"w-4 h-4"})}),e.jsx(G,{onClick:O,size:"sm",className:"h-8 w-8 p-0 bg-[#28A745] hover:bg-[#28A745]/90 rounded-lg",title:"Link to Child",children:e.jsx(Oe,{className:"w-4 h-4"})}),e.jsx(G,{onClick:()=>v(F),size:"sm",className:"h-8 w-8 p-0 bg-[#FFC107] hover:bg-[#FFC107]/90 rounded-lg",title:"Edit Parent",children:e.jsx(ls,{className:"w-4 h-4"})}),e.jsx(G,{onClick:()=>C(F.id,F.name),size:"sm",className:"h-8 w-8 p-0 bg-[#DC3545] hover:bg-[#DC3545]/90 rounded-lg",title:"Delete Parent",children:e.jsx(He,{className:"w-4 h-4"})})]})})]},F.id))})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:e.jsxs(z,{className:"p-4",children:[e.jsx("p",{className:"text-[#C0C8D3] mb-1",children:"Total Parents"}),e.jsx("p",{className:"text-white text-2xl font-bold",children:l.length})]})}),e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:e.jsxs(z,{className:"p-4",children:[e.jsx("p",{className:"text-[#C0C8D3] mb-1",children:"Active"}),e.jsx("p",{className:"text-[#28A745] text-2xl font-bold",children:l.filter(F=>F.status==="active").length})]})}),e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:e.jsxs(z,{className:"p-4",children:[e.jsx("p",{className:"text-[#C0C8D3] mb-1",children:"Inactive"}),e.jsx("p",{className:"text-[#DC3545] text-2xl font-bold",children:l.filter(F=>F.status==="inactive").length})]})}),e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:e.jsxs(z,{className:"p-4",children:[e.jsx("p",{className:"text-[#C0C8D3] mb-1",children:"Search Results"}),e.jsx("p",{className:"text-[#1E90FF] text-2xl font-bold",children:f.length})]})})]}),e.jsx(Ce,{open:h,onOpenChange:I,children:e.jsxs(Fe,{className:"bg-[#132C4A] text-white border-white/10",children:[e.jsxs(Se,{children:[e.jsx(Ee,{children:"Parent Details"}),e.jsx(ts,{className:"text-[#C0C8D3]",children:"View complete information about this parent/guardian"})]}),o&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx($,{className:"text-[#C0C8D3]",children:"Name"}),e.jsx("p",{className:"text-white font-medium",children:o.name})]}),e.jsxs("div",{children:[e.jsx($,{className:"text-[#C0C8D3]",children:"Email"}),e.jsx("p",{className:"text-white",children:o.email})]}),e.jsxs("div",{children:[e.jsx($,{className:"text-[#C0C8D3]",children:"Phone"}),e.jsx("p",{className:"text-white",children:o.phone||"N/A"})]}),e.jsxs("div",{children:[e.jsx($,{className:"text-[#C0C8D3]",children:"Status"}),e.jsx(le,{className:o.status==="active"?"bg-[#28A745]":"bg-[#DC3545]",children:o.status})]}),e.jsxs("div",{children:[e.jsx($,{className:"text-[#C0C8D3]",children:"Created"}),e.jsx("p",{className:"text-white",children:new Date(o.created_at).toLocaleDateString()})]})]})]})}),e.jsx(Ce,{open:j,onOpenChange:w,children:e.jsxs(Fe,{className:"bg-[#132C4A] text-white border-white/10",children:[e.jsxs(Se,{children:[e.jsx(Ee,{children:"Edit Parent"}),e.jsx(ts,{className:"text-[#C0C8D3]",children:"Update parent/guardian information"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx($,{htmlFor:"edit-name",children:"Name"}),e.jsx(ae,{id:"edit-name",value:b.name,onChange:F=>y(S(x({},b),{name:F.target.value})),className:"bg-[#0F243E] border-white/10 text-white"})]}),e.jsxs("div",{children:[e.jsx($,{htmlFor:"edit-email",children:"Email"}),e.jsx(ae,{id:"edit-email",type:"email",value:b.email,onChange:F=>y(S(x({},b),{email:F.target.value})),className:"bg-[#0F243E] border-white/10 text-white"})]}),e.jsxs("div",{children:[e.jsx($,{htmlFor:"edit-phone",children:"Phone"}),e.jsx(ae,{id:"edit-phone",value:b.phone,onChange:F=>y(S(x({},b),{phone:F.target.value})),className:"bg-[#0F243E] border-white/10 text-white"})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(G,{variant:"outline",onClick:()=>w(!1),className:"border-white/10",children:"Cancel"}),e.jsx(G,{onClick:H,className:"bg-[#1E90FF] hover:bg-[#00BFFF]",children:"Save Changes"})]})]})]})})]})}function bl(){const{notifications:s,addNotification:t,currentUser:r,users:l}=ve(),[i,a]=c.useState({title:"",message:"",recipient:"",priority:"normal"}),[N,o]=c.useState({teachers:!1,parents:!1,accountants:!1}),g=s.slice(0,10),h=s.filter(v=>{const H=new Date(Date.now()-6048e5);return new Date(v.sentDate)>=H}).length,I=s.length,j=s.reduce((v,H)=>v+H.readBy.length,0),w=s.reduce((v,H)=>{const C=H.targetAudience;return C==="all"?v+l.length:C==="teachers"?v+l.filter(O=>O.role==="teacher").length:C==="parents"?v+l.filter(O=>O.role==="parent").length:C==="accountants"?v+l.filter(O=>O.role==="accountant").length:v},0),b=w>0?Math.round(j/w*100):0,y=97,A=v=>{if(v.preventDefault(),!i.title||!i.message||!i.recipient){E.error("Please fill in all required fields");return}if(!r){E.error("You must be logged in to send notifications");return}let H="all";i.recipient==="custom"?N.teachers&&!N.parents&&!N.accountants?H="teachers":N.parents&&!N.teachers&&!N.accountants?H="parents":N.accountants&&!N.teachers&&!N.parents?H="accountants":H="all":H=i.recipient;const C={normal:"info",low:"info",high:"warning",urgent:"error"};t({title:i.title,message:i.message,type:C[i.priority]||"info",targetAudience:H,sentBy:r.id}),E.success("Notification sent successfully!"),a({title:"",message:"",recipient:"",priority:"normal"}),o({teachers:!1,parents:!1,accountants:!1})},D=v=>{switch(v){case"success":return"bg-[#28A745]";case"warning":return"bg-[#FFC107]";case"error":return"bg-[#DC3545]";default:return"bg-[#1E90FF]"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-white mb-2",children:"Notification System"}),e.jsx("p",{className:"text-[#C0C8D3]",children:"Send notifications and announcements to users"})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:[e.jsx(me,{className:"p-5 border-b border-white/10",children:e.jsxs("h3",{className:"text-white flex items-center gap-2",children:[e.jsx(ft,{className:"w-5 h-5"}),"Create New Notification"]})}),e.jsx(z,{className:"p-6",children:e.jsxs("form",{onSubmit:A,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"Notification Title *"}),e.jsx(ae,{required:!0,value:i.title,onChange:v=>a(S(x({},i),{title:v.target.value})),placeholder:"Enter notification title",className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"Message *"}),e.jsx($t,{required:!0,value:i.message,onChange:v=>a(S(x({},i),{message:v.target.value})),placeholder:"Enter your message here...",className:"min-h-32 rounded-xl border border-white/10 bg-[#0F243E] text-white"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"Recipients *"}),e.jsxs(ce,{value:i.recipient,onValueChange:v=>a(S(x({},i),{recipient:v})),children:[e.jsx(ie,{className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white",children:e.jsx(de,{placeholder:"Select recipient group"})}),e.jsxs(oe,{className:"bg-[#0F243E] border-white/10",children:[e.jsx(_,{value:"all",className:"text-white hover:bg-[#1E90FF]",children:"All Users"}),e.jsx(_,{value:"teachers",className:"text-white hover:bg-[#1E90FF]",children:"All Teachers"}),e.jsx(_,{value:"parents",className:"text-white hover:bg-[#1E90FF]",children:"All Parents"}),e.jsx(_,{value:"accountants",className:"text-white hover:bg-[#1E90FF]",children:"All Accountants"}),e.jsx(_,{value:"custom",className:"text-white hover:bg-[#1E90FF]",children:"Custom Selection"})]})]})]}),i.recipient==="custom"&&e.jsxs("div",{className:"p-4 bg-[#0F243E] rounded-xl border border-white/10 space-y-3",children:[e.jsx($,{className:"text-white",children:"Select User Roles:"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{id:"teachers",checked:N.teachers,onCheckedChange:v=>o(S(x({},N),{teachers:v})),className:"border-white/20"}),e.jsxs($,{htmlFor:"teachers",className:"text-white cursor-pointer flex items-center gap-2",children:[e.jsx(Me,{className:"w-4 h-4"}),"Teachers"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{id:"parents",checked:N.parents,onCheckedChange:v=>o(S(x({},N),{parents:v})),className:"border-white/20"}),e.jsxs($,{htmlFor:"parents",className:"text-white cursor-pointer flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4"}),"Parents"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{id:"accountants",checked:N.accountants,onCheckedChange:v=>o(S(x({},N),{accountants:v})),className:"border-white/20"}),e.jsxs($,{htmlFor:"accountants",className:"text-white cursor-pointer flex items-center gap-2",children:[e.jsx(Mr,{className:"w-4 h-4"}),"Accountants"]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"Priority Level"}),e.jsxs(ce,{value:i.priority,onValueChange:v=>a(S(x({},i),{priority:v})),children:[e.jsx(ie,{className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white",children:e.jsx(de,{})}),e.jsxs(oe,{className:"bg-[#0F243E] border-white/10",children:[e.jsx(_,{value:"low",className:"text-white hover:bg-[#1E90FF]",children:"Low"}),e.jsx(_,{value:"normal",className:"text-white hover:bg-[#1E90FF]",children:"Normal"}),e.jsx(_,{value:"high",className:"text-white hover:bg-[#1E90FF]",children:"High"}),e.jsx(_,{value:"urgent",className:"text-white hover:bg-[#1E90FF]",children:"Urgent"})]})]})]}),e.jsx("div",{className:"flex gap-3 pt-4",children:e.jsxs(G,{type:"submit",className:"flex-1 h-12 bg-[#1E90FF] hover:bg-[#00BFFF] text-white rounded-xl shadow-md hover:scale-105 transition-all",children:[e.jsx(ft,{className:"w-5 h-5 mr-2"}),"Send Notification"]})})]})})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:[e.jsx(me,{className:"p-5 border-b border-white/10",children:e.jsxs("h3",{className:"text-white flex items-center gap-2",children:[e.jsx(Es,{className:"w-5 h-5"}),"Recent Notifications"]})}),e.jsx(z,{className:"p-5 space-y-3",children:g.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Es,{className:"w-12 h-12 mx-auto mb-3 text-[#C0C8D3]"}),e.jsx("p",{className:"text-white mb-1",children:"No notifications yet"}),e.jsx("p",{className:"text-sm text-[#C0C8D3]",children:"Send your first notification above"})]}):g.map(v=>e.jsxs("div",{className:"p-3 bg-[#0F243E] rounded-xl border border-white/5 hover:border-white/10 transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("p",{className:"text-white text-sm",children:v.title}),e.jsx(le,{className:`${D(v.type)} text-white border-0 text-xs`,children:v.type})]}),e.jsx("p",{className:"text-xs text-[#C0C8D3] mb-2 line-clamp-2",children:v.message}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-[#C0C8D3]",children:v.targetAudience}),e.jsx("span",{className:"text-xs text-[#C0C8D3]",children:new Date(v.sentDate).toLocaleDateString()})]})]},v.id))})]}),e.jsxs(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:[e.jsx(me,{className:"p-5 border-b border-white/10",children:e.jsx("h3",{className:"text-white text-sm",children:"Statistics"})}),e.jsxs(z,{className:"p-5 space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[#C0C8D3]",children:"Sent This Week"}),e.jsx("span",{className:"text-white",children:h})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[#C0C8D3]",children:"Total Sent"}),e.jsx("span",{className:"text-white",children:I})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[#C0C8D3]",children:"Delivered"}),e.jsxs("span",{className:"text-[#28A745]",children:[y,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[#C0C8D3]",children:"Read Rate"}),e.jsxs("span",{className:"text-[#1E90FF]",children:[b,"%"]})]})]})]})]})]})]})}function fl(){const{currentUser:s,students:t,teachers:r,classes:l,subjectAssignments:i,compiledResults:a,getPendingApprovals:N,rejectResult:o,fetchCompiledResults:g}=ve(),[h,I]=c.useState(null),[j,w]=c.useState(!1),[b,y]=c.useState(!1),[A,D]=c.useState(""),[v,H]=c.useState(!1),[C,O]=c.useState("all"),[f,F]=c.useState("all"),[u,T]=c.useState(null),[L,ee]=c.useState(!1),K=N(),re=a.filter(R=>R.status==="Approved"),ge=a.filter(R=>R.status==="Rejected"),[he,se]=c.useState("Submitted");c.useEffect(()=>{g().catch(()=>{})},[]);const Z=Array.from(new Set(l.map(R=>R.level))).filter(Boolean).sort(),U=C==="all"?l:l.filter(R=>R.level===C),d=a.filter(R=>{if(R.status!==he||f!=="all"&&R.classId!==parseInt(f))return!1;if(C!=="all"&&f==="all"){const n=l.find(m=>m.id===R.classId);if(n&&n.level!==C)return!1}return!0}),B=R=>ue(this,null,function*(){if(s){T(R);try{yield ht.approve({result_ids:[R]}),yield g(),E.success("Result approved successfully!")}catch(n){console.error("Error approving result:",n),E.error("Failed to approve result. Please try again.")}finally{T(null)}}}),k=()=>ue(this,null,function*(){if(!h||!A.trim()){E.error("Please provide a rejection reason");return}ee(!0);try{yield ht.reject({result_ids:[h],rejection_reason:A}),yield g(),E.success("Result rejected and sent back to Class Teacher"),y(!1),D(""),I(null)}catch(R){console.error("Error rejecting result:",R),E.error("Failed to reject result. Please try again.")}finally{ee(!1)}}),p=R=>{const n=a.find(m=>m.id===R);if(n){if(n.status!=="Approved"){E.error("Only approved results can be printed");return}I(R),H(!0)}},Q=()=>ue(this,null,function*(){const R=re.length;if(R===0){E.error("No approved results to download");return}E.info(`Preparing ${R} report cards for download...`);for(let n=0;n<re.length;n++){const m=re[n],P=t.find(J=>J.id===m.studentId);E.info(`Downloading ${n+1}/${R}: ${P==null?void 0:P.firstName} ${P==null?void 0:P.lastName}`),yield new Promise(J=>setTimeout(J,500)),I(m.id),H(!0),yield new Promise(J=>setTimeout(J,2e3)),H(!1)}E.success(`All ${R} report cards ready!`)}),W=h?a.find(R=>R.id===h):null;return v&&W?e.jsx(Fr,{result:W,onClose:()=>H(!1)}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl text-gray-900 mb-2",children:"Approve Results"}),e.jsx("p",{className:"text-gray-600",children:"Review and approve compiled results from class teachers"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(V,{className:"rounded-xl bg-white border border-gray-200 shadow-sm",children:e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pending Approval"}),e.jsx(ye,{className:"w-6 h-6 text-[#F59E0B]"})]}),e.jsx("p",{className:"text-2xl text-gray-900",children:K.length}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Awaiting review"})]})}),e.jsx(V,{className:"rounded-xl bg-white border border-gray-200 shadow-sm",children:e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Approved"}),e.jsx($e,{className:"w-6 h-6 text-[#10B981]"})]}),e.jsx("p",{className:"text-2xl text-gray-900",children:re.length}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ready for printing"})]})}),e.jsx(V,{className:"rounded-xl bg-white border border-gray-200 shadow-sm",children:e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Rejected"}),e.jsx(is,{className:"w-6 h-6 text-[#EF4444]"})]}),e.jsx("p",{className:"text-2xl text-gray-900",children:ge.length}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Sent back"})]})}),e.jsx(V,{className:"rounded-xl bg-white border border-gray-200 shadow-sm",children:e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Results"}),e.jsx(qs,{className:"w-6 h-6 text-[#2563EB]"})]}),e.jsx("p",{className:"text-2xl text-gray-900",children:a.length}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"All submissions"})]})})]}),e.jsxs(V,{className:"rounded-xl bg-white border border-gray-200 shadow-sm",children:[e.jsx(me,{className:"p-5 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_t,{className:"w-5 h-5 text-[#2563EB]"}),e.jsx("h3",{className:"text-lg text-gray-900",children:"Filter by Class"})]})}),e.jsx(z,{className:"p-5",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600 mb-2 block",children:"School Level"}),e.jsxs(ce,{value:C,onValueChange:R=>{O(R),F("all")},children:[e.jsx(ie,{className:"rounded-xl border-gray-300",children:e.jsx(de,{placeholder:"Select school level"})}),e.jsxs(oe,{children:[e.jsx(_,{value:"all",children:"All Levels"}),Z.map(R=>e.jsx(_,{value:R,children:R},R))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600 mb-2 block",children:"Specific Class"}),e.jsxs(ce,{value:f,onValueChange:F,disabled:C==="all",children:[e.jsx(ie,{className:"rounded-xl border-gray-300",children:e.jsx(de,{placeholder:"Select class"})}),e.jsxs(oe,{children:[e.jsx(_,{value:"all",children:"All Classes"}),U.map(R=>e.jsx(_,{value:String(R.id),children:R.name},R.id))]})]})]})]})})]}),e.jsx(V,{className:"rounded-xl bg-white border border-gray-200 shadow-sm",children:e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(G,{onClick:()=>se("Submitted"),variant:he==="Submitted"?"default":"outline",className:`rounded-xl ${he==="Submitted"?"bg-[#F59E0B] text-white hover:bg-[#D97706]":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:["Pending (",K.length,")"]}),e.jsxs(G,{onClick:()=>se("Approved"),variant:he==="Approved"?"default":"outline",className:`rounded-xl ${he==="Approved"?"bg-[#10B981] text-white hover:bg-[#059669]":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:["Approved (",re.length,")"]}),e.jsxs(G,{onClick:()=>se("Rejected"),variant:he==="Rejected"?"default":"outline",className:`rounded-xl ${he==="Rejected"?"bg-[#EF4444] text-white hover:bg-[#DC2626]":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:["Rejected (",ge.length,")"]})]}),he==="Approved"&&re.length>0&&e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsxs(G,{onClick:Q,className:"bg-[#2563EB] hover:bg-[#1D4ED8] text-white rounded-xl shadow-sm",children:[e.jsx(qs,{className:"w-4 h-4 mr-2"}),"Download All Report Cards (",re.length,")"]})})]})}),e.jsxs(V,{className:"rounded-xl bg-white border border-gray-200 shadow-sm",children:[e.jsx(me,{className:"p-5 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg text-gray-900",children:["Results - ",he]})}),e.jsx(z,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(De,{children:[e.jsx(Be,{children:e.jsxs(xe,{className:"bg-[#2563EB] border-none hover:bg-[#2563EB]",children:[e.jsx(q,{className:"text-white",children:"Student Name"}),e.jsx(q,{className:"text-white",children:"Admission No."}),e.jsx(q,{className:"text-white",children:"Class"}),e.jsx(q,{className:"text-white text-center",children:"Average"}),e.jsx(q,{className:"text-white text-center",children:"Position"}),e.jsx(q,{className:"text-white text-center",children:"Compiled By"}),e.jsx(q,{className:"text-white text-center",children:"Date"}),e.jsx(q,{className:"text-white text-center",children:"Actions"})]})}),e.jsx(Pe,{children:d.length===0?e.jsx(xe,{className:"bg-white",children:e.jsx(M,{colSpan:8,className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(qs,{className:"w-12 h-12 text-gray-400"}),e.jsxs("p",{className:"text-gray-900",children:["No ",he.toLowerCase()," results"]})]})})}):d.map(R=>{const n=t.find(J=>J.id===R.studentId),m=l.find(J=>J.id===R.classId),P=r.find(J=>J.id===R.compiledBy);return e.jsxs(xe,{className:"bg-white border-b border-gray-100 hover:bg-gray-50",children:[e.jsxs(M,{className:"text-gray-900",children:[n==null?void 0:n.firstName," ",n==null?void 0:n.lastName]}),e.jsx(M,{className:"text-gray-600",children:n==null?void 0:n.admissionNumber}),e.jsx(M,{className:"text-gray-900",children:e.jsx(le,{className:"bg-[#3B82F6] text-white border-0",children:m==null?void 0:m.name})}),e.jsxs(M,{className:"text-center text-gray-900",children:[R.averageScore.toFixed(1),"%"]}),e.jsxs(M,{className:"text-center text-gray-900",children:[R.position,"/",R.totalStudents]}),e.jsxs(M,{className:"text-center text-gray-600 text-sm",children:[P==null?void 0:P.firstName," ",P==null?void 0:P.lastName]}),e.jsx(M,{className:"text-center text-gray-600 text-sm",children:new Date(R.compiledDate).toLocaleDateString()}),e.jsx(M,{className:"text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(G,{onClick:()=>{I(R.id),w(!0)},size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-[#2563EB] hover:bg-blue-50",children:e.jsx(rs,{className:"w-4 h-4"})}),R.status==="Submitted"&&e.jsxs(e.Fragment,{children:[e.jsxs(G,{onClick:()=>B(R.id),size:"sm",disabled:u===R.id,className:"h-8 bg-[#10B981] hover:bg-[#059669] text-white rounded-lg text-xs px-3",children:[e.jsx($e,{className:"w-3 h-3 mr-1"}),u===R.id?"Approving...":"Approve"]}),e.jsxs(G,{onClick:()=>{I(R.id),y(!0)},size:"sm",disabled:L,className:"h-8 bg-[#EF4444] hover:bg-[#DC2626] text-white rounded-lg text-xs px-3",children:[e.jsx(is,{className:"w-3 h-3 mr-1"}),"Reject"]})]}),R.status==="Approved"&&e.jsxs(G,{onClick:()=>p(R.id),size:"sm",className:"h-8 bg-[#2563EB] hover:bg-[#1D4ED8] text-white rounded-lg text-xs px-3",children:[e.jsx(Nt,{className:"w-3 h-3 mr-1"}),"Print PDF"]}),R.status==="Rejected"&&e.jsx(le,{className:"bg-gray-400 text-white border-0 text-xs",children:"Sent Back"})]})})]},R.id)})})]})})})]}),e.jsx(Ce,{open:j,onOpenChange:w,children:e.jsxs(Fe,{className:"max-w-4xl rounded-xl bg-white border border-gray-200 text-gray-900 max-h-[90vh] overflow-y-auto",children:[e.jsx(Se,{children:e.jsx(Ee,{className:"text-gray-900",children:"Result Preview"})}),W&&e.jsx("div",{className:"space-y-6 py-4",children:(()=>{const R=t.find(P=>P.id===W.studentId),n=l.find(P=>P.id===W.classId),m=r.find(P=>P.id===W.compiledBy);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center border-b border-gray-200 pb-4",children:[e.jsx("h2",{className:"text-xl text-gray-900",children:"Graceland Royal Academy Gombe"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Wisdom & Illumination"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[W.term," - ",W.academicYear]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Student Name:"}),e.jsxs("p",{className:"text-lg text-gray-900",children:[R==null?void 0:R.firstName," ",R==null?void 0:R.lastName]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Admission Number:"}),e.jsx("p",{className:"text-lg text-gray-900",children:R==null?void 0:R.admissionNumber})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Class:"}),e.jsx("p",{className:"text-lg text-gray-900",children:n==null?void 0:n.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Position:"}),e.jsxs("p",{className:"text-lg text-gray-900",children:[W.position," out of ",W.totalStudents]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md text-gray-900 mb-2",children:"Subject Scores"}),e.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:e.jsxs(De,{children:[e.jsx(Be,{children:e.jsxs(xe,{className:"bg-gray-100",children:[e.jsx(q,{className:"text-gray-900",children:"Subject"}),e.jsx(q,{className:"text-gray-900 text-center",children:"CA1 (20)"}),e.jsx(q,{className:"text-gray-900 text-center",children:"CA2 (20)"}),e.jsx(q,{className:"text-gray-900 text-center",children:"Exam (60)"}),e.jsx(q,{className:"text-gray-900 text-center",children:"Total (100)"}),e.jsx(q,{className:"text-gray-900 text-center",children:"Grade"}),e.jsx(q,{className:"text-gray-900",children:"Remark"})]})}),e.jsxs(Pe,{children:[W.scores.map(P=>{const J=i.find(te=>te.id===P.subjectAssignmentId);return e.jsxs(xe,{className:"border-b border-gray-100",children:[e.jsx(M,{className:"text-gray-900",children:J==null?void 0:J.subjectName}),e.jsx(M,{className:"text-center text-gray-900",children:P.ca1}),e.jsx(M,{className:"text-center text-gray-900",children:P.ca2}),e.jsx(M,{className:"text-center text-gray-900",children:P.exam}),e.jsx(M,{className:"text-center text-gray-900",children:P.total}),e.jsx(M,{className:"text-center",children:e.jsx(le,{className:"bg-[#10B981] text-white border-0",children:P.grade})}),e.jsx(M,{className:"text-gray-600 text-sm",children:P.remark})]},P.id)}),e.jsxs(xe,{className:"bg-gray-100",children:[e.jsx(M,{colSpan:4,className:"text-gray-900",children:e.jsx("strong",{children:"Total/Average"})}),e.jsx(M,{className:"text-center text-gray-900",children:e.jsxs("strong",{children:[W.averageScore.toFixed(1),"%"]})}),e.jsx(M,{colSpan:2})]})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md text-gray-900 mb-2",children:"Class Teacher's Comment"}),e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:e.jsx("p",{className:"text-sm text-gray-700",children:W.classTeacherComment})})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Compiled by: ",m==null?void 0:m.firstName," ",m==null?void 0:m.lastName]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Date: ",new Date(W.compiledDate).toLocaleDateString()]}),W.status==="Approved"&&e.jsx("p",{className:"text-sm text-green-600 mt-2",children:"✓ Approved by Admin"})]})]})})()}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(G,{onClick:()=>w(!1),variant:"outline",className:"rounded-xl border-gray-300 text-gray-700",children:"Close"}),(W==null?void 0:W.status)==="Approved"&&e.jsxs(G,{onClick:()=>h&&p(h),className:"bg-[#2563EB] hover:bg-[#1D4ED8] text-white rounded-xl",children:[e.jsx(Nt,{className:"w-4 h-4 mr-2"}),"Print PDF"]})]})]})}),e.jsx(Ce,{open:b,onOpenChange:y,children:e.jsxs(Fe,{className:"max-w-md rounded-xl bg-white border border-gray-200 text-gray-900",children:[e.jsx(Se,{children:e.jsx(Ee,{className:"text-gray-900",children:"Reject Result"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs(qe,{className:"bg-red-50 border-red-200 rounded-xl",children:[e.jsx(ye,{className:"h-4 w-4 text-red-600"}),e.jsx(Ge,{className:"text-gray-900",children:"Please provide a reason for rejection. This will be sent to the class teacher."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-700 mb-2 block",children:"Rejection Reason *"}),e.jsx($t,{placeholder:"Enter reason for rejection...",value:A,onChange:R=>D(R.target.value),className:"rounded-xl border-gray-300 text-gray-900",rows:4})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(G,{onClick:()=>{y(!1),D(""),I(null)},variant:"outline",className:"rounded-xl border-gray-300 text-gray-700",children:"Cancel"}),e.jsxs(G,{onClick:k,disabled:L,className:"bg-[#EF4444] hover:bg-[#DC2626] text-white rounded-xl",children:[e.jsx(is,{className:"w-4 h-4 mr-2"}),L?"Rejecting...":"Reject Result"]})]})]})})]})}var vl=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],wl=vl.reduce((s,t)=>{const r=Tt(`Primitive.${t}`),l=c.forwardRef((i,a)=>{const h=i,{asChild:N}=h,o=X(h,["asChild"]),g=N?r:t;return typeof window!="undefined"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(g,S(x({},o),{ref:a}))});return l.displayName=`Primitive.${t}`,S(x({},s),{[t]:l})},{}),yl="Separator",Ft="horizontal",Cl=["horizontal","vertical"],Qt=c.forwardRef((s,t)=>{const g=s,{decorative:r,orientation:l=Ft}=g,i=X(g,["decorative","orientation"]),a=Fl(l)?l:Ft,o=r?{role:"none"}:{"aria-orientation":a==="vertical"?a:void 0,role:"separator"};return e.jsx(wl.div,S(x(x({"data-orientation":a},o),i),{ref:t}))});Qt.displayName=yl;function Fl(s){return Cl.includes(s)}var Sl=Qt;function El(i){var a=i,{className:s,orientation:t="horizontal",decorative:r=!0}=a,l=X(a,["className","orientation","decorative"]);return e.jsx(Sl,x({"data-slot":"separator-root",decorative:r,orientation:t,className:Ie("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",s)},l))}function Al(){const{currentTerm:s,currentAcademicYear:t,updateCurrentTerm:r,updateCurrentAcademicYear:l,schoolSettings:i,updateSchoolSettings:a,addUser:N,users:o,changePassword:g}=ve(),[h,I]=c.useState({currentSession:t,currentTerm:s}),[j,w]=c.useState({schoolName:i.schoolName,schoolMotto:i.schoolMotto,principalName:i.principalName}),[b,y]=c.useState(!1);c.useEffect(()=>{I({currentSession:t,currentTerm:s})},[t,s]),c.useEffect(()=>{w({schoolName:i.schoolName,schoolMotto:i.schoolMotto,principalName:i.principalName})},[i]),c.useEffect(()=>{ue(this,null,function*(){try{const T=yield xt.getSchoolBranding();w({schoolName:T.schoolName||"",schoolMotto:T.schoolMotto||"",principalName:T.principalName||""})}catch(T){console.error("Error fetching branding from backend:",T)}})},[]);const[A,D]=c.useState({username:"",email:"",password:""}),[v,H]=c.useState({username:"",newPassword:""}),C=()=>{l(h.currentSession),r(h.currentTerm),E.success(`Academic session and term updated to ${h.currentSession} - ${h.currentTerm}`)},O=()=>ue(this,null,function*(){y(!0);try{yield xt.updateSchoolBranding({schoolName:j.schoolName,schoolMotto:j.schoolMotto,principalName:j.principalName}),a({schoolName:j.schoolName,schoolMotto:j.schoolMotto,principalName:j.principalName}),E.success("School branding updated successfully!")}catch(u){console.error("Failed to update branding:",u),E.error("Failed to save branding. Please try again.")}finally{y(!1)}}),f=u=>{if(u.preventDefault(),o.find(L=>L.username===A.username)){E.error("Username already exists. Please choose a different username.");return}N({username:A.username,password:A.password,role:"admin",linkedId:0,email:A.email,status:"Active"}),E.success("New admin account created successfully!"),D({username:"",email:"",password:""})},F=()=>{if(!v.username||!v.newPassword){E.error("Please enter both username and new password");return}const u=o.find(L=>L.username===v.username);if(!u){E.error("User not found");return}g(u.id,"",v.newPassword)?(E.success(`Password reset successful for ${v.username}!`),H({username:"",newPassword:""})):E.error("Password reset failed")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-white mb-2",children:"System Settings"}),e.jsx("p",{className:"text-[#C0C8D3]",children:"Configure school system settings and administration"})]}),e.jsxs(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg max-w-4xl",children:[e.jsx(me,{className:"p-5 border-b border-white/10",children:e.jsx("h3",{className:"text-white",children:"School Branding"})}),e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"w-32 h-32 rounded-xl bg-gradient-to-br from-[#1E90FF] to-[#00BFFF] flex items-center justify-center border-4 border-white/10",children:e.jsx("span",{className:"text-white text-center px-4",children:"School Logo"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-white mb-3",children:"Upload School Logo"}),e.jsxs(G,{className:"bg-[#1E90FF] hover:bg-[#00BFFF] text-white rounded-xl shadow-md hover:scale-105 transition-all",children:[e.jsx(Ke,{className:"w-4 h-4 mr-2"}),"Choose File"]}),e.jsx("p",{className:"text-xs text-[#C0C8D3] mt-2",children:"Recommended: 512x512px, PNG or JPG"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"School Name"}),e.jsx(ae,{value:j.schoolName,onChange:u=>w(S(x({},j),{schoolName:u.target.value})),className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"School Motto"}),e.jsx(ae,{value:j.schoolMotto,onChange:u=>w(S(x({},j),{schoolMotto:u.target.value})),className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"Principal Name"}),e.jsx(ae,{value:j.principalName,onChange:u=>w(S(x({},j),{principalName:u.target.value})),className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white"})]}),e.jsxs(G,{onClick:O,disabled:b,className:"bg-[#28A745] hover:bg-[#28A745]/90 text-white rounded-xl shadow-md hover:scale-105 transition-all",children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),b?"Saving...":"Save Branding"]})]})})]}),e.jsxs(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg max-w-4xl",children:[e.jsx(me,{className:"p-5 border-b border-white/10",children:e.jsx("h3",{className:"text-white",children:"Academic Session & Term"})}),e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"Current Academic Session"}),e.jsxs(ce,{value:h.currentSession,onValueChange:u=>I(S(x({},h),{currentSession:u})),children:[e.jsx(ie,{className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white",children:e.jsx(de,{})}),e.jsxs(oe,{className:"bg-[#0F243E] border-white/10",children:[e.jsx(_,{value:"2023/2024",className:"text-white hover:bg-[#1E90FF]",children:"2023/2024"}),e.jsx(_,{value:"2024/2025",className:"text-white hover:bg-[#1E90FF]",children:"2024/2025"}),e.jsx(_,{value:"2025/2026",className:"text-white hover:bg-[#1E90FF]",children:"2025/2026"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"Current Term"}),e.jsxs(ce,{value:h.currentTerm,onValueChange:u=>I(S(x({},h),{currentTerm:u})),children:[e.jsx(ie,{className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white",children:e.jsx(de,{})}),e.jsxs(oe,{className:"bg-[#0F243E] border-white/10",children:[e.jsx(_,{value:"First Term",className:"text-white hover:bg-[#1E90FF]",children:"First Term"}),e.jsx(_,{value:"Second Term",className:"text-white hover:bg-[#1E90FF]",children:"Second Term"}),e.jsx(_,{value:"Third Term",className:"text-white hover:bg-[#1E90FF]",children:"Third Term"})]})]})]})]}),e.jsx("div",{className:"p-4 bg-[#1E90FF]/10 border border-[#1E90FF] rounded-xl",children:e.jsxs("p",{className:"text-[#C0C8D3]",children:[e.jsx("strong",{className:"text-white",children:"Note:"})," Changing the session or term will affect all result entries and fee structures. Please ensure all current term results are finalized before updating."]})}),e.jsxs(G,{onClick:C,className:"bg-[#1E90FF] hover:bg-[#00BFFF] text-white rounded-xl shadow-md hover:scale-105 transition-all",children:[e.jsx(Ar,{className:"w-4 h-4 mr-2"}),"Update Session & Term"]})]})})]}),e.jsxs(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg max-w-4xl",children:[e.jsx(me,{className:"p-5 border-b border-white/10",children:e.jsx("h3",{className:"text-white",children:"Administrator Management"})}),e.jsxs(z,{className:"p-6",children:[e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"New Admin Username"}),e.jsx(ae,{required:!0,value:A.username,onChange:u=>D(S(x({},A),{username:u.target.value})),placeholder:"Enter username",className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"Admin Email"}),e.jsx(ae,{required:!0,type:"email",value:A.email,onChange:u=>D(S(x({},A),{email:u.target.value})),placeholder:"admin@gracelandgombe.edu",className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"Initial Password"}),e.jsx(ae,{required:!0,type:"password",value:A.password,onChange:u=>D(S(x({},A),{password:u.target.value})),placeholder:"Enter secure password",className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white"})]})]}),e.jsxs(G,{type:"submit",className:"bg-[#28A745] hover:bg-[#28A745]/90 text-white rounded-xl shadow-md hover:scale-105 transition-all",children:[e.jsx(_e,{className:"w-4 h-4 mr-2"}),"Create Admin Account"]})]}),e.jsx(El,{className:"my-6 bg-white/10"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-white",children:"Password Management"}),e.jsx("p",{className:"text-[#C0C8D3]",children:"Reset password for existing users (Admin, Teacher, Accountant, Parent)"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsx(ae,{placeholder:"Enter username",value:v.username,onChange:u=>H(S(x({},v),{username:u.target.value})),className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white"}),e.jsx(ae,{type:"password",placeholder:"Enter new password",value:v.newPassword,onChange:u=>H(S(x({},v),{newPassword:u.target.value})),className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white"})]}),e.jsx(G,{onClick:F,className:"bg-[#FFC107] hover:bg-[#FFC107]/90 text-[#0A2540] rounded-xl shadow-md hover:scale-105 transition-all whitespace-nowrap px-6",children:"Reset Password"})]})]})]}),e.jsxs(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg max-w-4xl",children:[e.jsx(me,{className:"p-5 border-b border-white/10",children:e.jsx("h3",{className:"text-white",children:"System Information"})}),e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-[#0F243E] rounded-xl border border-white/5",children:[e.jsx("p",{className:"text-[#C0C8D3] mb-1",children:"System Version"}),e.jsx("p",{className:"text-white",children:"v1.0.0"})]}),e.jsxs("div",{className:"p-4 bg-[#0F243E] rounded-xl border border-white/5",children:[e.jsx("p",{className:"text-[#C0C8D3] mb-1",children:"Last Backup"}),e.jsx("p",{className:"text-white",children:"2024-01-15 10:30 AM"})]}),e.jsxs("div",{className:"p-4 bg-[#0F243E] rounded-xl border border-white/5",children:[e.jsx("p",{className:"text-[#C0C8D3] mb-1",children:"Total Users"}),e.jsx("p",{className:"text-white",children:o.length})]}),e.jsxs("div",{className:"p-4 bg-[#0F243E] rounded-xl border border-white/5",children:[e.jsx("p",{className:"text-[#C0C8D3] mb-1",children:"System Status"}),e.jsx("p",{className:"text-[#28A745]",children:"Operational"})]})]})})]})]})}var $s="Switch",[Dl]=Rs($s),[Bl,Pl]=Dl($s),Zt=c.forwardRef((s,t)=>{const C=s,{__scopeSwitch:r,name:l,checked:i,defaultChecked:a,required:N,disabled:o,value:g="on",onCheckedChange:h,form:I}=C,j=X(C,["__scopeSwitch","name","checked","defaultChecked","required","disabled","value","onCheckedChange","form"]),[w,b]=c.useState(null),y=Ue(t,O=>b(O)),A=c.useRef(!1),D=w?I||!!w.closest("form"):!0,[v,H]=kt({prop:i,defaultProp:a!=null?a:!1,onChange:h,caller:$s});return e.jsxs(Bl,{scope:r,checked:v,disabled:o,children:[e.jsx(ze.button,S(x({type:"button",role:"switch","aria-checked":v,"aria-required":N,"data-state":aa(v),"data-disabled":o?"":void 0,disabled:o,value:g},j),{ref:y,onClick:je(s.onClick,O=>{H(f=>!f),D&&(A.current=O.isPropagationStopped(),A.current||O.stopPropagation())})})),D&&e.jsx(ta,{control:w,bubbles:!A.current,name:l,value:g,checked:v,required:N,disabled:o,form:I,style:{transform:"translateX(-100%)"}})]})});Zt.displayName=$s;var ea="SwitchThumb",sa=c.forwardRef((s,t)=>{const a=s,{__scopeSwitch:r}=a,l=X(a,["__scopeSwitch"]),i=Pl(ea,r);return e.jsx(ze.span,S(x({"data-state":aa(i.checked),"data-disabled":i.disabled?"":void 0},l),{ref:t}))});sa.displayName=ea;var Il="SwitchBubbleInput",ta=c.forwardRef((N,a)=>{var o=N,{__scopeSwitch:s,control:t,checked:r,bubbles:l=!0}=o,i=X(o,["__scopeSwitch","control","checked","bubbles"]);const g=c.useRef(null),h=Ue(g,a),I=or(r),j=hr(t);return c.useEffect(()=>{const w=g.current;if(!w)return;const b=window.HTMLInputElement.prototype,A=Object.getOwnPropertyDescriptor(b,"checked").set;if(I!==r&&A){const D=new Event("click",{bubbles:l});A.call(w,r),w.dispatchEvent(D)}},[I,r,l]),e.jsx("input",S(x({type:"checkbox","aria-hidden":!0,defaultChecked:r},i),{tabIndex:-1,ref:h,style:S(x(x({},i.style),j),{position:"absolute",pointerEvents:"none",opacity:0,margin:0})}))});ta.displayName=Il;function aa(s){return s?"checked":"unchecked"}var Tl=Zt,kl=sa;function Rl(r){var l=r,{className:s}=l,t=X(l,["className"]);return e.jsx(Tl,S(x({"data-slot":"switch",className:Ie("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-switch-background focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s)},t),{children:e.jsx(kl,{"data-slot":"switch-thumb",className:Ie("bg-card dark:data-[state=unchecked]:bg-card-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})}))}function Ml(){var U;const{students:s,users:t,updateStudent:r}=ve(),[l,i]=c.useState(""),[a,N]=c.useState(""),[o,g]=c.useState(null),[h,I]=c.useState(null),[j,w]=c.useState(!0),[b,y]=c.useState(!1),[A,D]=c.useState(null),[v,H]=c.useState(!1),[C,O]=c.useState(!1),[f,F]=c.useState({}),u=d=>s.filter(B=>B.parentId===d).length,T=d=>s.filter(B=>B.parentId===d),L=t.filter(d=>d.role==="parent"),ee=s.filter(d=>`${d.firstName} ${d.lastName}`.toLowerCase().includes(l.toLowerCase())||d.admissionNumber.toLowerCase().includes(l.toLowerCase())||d.className.toLowerCase().includes(l.toLowerCase())),K=L.filter(d=>{var B,k,p;return((B=d.name)==null?void 0:B.toLowerCase().includes(a.toLowerCase()))||((k=d.email)==null?void 0:k.toLowerCase().includes(a.toLowerCase()))||((p=d.phone)==null?void 0:p.toLowerCase().includes(a.toLowerCase()))}),re=()=>{const d={};return o||(d.student="Please select a student"),h||(d.parent="Please select a parent"),o&&h&&o.parentId===h.id&&(d.link=`${o.firstName} ${o.lastName} is already linked to ${h.name}`),h&&s.filter(k=>k.parentId===h.id).length>=10&&(d.parent=`${h.name} has reached the maximum number of children (10)`),F(d),Object.keys(d).length===0},ge=()=>ue(this,null,function*(){var d,B;if(!re()){E.error("Please fix all validation errors");return}H(!0);try{if(yield Ss.update(o.id,{parentId:h.id})){const p=j?" — Parent notified":"";E.success(`${o.firstName||o.name} linked to ${h.name}${p}`),g(null),I(null),F({})}else E.error("Failed to link student to parent")}catch(k){console.error("Error linking student to parent:",k);const p=((B=(d=k==null?void 0:k.response)==null?void 0:d.data)==null?void 0:B.message)||(k==null?void 0:k.message)||"Failed to link student to parent";E.error(p)}finally{H(!1)}}),he=d=>{D(d),y(!0)},se=()=>ue(this,null,function*(){var d,B;if(A){O(!0);try{yield Ss.update(A.id,{parentId:null}),E.success(`${A.firstName||A.name} unlinked successfully`),y(!1),D(null)}catch(k){console.error("Error unlinking student:",k);const p=((B=(d=k==null?void 0:k.response)==null?void 0:d.data)==null?void 0:B.message)||(k==null?void 0:k.message)||"Failed to unlink student";E.error(p)}finally{O(!1)}}}),Z=()=>{const d=document.createElement("input");d.type="file",d.accept=".csv",d.onchange=B=>ue(this,null,function*(){var p;const k=(p=B.target.files)==null?void 0:p[0];if(k){const Q=new FileReader;Q.onload=W=>ue(this,null,function*(){var R,n,m;try{const J=((R=W.target)==null?void 0:R.result).split(`
`),te=J[0].split(",");if(!["studentId","parentId"].every(fe=>te.includes(fe))){E.error("CSV must contain columns: studentId, parentId");return}let Ne=0;for(let fe=1;fe<J.length;fe++)if(J[fe].trim()){const be=J[fe].split(","),Xe=(n=be[te.indexOf("studentId")])==null?void 0:n.trim(),Us=(m=be[te.indexOf("parentId")])==null?void 0:m.trim();if(Xe&&Us)try{yield Ss.update(parseInt(Xe),{parentId:parseInt(Us)}),Ne++}catch(za){console.error(`Failed to link student ${Xe} to parent ${Us}:`,za)}}E.success(`Successfully linked ${Ne} students to parents`)}catch(P){E.error("Failed to parse CSV file")}}),Q.readAsText(k)}}),d.click()};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-white mb-2",children:"Link Student to Parent"}),e.jsx("p",{className:"text-[#C0C8D3]",children:"Connect students with their parents/guardians for portal access"})]}),e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-[#1E90FF] shadow-lg",children:e.jsx(z,{className:"p-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-[#1E90FF]/20 flex items-center justify-center",children:e.jsx(Ke,{className:"w-6 h-6 text-[#1E90FF]"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white mb-1",children:"Bulk Link (CSV Import)"}),e.jsx("p",{className:"text-sm text-[#C0C8D3]",children:"Upload CSV with format: admission_no, parent_phone_or_email"})]})]}),e.jsxs(G,{onClick:Z,className:"bg-[#1E90FF] hover:bg-[#00BFFF] text-white rounded-xl shadow-md",children:[e.jsx(Ke,{className:"w-4 h-4 mr-2"}),"Import CSV"]})]})})}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:[e.jsx(me,{className:"p-5 bg-gradient-to-r from-[#1E90FF] to-[#00BFFF] rounded-t-xl",children:e.jsxs("h3",{className:"text-white flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5"}),"Select Student"]})}),e.jsxs(z,{className:"p-5 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Re,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#C0C8D3]"}),e.jsx(ae,{value:l,onChange:d=>i(d.target.value),placeholder:"Search by name, admission no, or class...",className:"h-12 pl-10 rounded-xl border border-white/10 bg-[#0F243E] text-white"})]}),o&&e.jsxs("div",{className:"p-4 bg-[#28A745]/10 border border-[#28A745] rounded-xl",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Cs,{className:"w-12 h-12 border-2 border-[#28A745]",children:e.jsx(Fs,{className:"bg-[#28A745] text-white",children:(o.full_name||o.name||"").split(" ").map(d=>d[0]).join("")})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white",children:o.full_name||o.name}),e.jsx("p",{className:"text-sm text-[#C0C8D3]",children:o.reg_no||o.admissionNo})]})]}),e.jsx(G,{onClick:()=>g(null),size:"sm",className:"h-8 w-8 p-0 bg-[#DC3545] hover:bg-[#DC3545]/90 rounded-full",children:e.jsx(ds,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{className:"bg-[#1E90FF] text-white border-0",children:((U=o.Class)==null?void 0:U.name)||o.class}),o.hasParent&&e.jsx(le,{className:"bg-[#FFC107] text-white border-0",children:"Already Linked"})]})]}),e.jsxs("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[ee.map(d=>e.jsx("button",{onClick:()=>g(d),className:`w-full p-3 rounded-xl transition-all text-left ${(o==null?void 0:o.id)===d.id?"bg-[#28A745]/20 border-2 border-[#28A745]":"bg-[#0F243E] border border-white/10 hover:border-[#1E90FF] hover:bg-[#132C4A]"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Cs,{className:"w-10 h-10",children:e.jsx(Fs,{className:"bg-[#1E90FF] text-white text-sm",children:(`${d.firstName} ${d.lastName}`||"S").split(" ").map(B=>B[0]).join("")})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-white",children:`${d.firstName} ${d.lastName}`}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("p",{className:"text-xs text-[#C0C8D3]",children:d.admissionNumber}),e.jsx("span",{className:"text-[#C0C8D3]",children:"•"}),e.jsx("p",{className:"text-xs text-[#C0C8D3]",children:d.className})]})]}),d.parentId&&e.jsx($e,{className:"w-4 h-4 text-[#28A745]"})]})},d.id)),ee.length===0&&e.jsx("div",{className:"p-8 text-center",children:e.jsx("p",{className:"text-[#C0C8D3]",children:"No students found"})})]})]})]}),e.jsxs(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:[e.jsx(me,{className:"p-5 bg-gradient-to-r from-[#28A745] to-[#28A745]/80 rounded-t-xl",children:e.jsxs("h3",{className:"text-white flex items-center gap-2",children:[e.jsx(Sr,{className:"w-5 h-5"}),"Select Parent"]})}),e.jsxs(z,{className:"p-5 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Re,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#C0C8D3]"}),e.jsx(ae,{value:a,onChange:d=>N(d.target.value),placeholder:"Search by name, phone, or email...",className:"h-12 pl-10 rounded-xl border border-white/10 bg-[#0F243E] text-white"})]}),h&&e.jsxs("div",{className:"p-4 bg-[#28A745]/10 border border-[#28A745] rounded-xl",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Cs,{className:"w-12 h-12 border-2 border-[#28A745]",children:e.jsx(Fs,{className:"bg-[#28A745] text-white",children:h.name.split(" ").map(d=>d[0]).join("")})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white",children:h.name}),e.jsx("p",{className:"text-sm text-[#C0C8D3]",children:h.phone})]})]}),e.jsx(G,{onClick:()=>I(null),size:"sm",className:"h-8 w-8 p-0 bg-[#DC3545] hover:bg-[#DC3545]/90 rounded-full",children:e.jsx(ds,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-sm text-[#C0C8D3]",children:h.email}),e.jsx("div",{className:"mt-2",children:e.jsxs(le,{className:"bg-[#1E90FF] text-white border-0",children:[h.linkedChildren.length," child(ren) linked"]})})]}),e.jsxs("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[K.map(d=>e.jsxs("div",{children:[e.jsx("button",{onClick:()=>I(d),className:`w-full p-3 rounded-xl transition-all text-left ${(h==null?void 0:h.id)===d.id?"bg-[#28A745]/20 border-2 border-[#28A745]":"bg-[#0F243E] border border-white/10 hover:border-[#28A745] hover:bg-[#132C4A]"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Cs,{className:"w-10 h-10",children:e.jsx(Fs,{className:"bg-[#28A745] text-white text-sm",children:d.name.split(" ").map(B=>B[0]).join("")})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-white",children:d.name}),e.jsx("p",{className:"text-xs text-[#C0C8D3] mt-1",children:d.phone})]}),e.jsx(le,{className:"bg-[#1E90FF] text-white border-0 text-xs",children:u(d.id)})]})}),(h==null?void 0:h.id)===d.id&&T(d.id).length>0&&e.jsxs("div",{className:"ml-4 mt-2 space-y-2",children:[e.jsx("p",{className:"text-xs text-[#C0C8D3]",children:"Currently linked children:"}),T(d.id).map((B,k)=>e.jsxs("div",{className:"p-2 bg-[#0F243E] rounded-lg border border-white/5 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white text-sm",children:`${B.firstName} ${B.lastName}`}),e.jsxs("p",{className:"text-xs text-[#C0C8D3]",children:[B.className," • Linked"]})]}),e.jsxs(G,{onClick:()=>he(B),size:"sm",className:"h-7 px-3 bg-[#DC3545] hover:bg-[#DC3545]/90 rounded-lg text-xs",children:[e.jsx(Yr,{className:"w-3 h-3 mr-1"}),"Unlink"]})]},k))]})]},d.id)),K.length===0&&e.jsx("div",{className:"p-8 text-center",children:e.jsx("p",{className:"text-[#C0C8D3]",children:"No parents found"})})]})]})]})]}),e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-[#1E90FF]/20 flex items-center justify-center",children:e.jsx(Oe,{className:"w-6 h-6 text-[#1E90FF]"})}),e.jsxs("div",{children:[e.jsx($,{className:"text-white",children:"Notify Parent of Link"}),e.jsx("p",{className:"text-sm text-[#C0C8D3]",children:"Send in-app notification and optional email/SMS"})]})]}),e.jsx(Rl,{checked:j,onCheckedChange:w})]}),e.jsxs(G,{onClick:ge,disabled:!o||!h,className:"h-12 px-8 bg-[#28A745] hover:bg-[#28A745]/90 text-white rounded-xl shadow-md hover:scale-105 transition-all disabled:opacity-50 disabled:hover:scale-100",children:[e.jsx(Oe,{className:"w-5 h-5 mr-2"}),"Link Selected"]})]})})}),e.jsx(xs,{open:b,onOpenChange:y,children:e.jsxs(ms,{className:"bg-[#132C4A] border border-white/10",children:[e.jsxs(us,{children:[e.jsx(js,{className:"text-white",children:"Unlink Child?"}),e.jsxs(ps,{className:"text-[#C0C8D3]",children:["Are you sure you want to unlink ",A==null?void 0:A.name,"? The parent will lose access to this child's information."]})]}),e.jsxs(gs,{children:[e.jsx(bs,{className:"bg-[#0F243E] text-white border-white/10 hover:bg-[#132C4A]",children:"Cancel"}),e.jsx(Ns,{onClick:se,className:"bg-[#DC3545] hover:bg-[#DC3545]/90",children:"Unlink"})]})]})})]})}function $l(s){const t=_l(s),r=c.forwardRef((l,i)=>{const h=l,{children:a}=h,N=X(h,["children"]),o=c.Children.toArray(a),g=o.find(Ol);if(g){const I=g.props.children,j=o.map(w=>w===g?c.Children.count(I)>1?c.Children.only(null):c.isValidElement(I)?I.props.children:null:w);return e.jsx(t,S(x({},N),{ref:i,children:c.isValidElement(I)?c.cloneElement(I,void 0,j):null}))}return e.jsx(t,S(x({},N),{ref:i,children:a}))});return r.displayName=`${s}.Slot`,r}function _l(s){const t=c.forwardRef((r,l)=>{const N=r,{children:i}=N,a=X(N,["children"]);if(c.isValidElement(i)){const o=Vl(i),g=Ul(a,i.props);return i.type!==c.Fragment&&(g.ref=l?Xs(l,o):o),c.cloneElement(i,g)}return c.Children.count(i)>1?c.Children.only(null):null});return t.displayName=`${s}.SlotClone`,t}var Ll=Symbol("radix.slottable");function Ol(s){return c.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===Ll}function Ul(s,t){const r=x({},t);for(const l in t){const i=s[l],a=t[l];/^on[A-Z]/.test(l)?i&&a?r[l]=(...o)=>{const g=a(...o);return i(...o),g}:i&&(r[l]=i):l==="style"?r[l]=x(x({},i),a):l==="className"&&(r[l]=[i,a].filter(Boolean).join(" "))}return x(x({},s),r)}function Vl(s){var l,i;let t=(l=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:l.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(i=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:i.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}var Ws=["Enter"," "],zl=["ArrowDown","PageUp","Home"],ra=["ArrowUp","PageDown","End"],ql=[...zl,...ra],Gl={ltr:[...Ws,"ArrowRight"],rtl:[...Ws,"ArrowLeft"]},Yl={ltr:["ArrowLeft"],rtl:["ArrowRight"]},fs="Menu",[os,Kl,Hl]=xr(fs),[Je,la]=Rs(fs,[Hl,Rt,Pt]),_s=Rt(),na=Pt(),[Jl,We]=Je(fs),[Wl,vs]=Je(fs),ca=s=>{const{__scopeMenu:t,open:r=!1,children:l,dir:i,onOpenChange:a,modal:N=!0}=s,o=_s(t),[g,h]=c.useState(null),I=c.useRef(!1),j=Mt(a),w=mr(i);return c.useEffect(()=>{const b=()=>{I.current=!0,document.addEventListener("pointerdown",y,{capture:!0,once:!0}),document.addEventListener("pointermove",y,{capture:!0,once:!0})},y=()=>I.current=!1;return document.addEventListener("keydown",b,{capture:!0}),()=>{document.removeEventListener("keydown",b,{capture:!0}),document.removeEventListener("pointerdown",y,{capture:!0}),document.removeEventListener("pointermove",y,{capture:!0})}},[]),e.jsx(ur,S(x({},o),{children:e.jsx(Jl,{scope:t,open:r,onOpenChange:j,content:g,onContentChange:h,children:e.jsx(Wl,{scope:t,onClose:c.useCallback(()=>j(!1),[j]),isUsingKeyboardRef:I,dir:w,modal:N,children:l})})}))};ca.displayName=fs;var Xl="MenuAnchor",Zs=c.forwardRef((s,t)=>{const a=s,{__scopeMenu:r}=a,l=X(a,["__scopeMenu"]),i=_s(r);return e.jsx(gr,S(x(x({},i),l),{ref:t}))});Zs.displayName=Xl;var et="MenuPortal",[Ql,ia]=Je(et,{forceMount:void 0}),da=s=>{const{__scopeMenu:t,forceMount:r,children:l,container:i}=s,a=We(et,t);return e.jsx(Ql,{scope:t,forceMount:r,children:e.jsx(ks,{present:r||a.open,children:e.jsx(jr,{asChild:!0,container:i,children:l})})})};da.displayName=et;var ke="MenuContent",[Zl,st]=Je(ke),oa=c.forwardRef((s,t)=>{const r=ia(ke,s.__scopeMenu),o=s,{forceMount:l=r.forceMount}=o,i=X(o,["forceMount"]),a=We(ke,s.__scopeMenu),N=vs(ke,s.__scopeMenu);return e.jsx(os.Provider,{scope:s.__scopeMenu,children:e.jsx(ks,{present:l||a.open,children:e.jsx(os.Slot,{scope:s.__scopeMenu,children:N.modal?e.jsx(en,S(x({},i),{ref:t})):e.jsx(sn,S(x({},i),{ref:t}))})})})}),en=c.forwardRef((s,t)=>{const r=We(ke,s.__scopeMenu),l=c.useRef(null),i=Ue(t,l);return c.useEffect(()=>{const a=l.current;if(a)return pr(a)},[]),e.jsx(tt,S(x({},s),{ref:i,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:je(s.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)}))}),sn=c.forwardRef((s,t)=>{const r=We(ke,s.__scopeMenu);return e.jsx(tt,S(x({},s),{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)}))}),tn=$l("MenuContent.ScrollLock"),tt=c.forwardRef((s,t)=>{const B=s,{__scopeMenu:r,loop:l=!1,trapFocus:i,onOpenAutoFocus:a,onCloseAutoFocus:N,disableOutsidePointerEvents:o,onEntryFocus:g,onEscapeKeyDown:h,onPointerDownOutside:I,onFocusOutside:j,onInteractOutside:w,onDismiss:b,disableOutsideScroll:y}=B,A=X(B,["__scopeMenu","loop","trapFocus","onOpenAutoFocus","onCloseAutoFocus","disableOutsidePointerEvents","onEntryFocus","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside","onDismiss","disableOutsideScroll"]),D=We(ke,r),v=vs(ke,r),H=_s(r),C=na(r),O=Kl(r),[f,F]=c.useState(null),u=c.useRef(null),T=Ue(t,u,D.onContentChange),L=c.useRef(0),ee=c.useRef(""),K=c.useRef(0),re=c.useRef(null),ge=c.useRef("right"),he=c.useRef(0),se=y?fr:c.Fragment,Z=y?{as:tn,allowPinchZoom:!0}:void 0,U=k=>{var J,te;const p=ee.current+k,Q=O().filter(Y=>!Y.disabled),W=document.activeElement,R=(J=Q.find(Y=>Y.ref.current===W))==null?void 0:J.textValue,n=Q.map(Y=>Y.textValue),m=gn(n,p,R),P=(te=Q.find(Y=>Y.textValue===m))==null?void 0:te.ref.current;(function Y(ne){ee.current=ne,window.clearTimeout(L.current),ne!==""&&(L.current=window.setTimeout(()=>Y(""),1e3))})(p),P&&setTimeout(()=>P.focus())};c.useEffect(()=>()=>window.clearTimeout(L.current),[]),br();const d=c.useCallback(k=>{var Q,W;return ge.current===((Q=re.current)==null?void 0:Q.side)&&pn(k,(W=re.current)==null?void 0:W.area)},[]);return e.jsx(Zl,{scope:r,searchRef:ee,onItemEnter:c.useCallback(k=>{d(k)&&k.preventDefault()},[d]),onItemLeave:c.useCallback(k=>{var p;d(k)||((p=u.current)==null||p.focus(),F(null))},[d]),onTriggerLeave:c.useCallback(k=>{d(k)&&k.preventDefault()},[d]),pointerGraceTimerRef:K,onPointerGraceIntentChange:c.useCallback(k=>{re.current=k},[]),children:e.jsx(se,S(x({},Z),{children:e.jsx(vr,{asChild:!0,trapped:i,onMountAutoFocus:je(a,k=>{var p;k.preventDefault(),(p=u.current)==null||p.focus({preventScroll:!0})}),onUnmountAutoFocus:N,children:e.jsx(wr,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:h,onPointerDownOutside:I,onFocusOutside:j,onInteractOutside:w,onDismiss:b,children:e.jsx(ar,S(x({asChild:!0},C),{dir:v.dir,orientation:"vertical",loop:l,currentTabStopId:f,onCurrentTabStopIdChange:F,onEntryFocus:je(g,k=>{v.isUsingKeyboardRef.current||k.preventDefault()}),preventScrollOnEntryFocus:!0,children:e.jsx(yr,S(x(x({role:"menu","aria-orientation":"vertical","data-state":Sa(D.open),"data-radix-menu-content":"",dir:v.dir},H),A),{ref:T,style:x({outline:"none"},A.style),onKeyDown:je(A.onKeyDown,k=>{const Q=k.target.closest("[data-radix-menu-content]")===k.currentTarget,W=k.ctrlKey||k.altKey||k.metaKey,R=k.key.length===1;Q&&(k.key==="Tab"&&k.preventDefault(),!W&&R&&U(k.key));const n=u.current;if(k.target!==n||!ql.includes(k.key))return;k.preventDefault();const P=O().filter(J=>!J.disabled).map(J=>J.ref.current);ra.includes(k.key)&&P.reverse(),mn(P)}),onBlur:je(s.onBlur,k=>{k.currentTarget.contains(k.target)||(window.clearTimeout(L.current),ee.current="")}),onPointerMove:je(s.onPointerMove,hs(k=>{const p=k.target,Q=he.current!==k.clientX;if(k.currentTarget.contains(p)&&Q){const W=k.clientX>he.current?"right":"left";ge.current=W,he.current=k.clientX}}))}))}))})})}))})});oa.displayName=ke;var an="MenuGroup",at=c.forwardRef((s,t)=>{const i=s,{__scopeMenu:r}=i,l=X(i,["__scopeMenu"]);return e.jsx(ze.div,S(x({role:"group"},l),{ref:t}))});at.displayName=an;var rn="MenuLabel",ha=c.forwardRef((s,t)=>{const i=s,{__scopeMenu:r}=i,l=X(i,["__scopeMenu"]);return e.jsx(ze.div,S(x({},l),{ref:t}))});ha.displayName=rn;var Bs="MenuItem",St="menu.itemSelect",Ls=c.forwardRef((s,t)=>{const j=s,{disabled:r=!1,onSelect:l}=j,i=X(j,["disabled","onSelect"]),a=c.useRef(null),N=vs(Bs,s.__scopeMenu),o=st(Bs,s.__scopeMenu),g=Ue(t,a),h=c.useRef(!1),I=()=>{const w=a.current;if(!r&&w){const b=new CustomEvent(St,{bubbles:!0,cancelable:!0});w.addEventListener(St,y=>l==null?void 0:l(y),{once:!0}),Nr(w,b),b.defaultPrevented?h.current=!1:N.onClose()}};return e.jsx(xa,S(x({},i),{ref:g,disabled:r,onClick:je(s.onClick,I),onPointerDown:w=>{var b;(b=s.onPointerDown)==null||b.call(s,w),h.current=!0},onPointerUp:je(s.onPointerUp,w=>{var b;h.current||(b=w.currentTarget)==null||b.click()}),onKeyDown:je(s.onKeyDown,w=>{const b=o.searchRef.current!=="";r||b&&w.key===" "||Ws.includes(w.key)&&(w.currentTarget.click(),w.preventDefault())})}))});Ls.displayName=Bs;var xa=c.forwardRef((s,t)=>{const y=s,{__scopeMenu:r,disabled:l=!1,textValue:i}=y,a=X(y,["__scopeMenu","disabled","textValue"]),N=st(Bs,r),o=na(r),g=c.useRef(null),h=Ue(t,g),[I,j]=c.useState(!1),[w,b]=c.useState("");return c.useEffect(()=>{var D;const A=g.current;A&&b(((D=A.textContent)!=null?D:"").trim())},[a.children]),e.jsx(os.ItemSlot,{scope:r,disabled:l,textValue:i!=null?i:w,children:e.jsx(tr,S(x({asChild:!0},o),{focusable:!l,children:e.jsx(ze.div,S(x({role:"menuitem","data-highlighted":I?"":void 0,"aria-disabled":l||void 0,"data-disabled":l?"":void 0},a),{ref:h,onPointerMove:je(s.onPointerMove,hs(A=>{l?N.onItemLeave(A):(N.onItemEnter(A),A.defaultPrevented||A.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:je(s.onPointerLeave,hs(A=>N.onItemLeave(A))),onFocus:je(s.onFocus,()=>j(!0)),onBlur:je(s.onBlur,()=>j(!1))}))}))})}),ln="MenuCheckboxItem",ma=c.forwardRef((s,t)=>{const a=s,{checked:r=!1,onCheckedChange:l}=a,i=X(a,["checked","onCheckedChange"]);return e.jsx(Na,{scope:s.__scopeMenu,checked:r,children:e.jsx(Ls,S(x({role:"menuitemcheckbox","aria-checked":Ps(r)?"mixed":r},i),{ref:t,"data-state":lt(r),onSelect:je(i.onSelect,()=>l==null?void 0:l(Ps(r)?!0:!r),{checkForDefaultPrevented:!1})}))})});ma.displayName=ln;var ua="MenuRadioGroup",[nn,cn]=Je(ua,{value:void 0,onValueChange:()=>{}}),ga=c.forwardRef((s,t)=>{const N=s,{value:r,onValueChange:l}=N,i=X(N,["value","onValueChange"]),a=Mt(l);return e.jsx(nn,{scope:s.__scopeMenu,value:r,onValueChange:a,children:e.jsx(at,S(x({},i),{ref:t}))})});ga.displayName=ua;var ja="MenuRadioItem",pa=c.forwardRef((s,t)=>{const N=s,{value:r}=N,l=X(N,["value"]),i=cn(ja,s.__scopeMenu),a=r===i.value;return e.jsx(Na,{scope:s.__scopeMenu,checked:a,children:e.jsx(Ls,S(x({role:"menuitemradio","aria-checked":a},l),{ref:t,"data-state":lt(a),onSelect:je(l.onSelect,()=>{var o;return(o=i.onValueChange)==null?void 0:o.call(i,r)},{checkForDefaultPrevented:!1})}))})});pa.displayName=ja;var rt="MenuItemIndicator",[Na,dn]=Je(rt,{checked:!1}),ba=c.forwardRef((s,t)=>{const N=s,{__scopeMenu:r,forceMount:l}=N,i=X(N,["__scopeMenu","forceMount"]),a=dn(rt,r);return e.jsx(ks,{present:l||Ps(a.checked)||a.checked===!0,children:e.jsx(ze.span,S(x({},i),{ref:t,"data-state":lt(a.checked)}))})});ba.displayName=rt;var on="MenuSeparator",fa=c.forwardRef((s,t)=>{const i=s,{__scopeMenu:r}=i,l=X(i,["__scopeMenu"]);return e.jsx(ze.div,S(x({role:"separator","aria-orientation":"horizontal"},l),{ref:t}))});fa.displayName=on;var hn="MenuArrow",va=c.forwardRef((s,t)=>{const a=s,{__scopeMenu:r}=a,l=X(a,["__scopeMenu"]),i=_s(r);return e.jsx(Cr,S(x(x({},i),l),{ref:t}))});va.displayName=hn;var xn="MenuSub",[Wc,wa]=Je(xn),ns="MenuSubTrigger",ya=c.forwardRef((s,t)=>{const r=We(ns,s.__scopeMenu),l=vs(ns,s.__scopeMenu),i=wa(ns,s.__scopeMenu),a=st(ns,s.__scopeMenu),N=c.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:g}=a,h={__scopeMenu:s.__scopeMenu},I=c.useCallback(()=>{N.current&&window.clearTimeout(N.current),N.current=null},[]);return c.useEffect(()=>I,[I]),c.useEffect(()=>{const j=o.current;return()=>{window.clearTimeout(j),g(null)}},[o,g]),e.jsx(Zs,S(x({asChild:!0},h),{children:e.jsx(xa,S(x({id:i.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":i.contentId,"data-state":Sa(r.open)},s),{ref:Xs(t,i.onTriggerChange),onClick:j=>{var w;(w=s.onClick)==null||w.call(s,j),!(s.disabled||j.defaultPrevented)&&(j.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:je(s.onPointerMove,hs(j=>{a.onItemEnter(j),!j.defaultPrevented&&!s.disabled&&!r.open&&!N.current&&(a.onPointerGraceIntentChange(null),N.current=window.setTimeout(()=>{r.onOpenChange(!0),I()},100))})),onPointerLeave:je(s.onPointerLeave,hs(j=>{var b,y;I();const w=(b=r.content)==null?void 0:b.getBoundingClientRect();if(w){const A=(y=r.content)==null?void 0:y.dataset.side,D=A==="right",v=D?-5:5,H=w[D?"left":"right"],C=w[D?"right":"left"];a.onPointerGraceIntentChange({area:[{x:j.clientX+v,y:j.clientY},{x:H,y:w.top},{x:C,y:w.top},{x:C,y:w.bottom},{x:H,y:w.bottom}],side:A}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>a.onPointerGraceIntentChange(null),300)}else{if(a.onTriggerLeave(j),j.defaultPrevented)return;a.onPointerGraceIntentChange(null)}})),onKeyDown:je(s.onKeyDown,j=>{var b;const w=a.searchRef.current!=="";s.disabled||w&&j.key===" "||Gl[l.dir].includes(j.key)&&(r.onOpenChange(!0),(b=r.content)==null||b.focus(),j.preventDefault())})}))}))});ya.displayName=ns;var Ca="MenuSubContent",Fa=c.forwardRef((s,t)=>{const r=ia(ke,s.__scopeMenu),I=s,{forceMount:l=r.forceMount}=I,i=X(I,["forceMount"]),a=We(ke,s.__scopeMenu),N=vs(ke,s.__scopeMenu),o=wa(Ca,s.__scopeMenu),g=c.useRef(null),h=Ue(t,g);return e.jsx(os.Provider,{scope:s.__scopeMenu,children:e.jsx(ks,{present:l||a.open,children:e.jsx(os.Slot,{scope:s.__scopeMenu,children:e.jsx(tt,S(x({id:o.contentId,"aria-labelledby":o.triggerId},i),{ref:h,align:"start",side:N.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:j=>{var w;N.isUsingKeyboardRef.current&&((w=g.current)==null||w.focus()),j.preventDefault()},onCloseAutoFocus:j=>j.preventDefault(),onFocusOutside:je(s.onFocusOutside,j=>{j.target!==o.trigger&&a.onOpenChange(!1)}),onEscapeKeyDown:je(s.onEscapeKeyDown,j=>{N.onClose(),j.preventDefault()}),onKeyDown:je(s.onKeyDown,j=>{var y;const w=j.currentTarget.contains(j.target),b=Yl[N.dir].includes(j.key);w&&b&&(a.onOpenChange(!1),(y=o.trigger)==null||y.focus(),j.preventDefault())})}))})})})});Fa.displayName=Ca;function Sa(s){return s?"open":"closed"}function Ps(s){return s==="indeterminate"}function lt(s){return Ps(s)?"indeterminate":s?"checked":"unchecked"}function mn(s){const t=document.activeElement;for(const r of s)if(r===t||(r.focus(),document.activeElement!==t))return}function un(s,t){return s.map((r,l)=>s[(t+l)%s.length])}function gn(s,t,r){const i=t.length>1&&Array.from(t).every(h=>h===t[0])?t[0]:t,a=r?s.indexOf(r):-1;let N=un(s,Math.max(a,0));i.length===1&&(N=N.filter(h=>h!==r));const g=N.find(h=>h.toLowerCase().startsWith(i.toLowerCase()));return g!==r?g:void 0}function jn(s,t){const{x:r,y:l}=s;let i=!1;for(let a=0,N=t.length-1;a<t.length;N=a++){const o=t[a],g=t[N],h=o.x,I=o.y,j=g.x,w=g.y;I>l!=w>l&&r<(j-h)*(l-I)/(w-I)+h&&(i=!i)}return i}function pn(s,t){if(!t)return!1;const r={x:s.clientX,y:s.clientY};return jn(r,t)}function hs(s){return t=>t.pointerType==="mouse"?s(t):void 0}var Nn=ca,bn=Zs,fn=da,vn=oa,wn=at,yn=ha,Cn=Ls,Fn=ma,Sn=ga,En=pa,An=ba,Dn=fa,Bn=va,Pn=ya,In=Fa,Os="DropdownMenu",[Tn]=Rs(Os,[la]),Ae=la(),[kn,Ea]=Tn(Os),Aa=s=>{const{__scopeDropdownMenu:t,children:r,dir:l,open:i,defaultOpen:a,onOpenChange:N,modal:o=!0}=s,g=Ae(t),h=c.useRef(null),[I,j]=kt({prop:i,defaultProp:a!=null?a:!1,onChange:N,caller:Os});return e.jsx(kn,{scope:t,triggerId:pt(),triggerRef:h,contentId:pt(),open:I,onOpenChange:j,onOpenToggle:c.useCallback(()=>j(w=>!w),[j]),modal:o,children:e.jsx(Nn,S(x({},g),{open:I,onOpenChange:j,dir:l,modal:o,children:r}))})};Aa.displayName=Os;var Da="DropdownMenuTrigger",Ba=c.forwardRef((s,t)=>{const o=s,{__scopeDropdownMenu:r,disabled:l=!1}=o,i=X(o,["__scopeDropdownMenu","disabled"]),a=Ea(Da,r),N=Ae(r);return e.jsx(bn,S(x({asChild:!0},N),{children:e.jsx(ze.button,S(x({type:"button",id:a.triggerId,"aria-haspopup":"menu","aria-expanded":a.open,"aria-controls":a.open?a.contentId:void 0,"data-state":a.open?"open":"closed","data-disabled":l?"":void 0,disabled:l},i),{ref:Xs(t,a.triggerRef),onPointerDown:je(s.onPointerDown,g=>{!l&&g.button===0&&g.ctrlKey===!1&&(a.onOpenToggle(),a.open||g.preventDefault())}),onKeyDown:je(s.onKeyDown,g=>{l||(["Enter"," "].includes(g.key)&&a.onOpenToggle(),g.key==="ArrowDown"&&a.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(g.key)&&g.preventDefault())})}))}))});Ba.displayName=Da;var Rn="DropdownMenuPortal",Pa=s=>{const i=s,{__scopeDropdownMenu:t}=i,r=X(i,["__scopeDropdownMenu"]),l=Ae(t);return e.jsx(fn,x(x({},l),r))};Pa.displayName=Rn;var Ia="DropdownMenuContent",Ta=c.forwardRef((s,t)=>{const o=s,{__scopeDropdownMenu:r}=o,l=X(o,["__scopeDropdownMenu"]),i=Ea(Ia,r),a=Ae(r),N=c.useRef(!1);return e.jsx(vn,S(x(x({id:i.contentId,"aria-labelledby":i.triggerId},a),l),{ref:t,onCloseAutoFocus:je(s.onCloseAutoFocus,g=>{var h;N.current||(h=i.triggerRef.current)==null||h.focus(),N.current=!1,g.preventDefault()}),onInteractOutside:je(s.onInteractOutside,g=>{const h=g.detail.originalEvent,I=h.button===0&&h.ctrlKey===!0,j=h.button===2||I;(!i.modal||j)&&(N.current=!0)}),style:S(x({},s.style),{"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"})}))});Ta.displayName=Ia;var Mn="DropdownMenuGroup",$n=c.forwardRef((s,t)=>{const a=s,{__scopeDropdownMenu:r}=a,l=X(a,["__scopeDropdownMenu"]),i=Ae(r);return e.jsx(wn,S(x(x({},i),l),{ref:t}))});$n.displayName=Mn;var _n="DropdownMenuLabel",Ln=c.forwardRef((s,t)=>{const a=s,{__scopeDropdownMenu:r}=a,l=X(a,["__scopeDropdownMenu"]),i=Ae(r);return e.jsx(yn,S(x(x({},i),l),{ref:t}))});Ln.displayName=_n;var On="DropdownMenuItem",ka=c.forwardRef((s,t)=>{const a=s,{__scopeDropdownMenu:r}=a,l=X(a,["__scopeDropdownMenu"]),i=Ae(r);return e.jsx(Cn,S(x(x({},i),l),{ref:t}))});ka.displayName=On;var Un="DropdownMenuCheckboxItem",Vn=c.forwardRef((s,t)=>{const a=s,{__scopeDropdownMenu:r}=a,l=X(a,["__scopeDropdownMenu"]),i=Ae(r);return e.jsx(Fn,S(x(x({},i),l),{ref:t}))});Vn.displayName=Un;var zn="DropdownMenuRadioGroup",qn=c.forwardRef((s,t)=>{const a=s,{__scopeDropdownMenu:r}=a,l=X(a,["__scopeDropdownMenu"]),i=Ae(r);return e.jsx(Sn,S(x(x({},i),l),{ref:t}))});qn.displayName=zn;var Gn="DropdownMenuRadioItem",Yn=c.forwardRef((s,t)=>{const a=s,{__scopeDropdownMenu:r}=a,l=X(a,["__scopeDropdownMenu"]),i=Ae(r);return e.jsx(En,S(x(x({},i),l),{ref:t}))});Yn.displayName=Gn;var Kn="DropdownMenuItemIndicator",Hn=c.forwardRef((s,t)=>{const a=s,{__scopeDropdownMenu:r}=a,l=X(a,["__scopeDropdownMenu"]),i=Ae(r);return e.jsx(An,S(x(x({},i),l),{ref:t}))});Hn.displayName=Kn;var Jn="DropdownMenuSeparator",Wn=c.forwardRef((s,t)=>{const a=s,{__scopeDropdownMenu:r}=a,l=X(a,["__scopeDropdownMenu"]),i=Ae(r);return e.jsx(Dn,S(x(x({},i),l),{ref:t}))});Wn.displayName=Jn;var Xn="DropdownMenuArrow",Qn=c.forwardRef((s,t)=>{const a=s,{__scopeDropdownMenu:r}=a,l=X(a,["__scopeDropdownMenu"]),i=Ae(r);return e.jsx(Bn,S(x(x({},i),l),{ref:t}))});Qn.displayName=Xn;var Zn="DropdownMenuSubTrigger",ec=c.forwardRef((s,t)=>{const a=s,{__scopeDropdownMenu:r}=a,l=X(a,["__scopeDropdownMenu"]),i=Ae(r);return e.jsx(Pn,S(x(x({},i),l),{ref:t}))});ec.displayName=Zn;var sc="DropdownMenuSubContent",tc=c.forwardRef((s,t)=>{const a=s,{__scopeDropdownMenu:r}=a,l=X(a,["__scopeDropdownMenu"]),i=Ae(r);return e.jsx(In,S(x(x({},i),l),{ref:t,style:S(x({},s.style),{"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"})}))});tc.displayName=sc;var ac=Aa,rc=Ba,lc=Pa,nc=Ta,cc=ka;function Ra(t){var s=X(t,[]);return e.jsx(ac,x({"data-slot":"dropdown-menu"},s))}function Ma(t){var s=X(t,[]);return e.jsx(rc,x({"data-slot":"dropdown-menu-trigger"},s))}function $a(l){var i=l,{className:s,sideOffset:t=4}=i,r=X(i,["className","sideOffset"]);return e.jsx(lc,{children:e.jsx(nc,x({"data-slot":"dropdown-menu-content",sideOffset:t,className:Ie("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",s)},r))})}function ss(i){var a=i,{className:s,inset:t,variant:r="default"}=a,l=X(a,["className","inset","variant"]);return e.jsx(cc,x({"data-slot":"dropdown-menu-item","data-inset":t,"data-variant":r,className:Ie("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s)},l))}function ic({onNavigateToCreate:s}){var R,n;const{teachers:t,classes:r,addClass:l,updateClass:i,deleteClass:a}=ve(),[N,o]=c.useState(""),[g,h]=c.useState("All"),[I,j]=c.useState("All"),[w,b]=c.useState(!1),[y,A]=c.useState(!1),[D,v]=c.useState(!1),[H,C]=c.useState(!1),[O,f]=c.useState(null),[F,u]=c.useState(""),[T,L]=c.useState(null),ee=t.filter(m=>m.status==="Active"),[K,re]=c.useState({name:"",section:"",capacity:"",classTeacherId:"",status:"active",schoolLevel:""}),ge=r.filter(m=>{var Y;const P=m.name.toLowerCase().includes(N.toLowerCase())||((Y=m.classTeacher)!=null?Y:"").toLowerCase().includes(N.toLowerCase()),J=g==="All"||m.level===g,te=I==="All"||m.status===I;return P&&J&&te}),he={totalClasses:r.length,activeClasses:r.filter(m=>m.status==="Active").length,totalStudents:r.reduce((m,P)=>{var J;return m+((J=P.currentStudents)!=null?J:0)},0),averageCapacity:r.length>0?Math.round(r.reduce((m,P)=>{var J;return m+((J=P.currentStudents)!=null?J:0)/P.capacity*100},0)/r.length):0},se=()=>{if(!K.name||!K.capacity||!K.classTeacherId||!K.schoolLevel){E.error("Please fill all required fields");return}const m=ee.find(J=>J.id===parseInt(K.classTeacherId)),P={name:K.name,level:K.schoolLevel,capacity:parseInt(K.capacity),currentStudents:0,classTeacher:m?`${m.firstName} ${m.lastName}`:"",classTeacherId:parseInt(K.classTeacherId),section:K.section,status:K.status,academicYear:"2024/2025"};l(P),E.success(`Class "${P.name}" created successfully!`),b(!1),Q()},Z=()=>{if(!T||!K.name||!K.capacity||!K.classTeacherId||!K.schoolLevel){E.error("Please fill all required fields");return}const m=ee.find(J=>J.id===parseInt(K.classTeacherId)),P={name:K.name,level:K.schoolLevel,capacity:parseInt(K.capacity),classTeacher:m?`${m.firstName} ${m.lastName}`:"",classTeacherId:parseInt(K.classTeacherId),section:K.section,status:K.status};i(T.id,P),E.success(`Class "${K.name}" updated successfully!`),A(!1),f(null),Q()},U=()=>{var m;if(O){if(((m=O.currentStudents)!=null?m:0)>0){E.error("Cannot delete class with enrolled students. Please move students first."),v(!1);return}a(O.id),E.success(`Class "${O.name}" deleted successfully!`),v(!1),f(null)}},d=m=>{var P,J;f(m),L(m),re({name:m.name,section:(P=m.section)!=null?P:"",capacity:m.capacity.toString(),classTeacherId:((J=m.classTeacherId)==null?void 0:J.toString())||"",status:m.status,schoolLevel:m.level||""}),A(!0)},B=m=>{f(m),v(!0)},k=m=>{var P;f(m),u(((P=m.classTeacherId)==null?void 0:P.toString())||""),C(!0)},p=()=>{if(!O||!F){E.error("Please select a teacher");return}const m=ee.find(J=>J.id.toString()===F);if(!m){E.error("Selected teacher not found");return}const P={classTeacher:`${m.firstName} ${m.lastName}`,classTeacherId:m.id};i(O.id,P),E.success(`${m.firstName} ${m.lastName} assigned to ${O.name}!`),C(!1),f(null),u("")},Q=()=>{re({name:"",section:"",capacity:"",classTeacherId:"",status:"active",schoolLevel:""})},W=({isOpen:m,onClose:P,onSubmit:J,title:te})=>e.jsx(Ce,{open:m,onOpenChange:P,children:e.jsxs(Fe,{className:"max-w-2xl rounded-xl bg-white border border-[#E5E7EB] text-[#1F2937] max-h-[90vh] overflow-y-auto",children:[e.jsx(Se,{children:e.jsx(Ee,{className:"text-[#1F2937]",children:te})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#1F2937]",children:"School Level *"}),e.jsxs(ce,{value:K.schoolLevel,onValueChange:Y=>re(ne=>S(x({},ne),{schoolLevel:Y})),children:[e.jsx(ie,{className:"h-12 rounded-lg border border-[#E5E7EB] bg-[#F9FAFB] text-[#1F2937]",children:e.jsx(de,{placeholder:"Select school level"})}),e.jsxs(oe,{className:"bg-white border-[#E5E7EB]",children:[e.jsx(_,{value:"Primary",className:"text-[#1F2937]",children:"Primary"}),e.jsx(_,{value:"Secondary",className:"text-[#1F2937]",children:"Secondary"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#1F2937]",children:"Class Name *"}),e.jsx(ae,{placeholder:"e.g., JSS 1A, SS 2B, Primary 3",value:K.name,onChange:Y=>{Y.stopPropagation(),re(ne=>S(x({},ne),{name:Y.target.value}))},onFocus:Y=>Y.stopPropagation(),className:"h-12 rounded-lg border border-[#E5E7EB] bg-[#F9FAFB] text-[#1F2937]"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#1F2937]",children:"Section (Optional)"}),e.jsx(ae,{placeholder:"e.g., A, B, C",value:K.section,onChange:Y=>{Y.stopPropagation(),re(ne=>S(x({},ne),{section:Y.target.value}))},onFocus:Y=>Y.stopPropagation(),className:"h-12 rounded-lg border border-[#E5E7EB] bg-[#F9FAFB] text-[#1F2937]"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#1F2937]",children:"Class Capacity *"}),e.jsx(ae,{type:"number",placeholder:"e.g., 35",value:K.capacity,onChange:Y=>{Y.stopPropagation(),re(ne=>S(x({},ne),{capacity:Y.target.value}))},onFocus:Y=>Y.stopPropagation(),className:"h-12 rounded-lg border border-[#E5E7EB] bg-[#F9FAFB] text-[#1F2937]"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#1F2937]",children:"Assign Class Teacher *"}),e.jsxs(ce,{value:K.classTeacherId,onValueChange:Y=>re(ne=>S(x({},ne),{classTeacherId:Y})),children:[e.jsx(ie,{className:"h-12 rounded-lg border border-[#E5E7EB] bg-[#F9FAFB] text-[#1F2937]",children:e.jsx(de,{placeholder:"Select class teacher"})}),e.jsx(oe,{className:"bg-white border-[#E5E7EB]",children:ee.length===0?e.jsx("div",{className:"p-3 text-center text-[#6B7280] text-sm",children:"No teachers available. Please add teachers first."}):ee.map(Y=>e.jsxs(_,{value:Y.id.toString(),className:"text-[#1F2937]",children:[Y.firstName," ",Y.lastName]},Y.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#1F2937]",children:"Status"}),e.jsxs(ce,{value:K.status,onValueChange:Y=>re(ne=>S(x({},ne),{status:Y})),children:[e.jsx(ie,{className:"h-12 rounded-lg border border-[#E5E7EB] bg-[#F9FAFB] text-[#1F2937]",children:e.jsx(de,{})}),e.jsxs(oe,{className:"bg-white border-[#E5E7EB]",children:[e.jsx(_,{value:"active",className:"text-[#1F2937]",children:"Active"}),e.jsx(_,{value:"inactive",className:"text-[#1F2937]",children:"Inactive"})]})]})]})]}),e.jsx("div",{className:"p-4 bg-[#EFF6FF] border border-[#3B82F6]/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ye,{className:"w-5 h-5 text-[#3B82F6] flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[#1F2937] text-sm font-medium mb-1",children:"Class Configuration Tips"}),e.jsxs("p",{className:"text-[#6B7280] text-xs",children:["• Select school level (Primary or Secondary)",e.jsx("br",{}),"• Class names should be unique",e.jsx("br",{}),"• Each class can have only one class teacher",e.jsx("br",{}),"• Capacity should match classroom physical capacity"]})]})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-[#E5E7EB]",children:[e.jsx(G,{onClick:()=>{P(),Q()},variant:"outline",className:"rounded-lg border-[#E5E7EB] text-[#6B7280] hover:bg-[#F9FAFB] hover:text-[#1F2937]",children:"Cancel"}),e.jsxs(G,{onClick:J,className:"bg-[#3B82F6] hover:bg-[#2563EB] text-white rounded-lg shadow-clinical hover:shadow-clinical-lg transition-all",children:[e.jsx(Ye,{className:"w-4 h-4 mr-2"}),te.includes("Create")?"Create Class":"Save Changes"]})]})]})});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-[#1F2937] mb-2",children:"Manage Classes"}),e.jsx("p",{className:"text-[#6B7280]",children:"Create and manage school classes"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical hover:shadow-clinical-lg transition-all hover-lift group",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Total Classes"}),e.jsx(we,{className:"w-5 h-5 text-[#3B82F6] group-hover:scale-110 transition-transform"})]}),e.jsx("p",{className:"text-[#1F2937] mb-1 font-semibold",children:he.totalClasses}),e.jsx("p",{className:"text-xs text-[#6B7280]",children:"Across all levels"})]})}),e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical hover:shadow-clinical-lg transition-all hover-lift group",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Active Classes"}),e.jsx(Ye,{className:"w-5 h-5 text-[#10B981] group-hover:scale-110 transition-transform"})]}),e.jsx("p",{className:"text-[#1F2937] mb-1 font-semibold",children:he.activeClasses}),e.jsx("p",{className:"text-xs text-[#10B981]",children:"Currently in session"})]})}),e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical hover:shadow-clinical-lg transition-all hover-lift group",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Total Students"}),e.jsx(pe,{className:"w-5 h-5 text-[#3B82F6] group-hover:scale-110 transition-transform"})]}),e.jsx("p",{className:"text-[#1F2937] mb-1 font-semibold",children:he.totalStudents}),e.jsx("p",{className:"text-xs text-[#6B7280]",children:"Enrolled students"})]})}),e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical hover:shadow-clinical-lg transition-all hover-lift group",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Avg. Capacity"}),e.jsx(Me,{className:"w-5 h-5 text-[#F59E0B] group-hover:scale-110 transition-transform"})]}),e.jsxs("p",{className:"text-[#1F2937] mb-1 font-semibold",children:[he.averageCapacity,"%"]}),e.jsx("p",{className:"text-xs text-[#F59E0B]",children:"Utilization rate"})]})})]}),e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx($,{className:"text-[#1F2937]",children:"Search Classes"}),e.jsxs("div",{className:"relative",children:[e.jsx(Re,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-[#6B7280]"}),e.jsx(ae,{placeholder:"Search by class name or teacher...",value:N,onChange:m=>{m.stopPropagation(),o(m.target.value)},onFocus:m=>m.stopPropagation(),className:"h-12 pl-11 rounded-lg border border-[#E5E7EB] bg-[#F9FAFB] text-[#1F2937]"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#1F2937]",children:"Filter by Level"}),e.jsxs(ce,{value:g,onValueChange:m=>h(m),children:[e.jsx(ie,{className:"h-12 rounded-lg border border-[#E5E7EB] bg-[#F9FAFB] text-[#1F2937]",children:e.jsx(de,{})}),e.jsxs(oe,{className:"bg-white border-[#E5E7EB]",children:[e.jsx(_,{value:"All",className:"text-[#1F2937]",children:"All Levels"}),e.jsx(_,{value:"Primary",className:"text-[#1F2937]",children:"Primary"}),e.jsx(_,{value:"Secondary",className:"text-[#1F2937]",children:"Secondary"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#1F2937]",children:"Filter by Status"}),e.jsxs(ce,{value:I,onValueChange:m=>j(m),children:[e.jsx(ie,{className:"h-12 rounded-lg border border-[#E5E7EB] bg-[#F9FAFB] text-[#1F2937]",children:e.jsx(de,{})}),e.jsxs(oe,{className:"bg-white border-[#E5E7EB]",children:[e.jsx(_,{value:"All",className:"text-[#1F2937]",children:"All Status"}),e.jsx(_,{value:"active",className:"text-[#1F2937]",children:"Active"}),e.jsx(_,{value:"inactive",className:"text-[#1F2937]",children:"Inactive"})]})]})]})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsxs(G,{onClick:()=>s?s():b(!0),className:"bg-[#10B981] hover:bg-[#059669] text-white rounded-lg shadow-clinical hover:shadow-clinical-lg transition-all",children:[e.jsx(Ze,{className:"w-4 h-4 mr-2"}),"Create New Class"]})})]})}),e.jsxs(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:[e.jsx(me,{className:"p-5 border-b border-[#E5E7EB]",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-[#1F2937]",children:["All Classes (",ge.length,")"]}),e.jsx(le,{className:"bg-[#3B82F6] text-white border-0",children:g!=="All"?g:"All Levels"})]})}),e.jsx(z,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(De,{children:[e.jsx(Be,{children:e.jsxs(xe,{className:"bg-[#2563EB] border-none hover:bg-[#2563EB]",children:[e.jsx(q,{className:"text-white",children:"Class Name"}),e.jsx(q,{className:"text-white",children:"Level"}),e.jsx(q,{className:"text-white",children:"Class Teacher"}),e.jsx(q,{className:"text-white text-center",children:"Students"}),e.jsx(q,{className:"text-white text-center",children:"Capacity"}),e.jsx(q,{className:"text-white text-center",children:"Utilization"}),e.jsx(q,{className:"text-white text-center",children:"Status"}),e.jsx(q,{className:"text-white text-center",children:"Actions"})]})}),e.jsx(Pe,{children:ge.length===0?e.jsx(xe,{className:"bg-white border-b border-[#E5E7EB]",children:e.jsx(M,{colSpan:8,className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(we,{className:"w-12 h-12 text-[#9CA3AF]"}),e.jsx("p",{className:"text-[#1F2937]",children:"No classes found"}),e.jsx("p",{className:"text-[#6B7280] text-sm",children:r.length===0?"Click 'Create New Class' to add your first class":"Try adjusting your search or filters"})]})})}):ge.map(m=>{var J,te;const P=Math.round(((J=m.currentStudents)!=null?J:0)/m.capacity*100);return e.jsxs(xe,{className:"bg-white border-b border-[#E5E7EB] hover:bg-[#F9FAFB]",children:[e.jsx(M,{className:"text-[#1F2937]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg ${m.level==="Primary"?"bg-gradient-to-br from-[#10B981] to-[#059669]":"bg-gradient-to-br from-[#3B82F6] to-[#2563EB]"} flex items-center justify-center`,children:e.jsx(we,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[#1F2937] font-medium",children:m.name}),e.jsx(le,{className:`text-xs mt-1 ${m.level==="Primary"?"bg-[#10B981] text-white":"bg-[#3B82F6] text-white"} border-0`,children:m.level})]})]})}),e.jsx(M,{className:"text-[#1F2937]",children:m.level}),e.jsx(M,{className:"text-[#1F2937]",children:m.classTeacher}),e.jsx(M,{className:"text-center text-[#1F2937]",children:(te=m.currentStudents)!=null?te:0}),e.jsx(M,{className:"text-center text-[#1F2937]",children:m.capacity}),e.jsx(M,{className:"text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-20 bg-[#E5E7EB] rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${P>=90?"bg-[#EF4444]":P>=75?"bg-[#F59E0B]":"bg-[#10B981]"}`,style:{width:`${Math.min(P,100)}%`}})}),e.jsxs("span",{className:"text-[#1F2937] text-sm",children:[P,"%"]})]})}),e.jsx(M,{className:"text-center",children:e.jsx(le,{className:`${m.status==="Active"?"bg-[#10B981] text-white":"bg-[#6B7280] text-white"} border-0`,children:m.status})}),e.jsx(M,{className:"text-center",children:e.jsxs(Ra,{children:[e.jsx(Ma,{asChild:!0,children:e.jsx(G,{variant:"ghost",className:"h-8 w-8 p-0",children:e.jsx(Lt,{className:"w-4 h-4 text-[#6B7280]"})})}),e.jsxs($a,{align:"end",className:"bg-white border-[#E5E7EB]",children:[e.jsxs(ss,{onClick:()=>d(m),className:"text-[#1F2937] cursor-pointer",children:[e.jsx(ls,{className:"w-4 h-4 mr-2"}),"Edit"]}),e.jsxs(ss,{onClick:()=>k(m),className:"text-[#3B82F6] cursor-pointer",children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),"Assign Teacher"]}),e.jsxs(ss,{onClick:()=>B(m),className:"text-[#EF4444] cursor-pointer",children:[e.jsx(He,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})})]},m.id)})})]})})})]}),e.jsx(W,{isOpen:w,onClose:()=>{b(!1),Q()},onSubmit:se,title:"Create New Class"}),e.jsx(W,{isOpen:y,onClose:()=>{A(!1),f(null),Q()},onSubmit:Z,title:"Edit Class"}),e.jsx(xs,{open:D,onOpenChange:v,children:e.jsxs(ms,{className:"bg-white border border-[#E5E7EB]",children:[e.jsxs(us,{children:[e.jsx(js,{className:"text-[#1F2937]",children:"Delete Class"}),e.jsxs(ps,{className:"text-[#6B7280]",children:['Are you sure you want to delete "',O==null?void 0:O.name,'"? This action cannot be undone.',O&&((R=O.currentStudents)!=null?R:0)>0&&e.jsxs("span",{className:"block mt-2 text-[#EF4444] font-medium",children:["This class has ",(n=O.currentStudents)!=null?n:0," enrolled students and cannot be deleted."]})]})]}),e.jsxs(gs,{children:[e.jsx(bs,{className:"rounded-lg border-[#E5E7EB] text-[#6B7280]",children:"Cancel"}),e.jsx(Ns,{onClick:U,className:"bg-[#EF4444] hover:bg-[#DC2626] text-white rounded-lg",children:"Delete"})]})]})}),e.jsx(Ce,{open:H,onOpenChange:C,children:e.jsxs(Fe,{className:"max-w-md rounded-xl bg-white border border-[#E5E7EB]",children:[e.jsx(Se,{children:e.jsx(Ee,{className:"text-[#1F2937]",children:"Assign Class Teacher"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("p",{className:"text-sm text-blue-900",children:[e.jsx("strong",{children:"Class:"})," ",O==null?void 0:O.name]}),e.jsxs("p",{className:"text-sm text-blue-800 mt-1",children:[e.jsx("strong",{children:"Current Teacher:"})," ",(O==null?void 0:O.classTeacher)||"Unassigned"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#1F2937] font-medium",children:"Select Teacher *"}),e.jsxs(ce,{value:F,onValueChange:u,children:[e.jsx(ie,{className:"h-12 rounded-lg border-[#E5E7EB]",children:e.jsx(de,{placeholder:"Select a teacher"})}),e.jsx(oe,{className:"bg-white border-[#E5E7EB]",children:ee.length===0?e.jsx("div",{className:"p-3 text-center text-[#6B7280] text-sm",children:"No teachers available. Please add teachers first."}):ee.map(m=>e.jsxs(_,{value:m.id.toString(),className:"text-[#1F2937]",children:[m.firstName," ",m.lastName]},m.id))})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(G,{variant:"outline",onClick:()=>{C(!1),f(null),u("")},className:"rounded-lg",children:"Cancel"}),e.jsxs(G,{onClick:p,className:"bg-[#3B82F6] hover:bg-[#2563EB] text-white rounded-lg",children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),"Assign Teacher"]})]})]})})]})}const dc=c.memo(ic);function oc(){const[s,t]=c.useState(""),[r,l]=c.useState("All"),[i,a]=c.useState("All"),[N,o]=c.useState(!1),[g,h]=c.useState(!1),[I,j]=c.useState(!1),[w,b]=c.useState(!1),[y,A]=c.useState(null),[D,v]=c.useState([]);c.useEffect(()=>{H()},[]);const H=()=>ue(this,null,function*(){try{const p=yield ys.getAll(),W=(Array.isArray(p)?p:p!=null&&p.data&&Array.isArray(p.data)?p.data:[]).map(R=>{const m=(R.status||"").toString()==="Active"?"Active":"Inactive";return{id:Number(R.id),name:R.name||"",code:R.code||"N/A",department:R.department||"General",creditUnits:R.credit_units||1,description:R.description||"",assignedClasses:[],assignedTeachers:[],status:m,isCore:!!R.is_core}});v(W)}catch(p){console.error("Error loading subjects:",p),E.error("Failed to load subjects")}}),C=[{id:1,name:"Mr. John Doe",subjects:["Mathematics","Further Mathematics"]},{id:2,name:"Mrs. Sarah Ahmad",subjects:["English Language","Literature"]},{id:3,name:"Mr. Ibrahim Hassan",subjects:["Physics"]},{id:4,name:"Ms. Aisha Mohammed",subjects:["Chemistry"]},{id:5,name:"Mr. Usman Garba",subjects:["Biology"]},{id:6,name:"Mrs. Fatima Bello",subjects:["Economics"]},{id:7,name:"Mr. Musa Aliyu",subjects:["Government"]},{id:8,name:"Mr. David Okon",subjects:["Computer Science"]},{id:9,name:"Mrs. Comfort James",subjects:["Home Economics"]}],O=[{id:1,name:"JSS 1A",level:"JSS 1"},{id:2,name:"JSS 1B",level:"JSS 1"},{id:3,name:"JSS 2A",level:"JSS 2"},{id:4,name:"JSS 2B",level:"JSS 2"},{id:5,name:"JSS 3A",level:"JSS 3"},{id:6,name:"SS 1A",level:"SS 1"},{id:7,name:"SS 2A",level:"SS 2"},{id:8,name:"SS 3A",level:"SS 3"}],[f,F]=c.useState({name:"",code:"",department:"",status:"Active",isCore:!1}),[u,T]=c.useState({selectedClasses:[],selectedTeachers:[]}),L=D.filter(p=>{const Q=p.name.toLowerCase().includes(s.toLowerCase())||p.code.toLowerCase().includes(s.toLowerCase()),W=r==="All"||p.department===r,R=i==="All"||p.status===i;return Q&&W&&R}),ee=["All",...Array.from(new Set(D.map(p=>p.department)))],K={totalSubjects:D.length,activeSubjects:D.filter(p=>p.status==="Active").length,coreSubjects:D.filter(p=>p.isCore).length,assignedSubjects:D.filter(p=>p.assignedClasses.length>0).length},re=()=>ue(this,null,function*(){if(!f.name||!f.code||!f.department){E.error("Please fill all required fields");return}try{const p={name:f.name,code:f.code,department:f.department,status:f.status==="Active"?"active":"inactive",is_core:f.isCore};yield ys.create(p),E.success(`Subject "${f.name}" created successfully!`),o(!1),B(),H()}catch(p){console.error("Error creating subject:",p);const Q=(p==null?void 0:p.data)&&p.data.message||(p==null?void 0:p.message)||"Failed to create subject";E.error(Q)}}),ge=()=>ue(this,null,function*(){if(!y||!f.name||!f.code||!f.department){E.error("Please fill all required fields");return}try{const p={name:f.name,code:f.code,department:f.department,status:f.status==="Active"?"active":"inactive",is_core:f.isCore};yield ys.update(y.id,p),E.success(`Subject "${f.name}" updated successfully!`),h(!1),A(null),B(),H()}catch(p){console.error("Error updating subject:",p);const Q=(p==null?void 0:p.data)&&p.data.message||(p==null?void 0:p.message)||"Failed to update subject";E.error(Q)}}),he=()=>{if(!y)return;if(u.selectedClasses.length===0){E.error("Please select at least one class");return}if(u.selectedTeachers.length===0){E.error("Please select at least one teacher");return}const p=u.selectedTeachers.map(W=>{const R=C.find(n=>n.id===W);return{name:(R==null?void 0:R.name)||"",classes:u.selectedClasses}}),Q=D.map(W=>W.id===y.id?S(x({},W),{assignedClasses:[...new Set([...W.assignedClasses,...u.selectedClasses])],assignedTeachers:[...W.assignedTeachers,...p]}):W);v(Q),E.success(`${u.selectedClasses.length} classes and ${u.selectedTeachers.length} teachers assigned to "${y.name}"!`),j(!1),A(null),T({selectedClasses:[],selectedTeachers:[]})},se=()=>ue(this,null,function*(){if(y)try{yield ys.delete(y.id),E.success(`Subject "${y.name}" deleted successfully!`),b(!1),A(null),H()}catch(p){console.error("Error deleting subject:",p);const Q=(p==null?void 0:p.data)&&p.data.message||(p==null?void 0:p.message)||"Failed to delete subject";E.error(Q),b(!1)}}),Z=p=>{A(p),F({name:p.name,code:p.code,department:p.department,status:p.status,isCore:p.isCore}),h(!0)},U=p=>{A(p),T({selectedClasses:[],selectedTeachers:[]}),j(!0)},d=p=>{A(p),b(!0)},B=()=>{F({name:"",code:"",department:"",status:"Active",isCore:!1})},k=({isOpen:p,onClose:Q,onSubmit:W,title:R})=>e.jsx(Ce,{open:p,onOpenChange:Q,children:e.jsxs(Fe,{className:"max-w-2xl rounded-2xl bg-[#132C4A] border border-white/10 text-white",children:[e.jsx(Se,{children:e.jsx(Ee,{className:"text-white",children:R})}),e.jsx("form",{onSubmit:n=>{n.preventDefault(),W()},children:e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"Subject Name *"}),e.jsx(ae,{placeholder:"e.g., Mathematics, English",value:f.name,onChange:n=>{n.stopPropagation(),F(m=>S(x({},m),{name:n.target.value}))},onFocus:n=>n.stopPropagation(),className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"Subject Code *"}),e.jsx(ae,{placeholder:"e.g., MTH101",value:f.code,onChange:n=>{n.stopPropagation(),F(m=>S(x({},m),{code:n.target.value.toUpperCase()}))},onFocus:n=>n.stopPropagation(),className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"Department *"}),e.jsxs(ce,{value:f.department,onValueChange:n=>F(S(x({},f),{department:n})),children:[e.jsx(ie,{className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white",children:e.jsx(de,{placeholder:"Select department"})}),e.jsxs(oe,{className:"bg-[#0F243E] border-white/10",children:[e.jsx(_,{value:"Sciences",className:"text-white hover:bg-[#1E90FF]",children:"Sciences"}),e.jsx(_,{value:"Arts",className:"text-white hover:bg-[#1E90FF]",children:"Arts"}),e.jsx(_,{value:"Commercial",className:"text-white hover:bg-[#1E90FF]",children:"Commercial"}),e.jsx(_,{value:"Technology",className:"text-white hover:bg-[#1E90FF]",children:"Technology"}),e.jsx(_,{value:"General",className:"text-white hover:bg-[#1E90FF]",children:"General"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"Status *"}),e.jsxs(ce,{value:f.status,onValueChange:n=>F(S(x({},f),{status:n})),children:[e.jsx(ie,{className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white",children:e.jsx(de,{placeholder:"Select status"})}),e.jsxs(oe,{className:"bg-[#0F243E] border-white/10",children:[e.jsx(_,{value:"Active",className:"text-white hover:bg-[#1E90FF]",children:"Active"}),e.jsx(_,{value:"Inactive",className:"text-white hover:bg-[#1E90FF]",children:"Inactive"})]})]})]})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs($,{className:"text-white flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:f.isCore,onChange:n=>F(S(x({},f),{isCore:n.target.checked})),className:"rounded border-white/10 bg-[#0F243E] text-blue-500"}),"Core Subject"]})}),e.jsxs(Hs,{children:[e.jsx(G,{type:"button",variant:"secondary",onClick:()=>{o(!1),B()},className:"bg-gray-600 hover:bg-gray-700 text-white",children:"Cancel"}),e.jsx(G,{type:"submit",className:"bg-[#1E90FF] hover:bg-[#00BFFF] text-white",children:"Create Subject"})]})]})})]})});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-white mb-2",children:"Manage Subjects"}),e.jsx("p",{className:"text-[#C0C8D3]",children:"Create, edit subjects and assign to classes and teachers"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg hover:shadow-2xl transition-all hover:scale-105 group",children:e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#C0C8D3]",children:"Total Subjects"}),e.jsx(we,{className:"w-6 h-6 text-[#1E90FF] group-hover:scale-110 transition-transform"})]}),e.jsx("p",{className:"text-white mb-2",children:K.totalSubjects}),e.jsx("p",{className:"text-xs text-[#00BFFF]",children:"All subjects"})]})}),e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg hover:shadow-2xl transition-all hover:scale-105 group",children:e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#C0C8D3]",children:"Active Subjects"}),e.jsx(Ye,{className:"w-6 h-6 text-[#28A745] group-hover:scale-110 transition-transform"})]}),e.jsx("p",{className:"text-white mb-2",children:K.activeSubjects}),e.jsx("p",{className:"text-xs text-[#28A745]",children:"Currently offered"})]})}),e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg hover:shadow-2xl transition-all hover:scale-105 group",children:e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#C0C8D3]",children:"Core Subjects"}),e.jsx(ye,{className:"w-6 h-6 text-[#FFD700] group-hover:scale-110 transition-transform"})]}),e.jsx("p",{className:"text-white mb-2",children:K.coreSubjects}),e.jsx("p",{className:"text-xs text-[#FFD700]",children:"Mandatory"})]})}),e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg hover:shadow-2xl transition-all hover:scale-105 group",children:e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#C0C8D3]",children:"Assigned"}),e.jsx(pe,{className:"w-6 h-6 text-[#00BFFF] group-hover:scale-110 transition-transform"})]}),e.jsx("p",{className:"text-white mb-2",children:K.assignedSubjects}),e.jsx("p",{className:"text-xs text-[#C0C8D3]",children:"With classes"})]})})]}),e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx($,{className:"text-white",children:"Search Subjects"}),e.jsxs("div",{className:"relative",children:[e.jsx(Re,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-[#C0C8D3]"}),e.jsx(ae,{placeholder:"Search by name or code...",value:s,onChange:p=>{p.stopPropagation(),t(p.target.value)},onFocus:p=>p.stopPropagation(),className:"h-12 pl-11 rounded-xl border border-white/10 bg-[#0F243E] text-white"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"Filter by Department"}),e.jsxs(ce,{value:r,onValueChange:l,children:[e.jsx(ie,{className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white",children:e.jsx(de,{})}),e.jsx(oe,{className:"bg-[#0F243E] border-white/10",children:ee.map(p=>e.jsx(_,{value:p,className:"text-white hover:bg-[#1E90FF]",children:p},p))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"Filter by Status"}),e.jsxs(ce,{value:i,onValueChange:a,children:[e.jsx(ie,{className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white",children:e.jsx(de,{})}),e.jsxs(oe,{className:"bg-[#0F243E] border-white/10",children:[e.jsx(_,{value:"All",className:"text-white hover:bg-[#1E90FF]",children:"All Status"}),e.jsx(_,{value:"Active",className:"text-white hover:bg-[#1E90FF]",children:"Active"}),e.jsx(_,{value:"Inactive",className:"text-white hover:bg-[#1E90FF]",children:"Inactive"})]})]})]})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsxs(G,{onClick:()=>{B(),o(!0)},className:"bg-[#28A745] hover:bg-[#28A745]/90 text-white rounded-xl shadow-md hover:scale-105 transition-all",children:[e.jsx(Ze,{className:"w-4 h-4 mr-2"}),"Create New Subject"]})})]})}),e.jsxs(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:[e.jsx(me,{className:"p-5 border-b border-white/10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-white",children:["All Subjects (",L.length,")"]}),e.jsx(le,{className:"bg-[#1E90FF] text-white border-0",children:r!=="All"?r:"All Departments"})]})}),e.jsx(z,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(De,{children:[e.jsx(Be,{children:e.jsxs(xe,{className:"bg-gradient-to-r from-[#1E90FF] to-[#00BFFF] border-none hover:bg-gradient-to-r",children:[e.jsx(q,{className:"text-white",children:"Subject"}),e.jsx(q,{className:"text-white",children:"Code"}),e.jsx(q,{className:"text-white",children:"Credits"}),e.jsx(q,{className:"text-white",children:"Department"}),e.jsx(q,{className:"text-white text-center",children:"Type"}),e.jsx(q,{className:"text-white text-center",children:"Classes"}),e.jsx(q,{className:"text-white text-center",children:"Teachers"}),e.jsx(q,{className:"text-white text-center",children:"Status"}),e.jsx(q,{className:"text-white text-center",children:"Actions"})]})}),e.jsx(Pe,{children:L.length===0?e.jsx(xe,{className:"bg-[#0F243E] border-b border-white/5",children:e.jsx(M,{colSpan:9,className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(we,{className:"w-12 h-12 text-[#C0C8D3]"}),e.jsx("p",{className:"text-white",children:"No subjects found"}),e.jsx("p",{className:"text-[#C0C8D3] text-sm",children:"Try adjusting your search or filters"})]})})}):L.map(p=>e.jsxs(xe,{className:"bg-[#0F243E] border-b border-white/5 hover:bg-[#132C4A]",children:[e.jsx(M,{className:"text-white",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg ${p.department==="Sciences"?"bg-gradient-to-br from-[#10B981] to-[#059669]":p.department==="Arts"?"bg-gradient-to-br from-[#F59E0B] to-[#D97706]":p.department==="Commercial"?"bg-gradient-to-br from-[#3B82F6] to-[#2563EB]":p.department==="Technology"?"bg-gradient-to-br from-[#8B5CF6] to-[#7C3AED]":"bg-gradient-to-br from-[#6B7280] to-[#4B5563]"} flex items-center justify-center`,children:e.jsx(we,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"font-medium",children:p.name}),p.isCore&&e.jsx(le,{className:"bg-[#FFD700] text-[#0A192F] border-0 text-xs mt-1",children:"Core"})]})}),e.jsx(M,{className:"text-white",children:p.code}),e.jsx(M,{className:"text-center",children:e.jsxs(le,{className:`${p.department==="Sciences"?"bg-[#10B981] text-white":p.department==="Arts"?"bg-[#F59E0B] text-white":p.department==="Commercial"?"bg-[#3B82F6] text-white":p.department==="Technology"?"bg-[#8B5CF6] text-white":"bg-[#6B7280] text-white"} border-0`,children:[p.creditUnits," Credits"]})}),e.jsx(M,{className:"text-white",children:p.department}),e.jsx(M,{className:"text-center",children:e.jsx(le,{className:`${p.isCore?"bg-[#FFD700] text-[#0A192F]":"bg-[#00BFFF] text-white"} border-0`,children:p.isCore?"Core":"Elective"})}),e.jsx(M,{className:"text-center",children:e.jsx(le,{className:"bg-[#0F243E] text-white border border-white/10",children:p.assignedClasses.length})}),e.jsx(M,{className:"text-center",children:e.jsx(le,{className:"bg-[#0F243E] text-white border border-white/10",children:p.assignedTeachers.length})}),e.jsx(M,{className:"text-center",children:e.jsx(le,{className:`${p.status==="Active"?"bg-[#28A745] text-white":"bg-[#DC3545] text-white"} border-0`,children:p.status})}),e.jsx(M,{className:"text-center",children:e.jsxs(Ra,{children:[e.jsx(Ma,{asChild:!0,children:e.jsx(G,{variant:"ghost",className:"h-8 w-8 p-0 text-white hover:bg-[#1E90FF]",children:e.jsx(Lt,{className:"w-4 h-4"})})}),e.jsxs($a,{align:"end",className:"bg-[#0F243E] border-white/10",children:[e.jsxs(ss,{onClick:()=>U(p),className:"text-white hover:bg-[#28A745] hover:text-white cursor-pointer",children:[e.jsx(_e,{className:"w-4 h-4 mr-2"}),"Assign to Classes"]}),e.jsxs(ss,{onClick:()=>Z(p),className:"text-white hover:bg-[#1E90FF] cursor-pointer",children:[e.jsx(ls,{className:"w-4 h-4 mr-2"}),"Edit Subject"]}),e.jsxs(ss,{onClick:()=>d(p),className:"text-[#DC3545] hover:bg-[#DC3545] hover:text-white cursor-pointer",children:[e.jsx(He,{className:"w-4 h-4 mr-2"}),"Delete Subject"]})]})]})})]},p.id))})]})})})]}),e.jsx(k,{isOpen:N,onClose:()=>{o(!1),B()},onSubmit:re,title:"Create New Subject"}),e.jsx(k,{isOpen:g,onClose:()=>{h(!1),A(null),B()},onSubmit:ge,title:"Edit Subject"}),e.jsx(Ce,{open:I,onOpenChange:j,children:e.jsxs(Fe,{className:"max-w-3xl rounded-2xl bg-[#132C4A] border border-white/10 text-white max-h-[90vh] overflow-y-auto",children:[e.jsx(Se,{children:e.jsxs(Ee,{className:"text-white",children:['Assign "',y==null?void 0:y.name,'" to Classes & Teachers']})}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx($,{className:"text-white",children:"Select Classes *"}),e.jsx("div",{className:"grid md:grid-cols-2 gap-2 max-h-[200px] overflow-y-auto p-3 bg-[#0F243E] rounded-xl border border-white/10",children:O.map(p=>e.jsxs("div",{className:"flex items-center space-x-3 p-2 hover:bg-[#132C4A] rounded-lg transition-colors",children:[e.jsx(Le,{id:`class-${p.id}`,checked:u.selectedClasses.includes(p.name),onCheckedChange:Q=>{T(Q?S(x({},u),{selectedClasses:[...u.selectedClasses,p.name]}):S(x({},u),{selectedClasses:u.selectedClasses.filter(W=>W!==p.name)}))},className:"border-white/20"}),e.jsx($,{htmlFor:`class-${p.id}`,className:"text-white cursor-pointer flex-1",children:p.name})]},p.id))}),e.jsxs("p",{className:"text-xs text-[#C0C8D3]",children:["Selected: ",u.selectedClasses.length," classes"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx($,{className:"text-white",children:"Select Teachers *"}),e.jsx("div",{className:"grid md:grid-cols-2 gap-2 max-h-[200px] overflow-y-auto p-3 bg-[#0F243E] rounded-xl border border-white/10",children:C.map(p=>e.jsxs("div",{className:"flex items-center space-x-3 p-2 hover:bg-[#132C4A] rounded-lg transition-colors",children:[e.jsx(Le,{id:`teacher-${p.id}`,checked:u.selectedTeachers.includes(p.id),onCheckedChange:Q=>{T(Q?S(x({},u),{selectedTeachers:[...u.selectedTeachers,p.id]}):S(x({},u),{selectedTeachers:u.selectedTeachers.filter(W=>W!==p.id)}))},className:"border-white/20"}),e.jsx($,{htmlFor:`teacher-${p.id}`,className:"text-white cursor-pointer flex-1",children:p.name})]},p.id))}),e.jsxs("p",{className:"text-xs text-[#C0C8D3]",children:["Selected: ",u.selectedTeachers.length," teachers"]})]}),e.jsx("div",{className:"p-4 bg-[#1E90FF]/10 border border-[#1E90FF] rounded-xl",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ye,{className:"w-5 h-5 text-[#1E90FF] flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white text-sm mb-1",children:"Assignment Notes"}),e.jsxs("p",{className:"text-[#C0C8D3] text-xs",children:["• Selected teachers will be assigned to all selected classes",e.jsx("br",{}),"• You can assign multiple teachers to the same subject",e.jsx("br",{}),"• Teachers will receive notification of assignment"]})]})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(G,{onClick:()=>{j(!1),A(null),T({selectedClasses:[],selectedTeachers:[]})},variant:"outline",className:"rounded-xl border-white/10 text-[#C0C8D3] hover:bg-[#0F243E] hover:text-white",children:"Cancel"}),e.jsxs(G,{onClick:he,className:"bg-[#28A745] hover:bg-[#28A745]/90 text-white rounded-xl shadow-md hover:scale-105 transition-all",children:[e.jsx(Oe,{className:"w-4 h-4 mr-2"}),"Assign Subject"]})]})]})}),e.jsx(xs,{open:w,onOpenChange:b,children:e.jsxs(ms,{className:"rounded-2xl bg-[#132C4A] border border-white/10",children:[e.jsxs(us,{children:[e.jsx(js,{className:"text-white",children:"Delete Subject"}),e.jsxs(ps,{className:"text-[#C0C8D3]",children:['Are you sure you want to delete "',y==null?void 0:y.name,'"?',y&&y.assignedClasses.length>0&&e.jsxs("span",{className:"block mt-2 text-[#DC3545]",children:["⚠️ This subject is assigned to ",y.assignedClasses.length," classes. Please remove assignments first."]}),y&&y.assignedClasses.length===0&&e.jsx("span",{className:"block mt-2",children:"This action cannot be undone."})]})]}),e.jsxs(gs,{children:[e.jsx(bs,{className:"rounded-xl border-white/10 text-[#C0C8D3] hover:bg-[#0F243E] hover:text-white",children:"Cancel"}),e.jsx(Ns,{onClick:se,className:"bg-[#DC3545] hover:bg-[#DC3545]/90 text-white rounded-xl",children:"Delete Subject"})]})]})})]})}const hc=c.memo(oc),xc=()=>{const[s,t]=c.useState([]),[r,l]=c.useState([]),[i,a]=c.useState(null),[N,o]=c.useState(null),[g,h]=c.useState(!0),[I,j]=c.useState(null);return c.useEffect(()=>{ue(void 0,null,function*(){try{h(!0),j(null);const[b,y]=yield Promise.all([Ys.getAll(),Ks.getAll()]),A=Array.isArray(b)?b:(b==null?void 0:b.data)||[],D=Array.isArray(y)?y:(y==null?void 0:y.data)||[];t(A),l(D);const v=A.find(C=>C.isActive),H=D.find(C=>C.isActive);if(a(v||null),o(H||null),!v||!H)try{const[C,O]=yield Promise.all([Ys.getActive(),Ks.getActive()]);if(!v&&C){const f=(C==null?void 0:C.data)||C;a(f)}if(!H&&O){const f=(O==null?void 0:O.data)||O;o(f)}}catch(C){console.warn("Could not fetch active session/term:",C)}}catch(b){j(b instanceof Error?b.message:"Failed to fetch academic data"),console.error("Error fetching academic data:",b)}finally{h(!1)}})},[]),{sessions:s,terms:r,activeSession:i,activeTerm:N,loading:g,error:I,refetch:()=>{h(!0),j(null)}}};function mc(){const{classes:s,subjects:t,subjectAssignments:r,currentUser:l,addClassSubjectRegistration:i,deleteClassSubjectRegistration:a,fetchClassSubjectRegistrations:N}=ve(),{terms:o,sessions:g,loading:h}=xc(),[I,j]=c.useState(""),[w,b]=c.useState("All"),[y,A]=c.useState(""),[D,v]=c.useState(""),[H,C]=c.useState(!1),[O,f]=c.useState(null),[F,u]=c.useState([]),[T,L]=c.useState([]);c.useEffect(()=>{if(!h){const U=o.find(B=>B.isActive),d=g.find(B=>B.isActive);A((U==null?void 0:U.name)||""),v((d==null?void 0:d.name)||"")}},[o,g,h]);const ee=()=>ue(this,null,function*(){try{const U=yield N({term:y,academicYear:D});L(U)}catch(U){console.error("Error loading registrations:",U),E.error("Failed to load subject registrations")}}),K=T.filter(U=>{const d=U.className.toLowerCase().includes(I.toLowerCase())||U.subjectName.toLowerCase().includes(I.toLowerCase())||U.subjectCode.toLowerCase().includes(I.toLowerCase()),B=w==="All"||U.classId===parseInt(w);return d&&B}),re=U=>{const d=T.filter(B=>B.classId===U&&B.term===y&&B.academicYear===D).map(B=>B.subjectId);return t.filter(B=>!d.includes(B.id))},ge=()=>{f(null),u([]),C(!0)},he=()=>ue(this,null,function*(){if(!O||F.length===0){E.error("Please select a class and at least one subject");return}try{const U=s.find(B=>B.id===O);if(!U)return;const d=F.map(B=>{const k=t.find(p=>p.id===B);return k?i({classId:O,subjectId:B,className:U.name,subjectName:k.name,subjectCode:k.code,term:y||"First Term",academicYear:D||"2024/2025",isCore:k.isCore||!1,status:"Active",registeredBy:(l==null?void 0:l.firstName)||"Admin"}):null});yield Promise.all(d.filter(Boolean)),E.success(`Successfully registered ${F.length} subject(s) for ${U.name}`),C(!1),f(null),u([]),ee()}catch(U){console.error("Error registering subjects:",U),E.error("Failed to register subjects")}}),se=U=>ue(this,null,function*(){try{yield a(U),E.success("Subject registration removed successfully"),ee()}catch(d){console.error("Error removing registration:",d),E.error("Failed to remove subject registration")}}),Z=U=>{u(d=>d.includes(U)?d.filter(B=>B!==U):[...d,U])};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-white mb-2",children:"Class Subject Registration"}),e.jsx("p",{className:"text-[#C0C8D3]",children:"Register subjects for each class per term and academic year"})]}),e.jsxs(qe,{className:"border-blue-200 bg-blue-50 rounded-xl",children:[e.jsx(bt,{className:"h-4 w-4 text-blue-600"}),e.jsxs(Ge,{className:"text-blue-900",children:[e.jsx("strong",{children:"Current Registration Period:"})," ",y||"Select Term"," - ",D||"Select Session",e.jsx("br",{}),e.jsx("span",{className:"text-sm text-blue-700",children:"Register subjects for classes for the current term and academic year"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 flex-1",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Re,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(ae,{placeholder:"Search by class or subject...",value:I,onChange:U=>j(U.target.value),className:"pl-10 h-10 rounded-xl border-gray-300 bg-white"})]}),e.jsxs(ce,{value:w,onValueChange:b,children:[e.jsx(ie,{className:"h-10 rounded-xl border-gray-300 bg-white min-w-40",children:e.jsx(de,{placeholder:"All Classes"})}),e.jsxs(oe,{className:"bg-white border-gray-200",children:[e.jsx(_,{value:"All",children:"All Classes"}),s.map(U=>e.jsx(_,{value:U.id.toString(),children:U.name},U.id))]})]}),e.jsxs(ce,{value:y,onValueChange:A,disabled:h,children:[e.jsx(ie,{className:"h-10 rounded-xl border-gray-300 bg-white min-w-32",children:e.jsx(de,{placeholder:h?"Loading...":"Select Term"})}),e.jsx(oe,{className:"bg-white border-gray-200",children:o.map(U=>e.jsx(_,{value:U.name,children:U.name},U.id))})]}),e.jsxs(ce,{value:D,onValueChange:v,disabled:h,children:[e.jsx(ie,{className:"h-10 rounded-xl border-gray-300 bg-white min-w-32",children:e.jsx(de,{placeholder:h?"Loading...":"Select Session"})}),e.jsx(oe,{className:"bg-white border-gray-200",children:g.map(U=>e.jsx(_,{value:U.name,children:U.name},U.id))})]})]}),e.jsxs(G,{onClick:ge,className:"bg-[#2563EB] hover:bg-[#1E40AF] text-white rounded-xl shadow-md hover:scale-105 transition-all",children:[e.jsx(Ze,{className:"w-5 h-5 mr-2"}),"Register Subjects"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(V,{className:"rounded-xl bg-white border border-gray-200 shadow-sm",children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Total Registrations"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:K.length})]}),e.jsx(we,{className:"w-8 h-8 text-blue-500"})]})})}),e.jsx(V,{className:"rounded-xl bg-white border border-gray-200 shadow-sm",children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Classes Registered"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:new Set(K.map(U=>U.classId)).size})]}),e.jsx(pe,{className:"w-8 h-8 text-green-500"})]})})}),e.jsx(V,{className:"rounded-xl bg-white border border-gray-200 shadow-sm",children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Core Subjects"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:K.filter(U=>U.isCore).length})]}),e.jsx(Ye,{className:"w-8 h-8 text-purple-500"})]})})}),e.jsx(V,{className:"rounded-xl bg-white border border-gray-200 shadow-sm",children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Elective Subjects"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:K.filter(U=>!U.isCore).length})]}),e.jsx(bt,{className:"w-8 h-8 text-orange-500"})]})})})]}),e.jsxs(V,{className:"rounded-xl bg-white border border-gray-200 shadow-sm",children:[e.jsx(me,{className:"p-5 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg text-gray-900",children:["Subject Registrations (",K.length,")"]}),e.jsxs(le,{className:"bg-[#2563EB] text-white border-0",children:[y," - ",D]})]})}),e.jsx(z,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(De,{children:[e.jsx(Be,{children:e.jsxs(xe,{className:"bg-[#2563EB] border-none hover:bg-[#2563EB]",children:[e.jsx(q,{className:"text-white",children:"Class"}),e.jsx(q,{className:"text-white",children:"Subject"}),e.jsx(q,{className:"text-white",children:"Code"}),e.jsx(q,{className:"text-white",children:"Type"}),e.jsx(q,{className:"text-white",children:"Term"}),e.jsx(q,{className:"text-white",children:"Academic Year"}),e.jsx(q,{className:"text-white",children:"Status"}),e.jsx(q,{className:"text-white text-center",children:"Actions"})]})}),e.jsx(Pe,{children:K.length===0?e.jsx(xe,{children:e.jsx(M,{colSpan:8,className:"text-center py-8",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(we,{className:"w-12 h-12 text-gray-300 mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No subject registrations found"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Try adjusting filters or register subjects for classes"})]})})}):K.map(U=>e.jsxs(xe,{className:"hover:bg-gray-50",children:[e.jsx(M,{className:"font-medium",children:U.className}),e.jsx(M,{children:U.subjectName}),e.jsx(M,{children:e.jsx(le,{variant:"outline",className:"border-gray-300",children:U.subjectCode})}),e.jsx(M,{children:e.jsx(le,{className:U.isCore?"bg-purple-100 text-purple-800":"bg-orange-100 text-orange-800",children:U.isCore?"Core":"Elective"})}),e.jsx(M,{children:U.term}),e.jsx(M,{children:U.academicYear}),e.jsx(M,{children:e.jsx(le,{className:U.status==="Active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:U.status})}),e.jsx(M,{className:"text-center",children:e.jsx(G,{variant:"ghost",size:"sm",onClick:()=>se(U.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(He,{className:"w-4 h-4"})})})]},U.id))})]})})})]}),e.jsx(Ce,{open:H,onOpenChange:C,children:e.jsxs(Fe,{className:"max-w-4xl rounded-xl bg-white border border-gray-200 text-gray-900 max-h-[90vh] overflow-y-auto",children:[e.jsxs(Se,{children:[e.jsx(Ee,{className:"text-gray-900",children:"Register Subjects for Class"}),e.jsxs(ts,{className:"text-gray-600",children:["Select subjects to register for ",y||"Select Term"," - ",D||"Select Session"]})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-gray-700",children:"Select Class *"}),e.jsxs(ce,{value:(O==null?void 0:O.toString())||"",onValueChange:U=>f(U?parseInt(U):null),children:[e.jsx(ie,{className:"h-12 rounded-xl border border-gray-300 bg-white text-gray-900",children:e.jsx(de,{placeholder:"Choose a class"})}),e.jsx(oe,{className:"bg-white border-gray-200",children:s.map(U=>e.jsxs(_,{value:U.id.toString(),className:"text-gray-900",children:[U.name," - ",U.level]},U.id))})]})]}),O&&e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-gray-700",children:"Select Subjects *"}),e.jsx("div",{className:"border border-gray-300 rounded-xl p-4 max-h-96 overflow-y-auto bg-gray-50",children:re(O).length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ye,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"All subjects already registered"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"All available subjects have been registered for this class in the current term"})]}):e.jsx("div",{className:"space-y-3",children:re(O).map(U=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Le,{id:U.id.toString(),checked:F.includes(U.id),onCheckedChange:()=>Z(U.id),className:"border-gray-400"}),e.jsxs("div",{children:[e.jsx($,{htmlFor:U.id.toString(),className:"text-gray-900 font-medium cursor-pointer",children:U.name}),e.jsxs("p",{className:"text-gray-500 text-sm",children:[U.code," • ",U.department]})]})]}),e.jsx(le,{className:U.isCore?"bg-purple-100 text-purple-800":"bg-orange-100 text-orange-800",children:U.isCore?"Core":"Elective"})]},U.id))})}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Selected: ",F.length," subject(s)"]})]}),e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-xl",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ye,{className:"w-5 h-5 text-[#2563EB] flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-900 text-sm mb-1",children:"Registration Guidelines"}),e.jsxs("p",{className:"text-gray-600 text-xs",children:["• Register subjects for each class per term and academic year",e.jsx("br",{}),"• Core subjects are mandatory for each class",e.jsx("br",{}),"• Elective subjects can be added based on class requirements",e.jsx("br",{}),"• Registration period: ",y||"Select Term"," - ",D||"Select Session"]})]})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(G,{onClick:()=>C(!1),variant:"outline",className:"rounded-xl border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsxs(G,{onClick:he,disabled:!O||F.length===0,className:"bg-[#2563EB] hover:bg-[#1D4ED8] text-white rounded-xl shadow-sm",children:[e.jsx(Ye,{className:"w-4 h-4 mr-2"}),"Register ",F.length," Subject(s)"]})]})]})})]})}function uc({onBack:s,onSuccess:t}){const{addClass:r}=ve(),[l,i]=c.useState(""),[a,N]=c.useState(""),[o,g]=c.useState(""),[h,I]=c.useState(""),[j,w]=c.useState("Active"),b=y=>ue(this,null,function*(){if(y.preventDefault(),!l||!o||!h){E.error("Please fill all required fields");return}try{const A={name:l,level:h,class_teacher_id:null,capacity:parseInt(o),status:j};console.log("Sending class data:",A);const D=yield Ka.create(A);console.log("API Response:",D);const v=D,H={id:v.id,name:v.name,level:v.level,section:"",capacity:v.capacity,currentStudents:0,classTeacher:"Unassigned",classTeacherId:null,status:v.status,academicYear:new Date().getFullYear().toString()};r(H),E.success("Class created successfully!"),i(""),N(""),g(""),I(""),w("Active"),t()}catch(A){console.error("Error creating class:",A),console.error("Error data:",A==null?void 0:A.data);const D=(A==null?void 0:A.data)&&(A.data.message||A.data.error)||(A==null?void 0:A.message)||"Failed to create class";E.error(D)}});return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(G,{variant:"outline",onClick:s,className:"rounded-lg",children:[e.jsx(Ir,{className:"w-4 h-4 mr-2"}),"Back to Classes"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-[#1F2937]",children:"Create New Class"}),e.jsx("p",{className:"text-[#6B7280] mt-1",children:"Fill in the details to create a new class"})]})]}),e.jsxs(V,{className:"max-w-4xl rounded-lg bg-white border border-[#E5E7EB]",children:[e.jsx(me,{className:"border-b border-[#E5E7EB] p-6",children:e.jsx("h2",{className:"text-xl font-semibold text-[#1F2937]",children:"Class Information"})}),e.jsx(z,{className:"p-6",children:e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#1F2937] font-medium",children:"School Level *"}),e.jsxs(ce,{value:h,onValueChange:I,children:[e.jsx(ie,{className:"h-12 rounded-lg border-[#E5E7EB]",children:e.jsx(de,{placeholder:"Select school level"})}),e.jsxs(oe,{children:[e.jsx(_,{value:"Primary",children:"Primary"}),e.jsx(_,{value:"Secondary",children:"Secondary"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#1F2937] font-medium",children:"Class Name *"}),e.jsx(ae,{placeholder:"e.g., JSS 1A, SS 2B, Primary 3",value:l,onChange:y=>i(y.target.value),className:"h-12 rounded-lg border-[#E5E7EB]"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#1F2937] font-medium",children:"Section (Optional)"}),e.jsx(ae,{placeholder:"e.g., A, B, C",value:a,onChange:y=>N(y.target.value),className:"h-12 rounded-lg border-[#E5E7EB]"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#1F2937] font-medium",children:"Class Capacity *"}),e.jsx(ae,{type:"number",placeholder:"e.g., 35",value:o,onChange:y=>g(y.target.value),className:"h-12 rounded-lg border-[#E5E7EB]"})]})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-[#1F2937] font-medium",children:"Status"}),e.jsxs(ce,{value:j,onValueChange:w,children:[e.jsx(ie,{className:"h-12 rounded-lg border-[#E5E7EB]",children:e.jsx(de,{})}),e.jsxs(oe,{children:[e.jsx(_,{value:"active",children:"Active"}),e.jsx(_,{value:"inactive",children:"Inactive"})]})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-[#E5E7EB]",children:[e.jsx(G,{type:"button",variant:"outline",onClick:s,className:"rounded-lg",children:"Cancel"}),e.jsxs(G,{type:"submit",className:"bg-[#2563EB] hover:bg-[#1D4ED8] text-white rounded-lg",children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Create Class"]})]})]})})]}),e.jsx(V,{className:"max-w-4xl rounded-lg bg-blue-50 border border-blue-200",children:e.jsxs(z,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"💡 Tips for Creating Classes"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• Use clear naming conventions (e.g., JSS 1A, Primary 3B)"}),e.jsx("li",{children:"• Set realistic capacity based on classroom size"}),e.jsx("li",{children:"• Class teacher can be assigned later from Manage Classes page"}),e.jsx("li",{children:"• You can edit class details anytime from the Manage Classes page"})]})]})})]})}function gc(){const{teachers:s,classes:t,subjects:r,subjectAssignments:l,addSubjectAssignment:i,deleteSubjectAssignment:a,currentAcademicYear:N,currentTerm:o,updateClass:g,updateTeacher:h,getTeacherClassTeacherAssignments:I,validateClassTeacherAssignment:j,createTeacherAssignments:w,deleteTeacherAssignment:b}=ve(),[y,A]=c.useState(""),[D,v]=c.useState("All"),[H,C]=c.useState("All"),[O,f]=c.useState(!1),[F,u]=c.useState(!1),[T,L]=c.useState(null),[ee,K]=c.useState([]),[re,ge]=c.useState(""),[he,se]=c.useState(null),Z=l.filter(n=>{const m=n.teacherName.toLowerCase().includes(y.toLowerCase())||n.subjectName.toLowerCase().includes(y.toLowerCase())||n.className.toLowerCase().includes(y.toLowerCase()),P=D==="All"||n.teacherId===parseInt(D),J=H==="All"||n.classId===parseInt(H);return m&&P&&J}),U={totalAssignments:l.length,uniqueTeachers:new Set(l.map(n=>n.teacherId)).size,uniqueSubjects:new Set(l.map(n=>n.subjectId)).size,uniqueClasses:new Set(l.map(n=>n.classId)).size},d=n=>{K([]),se(null),f(!0)},B=(n,m)=>{var te,Y;const P=l.find(ne=>ne.subjectId===n&&ne.classId===m);if(P){const ne=s.find(Ne=>Ne.id===P.teacherId);E.error(`${(te=r.find(Ne=>Ne.id===n))==null?void 0:te.name} in ${(Y=t.find(Ne=>Ne.id===m))==null?void 0:Y.name} is already assigned to ${ne==null?void 0:ne.firstName} ${ne==null?void 0:ne.lastName}`);return}const J=ee.some(ne=>ne.subjectId===n&&ne.classId===m);K(J?ee.filter(ne=>!(ne.subjectId===n&&ne.classId===m)):[...ee,{subjectId:n,classId:m}])},k=()=>ue(this,null,function*(){if(!T){E.error("Please select a teacher");return}if(ee.length===0){E.error("Please select at least one subject-class combination");return}const n=s.find(m=>m.id===T);if(n)try{const m=yield w(T,ee),P=m.created_count||0;m.errors&&m.errors.length>0?E.error(`Some assignments failed: ${m.errors.join(", ")}`):E.success(`${P} assignment(s) added for ${n.firstName} ${n.lastName}`),f(!1),L(null),K([]),se(null)}catch(m){console.error("Error saving assignments:",m),E.error("Failed to save assignments. Please try again.")}}),p=n=>ue(this,null,function*(){const m=l.find(P=>P.id===n);if(m)try{yield b(n),E.success(`Assignment removed: ${m.subjectName} - ${m.className}`)}catch(P){console.error("Error deleting assignment:",P),E.error("Failed to delete assignment. Please try again.")}}),Q=n=>{ge(""),u(!0)},W=()=>{if(!T||!re){E.error("Please select a teacher and a class");return}const n=s.find(P=>P.id===T),m=t.find(P=>P.id===parseInt(re));if(!(!n||!m)){if(m.classTeacherId&&m.classTeacherId!==T){const P=s.find(J=>J.id===m.classTeacherId);E.error(`${m.name} already has a class teacher: ${P==null?void 0:P.firstName} ${P==null?void 0:P.lastName}`);return}g(parseInt(re),{classTeacherId:T,classTeacher:`${n.firstName} ${n.lastName}`}),h(T,{isClassTeacher:!0,classTeacherId:parseInt(re)}),E.success(`${n.firstName} ${n.lastName} assigned as class teacher for ${m.name}`),u(!1),L(null),ge("")}},R=n=>{const m=t.find(J=>J.id===n);if(!m||!m.classTeacherId)return;const P=m.classTeacherId;g(n,{classTeacherId:null,classTeacher:""}),h(P,{isClassTeacher:!1,classTeacherId:null}),s.find(J=>J.id===P),E.success(`Class teacher assignment removed for ${m.name}`)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-white mb-2",children:"Manage Teacher Assignments"}),e.jsx("p",{className:"text-[#C0C8D3]",children:"Assign teachers to subjects and classes"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(V,{className:"rounded-xl bg-[#F4F6F9] border border-gray-200 shadow-sm hover:shadow-md transition-all",children:e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Total Assignments"}),e.jsx(we,{className:"w-6 h-6 text-[#2563EB]"})]}),e.jsx("p",{className:"text-2xl text-gray-900",children:U.totalAssignments}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Subject-Class assignments"})]})}),e.jsx(V,{className:"rounded-xl bg-[#F4F6F9] border border-gray-200 shadow-sm hover:shadow-md transition-all",children:e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Active Teachers"}),e.jsx(pe,{className:"w-6 h-6 text-[#10B981]"})]}),e.jsx("p",{className:"text-2xl text-gray-900",children:U.uniqueTeachers}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"With assignments"})]})}),e.jsx(V,{className:"rounded-xl bg-[#F4F6F9] border border-gray-200 shadow-sm hover:shadow-md transition-all",children:e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Subjects"}),e.jsx(we,{className:"w-6 h-6 text-[#3B82F6]"})]}),e.jsx("p",{className:"text-2xl text-gray-900",children:U.uniqueSubjects}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Being taught"})]})}),e.jsx(V,{className:"rounded-xl bg-[#F4F6F9] border border-gray-200 shadow-sm hover:shadow-md transition-all",children:e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Classes"}),e.jsx(pe,{className:"w-6 h-6 text-[#EF4444]"})]}),e.jsx("p",{className:"text-2xl text-gray-900",children:U.uniqueClasses}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"With teachers"})]})})]}),e.jsxs(qe,{className:"border-blue-200 bg-blue-50 rounded-xl",children:[e.jsx(ir,{className:"h-4 w-4 text-blue-600"}),e.jsxs(Ge,{className:"text-blue-900",children:[e.jsx("strong",{children:"Current Session:"})," ",N," - ",o,e.jsx("br",{}),e.jsx("span",{className:"text-sm text-blue-700",children:"All assignments are created for the current session and term. Change session in System Settings."})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(G,{onClick:()=>d(),className:"bg-[#2563EB] hover:bg-[#1E40AF] text-white rounded-xl shadow-md hover:scale-105 transition-all",children:[e.jsx(Ze,{className:"w-5 h-5 mr-2"}),"Assign Subject to Teacher"]}),e.jsxs(G,{onClick:()=>Q(),className:"bg-[#10B981] hover:bg-[#059669] text-white rounded-xl shadow-md hover:scale-105 transition-all",children:[e.jsx(cs,{className:"w-5 h-5 mr-2"}),"Assign Class Teacher"]})]}),e.jsxs(V,{className:"rounded-xl bg-white border border-gray-200 shadow-sm",children:[e.jsx(me,{className:"border-b border-gray-200 bg-gradient-to-r from-green-50 to-emerald-50 p-5",children:e.jsxs(gt,{className:"text-gray-900 flex items-center gap-2",children:[e.jsx(cs,{className:"w-5 h-5 text-green-600"}),"Class Teachers Overview"]})}),e.jsx(z,{className:"p-5",children:e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(n=>e.jsx(V,{className:"border-gray-200 rounded-xl",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-gray-900",children:n.name}),n.classTeacherId?e.jsx(le,{className:"bg-green-100 text-green-800 rounded-xl",children:"Assigned"}):e.jsx(le,{className:"bg-yellow-100 text-yellow-800 rounded-xl",children:"No Teacher"})]}),n.classTeacherId?e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:n.classTeacher}),e.jsxs(G,{onClick:()=>R(n.id),size:"sm",variant:"destructive",className:"w-full rounded-xl text-xs",children:[e.jsx(ds,{className:"w-3 h-3 mr-1"}),"Remove"]})]}):e.jsxs(G,{onClick:()=>{ge(n.id.toString()),Q()},size:"sm",variant:"outline",className:"w-full rounded-xl text-xs border-gray-300",children:[e.jsx(Ze,{className:"w-3 h-3 mr-1"}),"Assign Teacher"]})]})},n.id))})})]}),e.jsxs(V,{className:"rounded-xl bg-white border border-gray-200 shadow-sm",children:[e.jsx(me,{className:"border-b border-gray-200 bg-gray-50 p-5 rounded-t-xl",children:e.jsx(gt,{className:"text-gray-900",children:"Subject Assignments"})}),e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx($,{className:"text-gray-700",children:"Search Assignments"}),e.jsxs("div",{className:"relative",children:[e.jsx(Re,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx(ae,{placeholder:"Search by teacher, subject, or class...",value:y,onChange:n=>A(n.target.value),className:"h-12 pl-11 rounded-xl border border-gray-300 bg-white text-gray-900"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-gray-700",children:"Filter by Teacher"}),e.jsxs(ce,{value:D,onValueChange:v,children:[e.jsx(ie,{className:"h-12 rounded-xl border border-gray-300 bg-white text-gray-900",children:e.jsx(de,{})}),e.jsxs(oe,{className:"bg-white border-gray-200",children:[e.jsx(_,{value:"All",className:"text-gray-900",children:"All Teachers"}),s.map(n=>e.jsxs(_,{value:n.id.toString(),className:"text-gray-900",children:[n.firstName," ",n.lastName]},n.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-gray-700",children:"Filter by Class"}),e.jsxs(ce,{value:H,onValueChange:C,children:[e.jsx(ie,{className:"h-12 rounded-xl border border-gray-300 bg-white text-gray-900",children:e.jsx(de,{})}),e.jsxs(oe,{className:"bg-white border-gray-200",children:[e.jsx(_,{value:"All",className:"text-gray-900",children:"All Classes"}),t.map(n=>e.jsx(_,{value:n.id.toString(),className:"text-gray-900",children:n.name},n.id))]})]})]})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsxs(G,{onClick:()=>d(),className:"bg-[#10B981] hover:bg-[#059669] text-white rounded-xl shadow-sm",children:[e.jsx(Ze,{className:"w-4 h-4 mr-2"}),"New Assignment"]})})]})]}),e.jsxs(V,{className:"rounded-xl bg-white border border-gray-200 shadow-sm",children:[e.jsx(me,{className:"p-5 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg text-gray-900",children:["All Assignments (",Z.length,")"]}),e.jsxs(le,{className:"bg-[#2563EB] text-white border-0",children:[o," - ",N]})]})}),e.jsx(z,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(De,{children:[e.jsx(Be,{children:e.jsxs(xe,{className:"bg-[#2563EB] border-none hover:bg-[#2563EB]",children:[e.jsx(q,{className:"text-white",children:"Teacher"}),e.jsx(q,{className:"text-white",children:"Subject"}),e.jsx(q,{className:"text-white",children:"Class"}),e.jsx(q,{className:"text-white",children:"Term"}),e.jsx(q,{className:"text-white text-center",children:"Actions"})]})}),e.jsx(Pe,{children:Z.length===0?e.jsx(xe,{className:"bg-white",children:e.jsx(M,{colSpan:5,className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(we,{className:"w-12 h-12 text-gray-400"}),e.jsx("p",{className:"text-gray-900",children:"No assignments found"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Try adjusting your search or filters"})]})})}):Z.map(n=>e.jsxs(xe,{className:"bg-white border-b border-gray-100 hover:bg-gray-50",children:[e.jsx(M,{className:"text-gray-900",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-[#2563EB] to-[#3B82F6] flex items-center justify-center",children:e.jsx(pe,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-900",children:n.teacherName}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Teacher ID: ",n.teacherId]})]})]})}),e.jsx(M,{className:"text-gray-900",children:n.subjectName}),e.jsx(M,{className:"text-gray-900",children:e.jsx(le,{className:"bg-[#3B82F6] text-white border-0",children:n.className})}),e.jsx(M,{className:"text-gray-600 text-sm",children:n.term}),e.jsx(M,{className:"text-center",children:e.jsx(G,{onClick:()=>p(n.id),size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-red-600 hover:bg-red-50",children:e.jsx(He,{className:"w-4 h-4"})})})]},n.id))})]})})})]}),e.jsx(Ce,{open:O,onOpenChange:f,children:e.jsxs(Fe,{className:"max-w-4xl rounded-xl bg-white border border-gray-200 text-gray-900 max-h-[90vh] overflow-y-auto",children:[e.jsx(Se,{children:e.jsx(Ee,{className:"text-gray-900",children:"Create Teacher Assignments"})}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-gray-700",children:"Select Teacher *"}),e.jsxs(ce,{value:(T==null?void 0:T.toString())||"",onValueChange:n=>L(parseInt(n)),children:[e.jsx(ie,{className:"h-12 rounded-xl border border-gray-300 bg-white text-gray-900",children:e.jsx(de,{placeholder:"Choose a teacher"})}),e.jsx(oe,{className:"bg-white border-gray-200",children:s.map(n=>e.jsxs(_,{value:n.id.toString(),className:"text-gray-900",children:[n.firstName," ",n.lastName," - ",n.specialization.join(", ")]},n.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-gray-700",children:"Filter by Class (Optional)"}),e.jsxs(ce,{value:(he==null?void 0:he.toString())||"",onValueChange:n=>se(n?parseInt(n):null),children:[e.jsx(ie,{className:"h-12 rounded-xl border border-gray-300 bg-white text-gray-900",children:e.jsx(de,{placeholder:"All classes"})}),e.jsxs(oe,{className:"bg-white border-gray-200",children:[e.jsx(_,{value:"",className:"text-gray-900",children:"All Classes"}),t.map(n=>e.jsxs(_,{value:n.id.toString(),className:"text-gray-900",children:[n.name," - ",n.level]},n.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-gray-700",children:"Select Subject-Class Combinations *"}),e.jsx("div",{className:"border border-gray-300 rounded-xl p-4 max-h-96 overflow-y-auto bg-gray-50",children:e.jsx("div",{className:"space-y-4",children:r.map(n=>{const m=he?t.filter(P=>P.id===he):t;return m.length===0?null:e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsxs("p",{className:"text-sm text-gray-900 mb-3",children:[n.name," (",n.code,")"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:m.map(P=>{const J=ee.some(Y=>Y.subjectId===n.id&&Y.classId===P.id),te=l.some(Y=>Y.subjectId===n.id&&Y.classId===P.id);return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{id:`${n.id}-${P.id}`,checked:J,disabled:te,onCheckedChange:()=>B(n.id,P.id),className:`border-gray-400 ${te?"opacity-50 cursor-not-allowed":""}`}),e.jsxs($,{htmlFor:`${n.id}-${P.id}`,className:`text-sm cursor-pointer ${te?"text-gray-400 line-through":"text-gray-700"}`,children:[P.name,te&&e.jsx("span",{className:"text-xs text-red-500 ml-1",children:"(Assigned)"})]})]},P.id)})})]},n.id)})})})]}),e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-xl",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ye,{className:"w-5 h-5 text-[#2563EB] flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-900 text-sm mb-1",children:"Assignment Guidelines"}),e.jsxs("p",{className:"text-gray-600 text-xs",children:["• Teachers can be assigned to multiple subjects and classes",e.jsx("br",{}),"• Each subject-class combination can have only one teacher",e.jsx("br",{}),"• Ensure teacher specialization matches assigned subjects",e.jsx("br",{}),"• Assignments are for: ",o," - ",N]})]})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(G,{onClick:()=>{f(!1),L(null),K([]),se(null)},variant:"outline",className:"rounded-xl border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsxs(G,{onClick:k,className:"bg-[#2563EB] hover:bg-[#1D4ED8] text-white rounded-xl shadow-sm",children:[e.jsx(Ye,{className:"w-4 h-4 mr-2"}),"Create Assignments (",ee.length,")"]})]})]})}),e.jsx(Ce,{open:F,onOpenChange:u,children:e.jsxs(Fe,{className:"max-w-md rounded-xl bg-white border border-gray-200 text-gray-900",children:[e.jsxs(Se,{children:[e.jsxs(Ee,{className:"text-gray-900 flex items-center gap-2",children:[e.jsx(cs,{className:"w-5 h-5 text-green-600"}),"Assign Class Teacher"]}),e.jsx(ts,{className:"text-gray-600",children:"Assign a teacher as class teacher for a class. Maximum 3 classes per teacher."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-gray-700",children:"Select Teacher"}),e.jsxs(ce,{value:(T==null?void 0:T.toString())||"",onValueChange:n=>L(parseInt(n)),children:[e.jsx(ie,{className:"h-12 rounded-xl border border-gray-300 bg-white text-gray-900",children:e.jsx(de,{placeholder:"Choose a teacher..."})}),e.jsx(oe,{className:"bg-white border-gray-200",children:s.filter(n=>n.status==="Active").map(n=>{const m=I(n.id);return e.jsxs(_,{value:n.id.toString(),className:"text-gray-900",children:[n.firstName," ",n.lastName," - ",n.employeeId,m.length>0&&e.jsxs("span",{className:"text-xs text-green-600 ml-2",children:["(",m.length," class",m.length>1?"es":"",")"]})]},n.id)})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-gray-700",children:"Select Class"}),e.jsxs(ce,{value:re,onValueChange:ge,disabled:!T,children:[e.jsx(ie,{className:"h-12 rounded-xl border border-gray-300 bg-white text-gray-900",children:e.jsx(de,{placeholder:T?"Choose a class...":"Select a teacher first"})}),e.jsx(oe,{className:"bg-white border-gray-200",children:t.filter(n=>{var m;return((m=n.status)==null?void 0:m.toLowerCase())==="active"}).map(n=>e.jsxs(_,{value:n.id.toString(),className:"text-gray-900",children:[n.name," - ",n.level,n.classTeacherId&&e.jsxs("span",{className:"text-xs text-yellow-600 ml-2",children:["(Has teacher: ",n.classTeacher,")"]})]},n.id))})]})]}),T&&e.jsxs(qe,{className:"border-blue-200 bg-blue-50 rounded-xl",children:[e.jsx(ye,{className:"h-4 w-4 text-blue-600"}),e.jsxs(Ge,{className:"text-blue-900 text-sm",children:["Teacher currently assigned to ",I(T).length," class(es).",e.jsx("br",{}),"Maximum limit: 3 classes per teacher."]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(G,{onClick:()=>{u(!1),L(null),ge("")},variant:"outline",className:"rounded-xl border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsxs(G,{onClick:W,disabled:!T||!re,className:"bg-[#10B981] hover:bg-[#059669] text-white rounded-xl shadow-sm",children:[e.jsx(Ye,{className:"w-4 h-4 mr-2"}),"Assign Class Teacher"]})]})]})})]})}function jc(){const{students:s,classes:t,compiledResults:r,promoteMultipleStudents:l,addActivityLog:i,currentUser:a}=ve(),[N,o]=c.useState(""),[g,h]=c.useState(""),[I,j]=c.useState("All"),[w,b]=c.useState([]),[y,A]=c.useState({}),[D,v]=c.useState(!1),[H,C]=c.useState("2025/2026"),[O,f]=c.useState(!1),T=(N?s.filter(d=>d.classId===Number(N)&&d.status==="Active"):[]).map(d=>{const B=r.filter(W=>W.studentId===d.id&&W.status==="Approved").sort((W,R)=>new Date(R.compiledDate).getTime()-new Date(W.compiledDate).getTime())[0];let k="Repeat",p=0,Q=0;return B&&(p=B.averageScore,Q=B.totalAttendanceDays>0?B.timesPresent/B.totalAttendanceDays*100:0,p>=50&&Q>=75?k="Promote":p>=40&&p<50?k="Trial":k="Repeat"),S(x({},d),{averageScore:p,attendance:Q,promotionStatus:k,position:(B==null?void 0:B.position)||0,totalStudents:(B==null?void 0:B.totalStudents)||0})}).filter(d=>{const B=d.firstName.toLowerCase().includes(g.toLowerCase())||d.lastName.toLowerCase().includes(g.toLowerCase())||d.admissionNumber.toLowerCase().includes(g.toLowerCase()),k=I==="All"||d.promotionStatus===I;return B&&k}),L={totalStudents:T.length,toPromote:T.filter(d=>d.promotionStatus==="Promote").length,onTrial:T.filter(d=>d.promotionStatus==="Trial").length,toRepeat:T.filter(d=>d.promotionStatus==="Repeat").length,pending:T.filter(d=>d.averageScore===0).length},ee=(d,B)=>{if(B)b([...w,d]);else{b(w.filter(p=>p!==d));const k=x({},y);delete k[d],A(k)}},K=d=>{if(d){const B=T.filter(k=>k.promotionStatus==="Promote").map(k=>k.id);b(B)}else b([]),A({})},re=(d,B)=>{A(S(x({},y),{[d]:B}))},ge=()=>{if(w.length===0){E.error("Please select students to promote");return}if(w.filter(B=>!y[B]).length>0){E.error("Please set destination class for all selected students");return}v(!0)},he=()=>ue(this,null,function*(){var d;f(!0);try{yield l(w,y,H),a&&i({actor:a.username||a.name||"Unknown",actorRole:"Admin",action:"Promote Students",target:`${w.length} students promoted`,ip:"System",status:"Success",details:`Promoted ${w.length} students from ${((d=t.find(B=>B.id===Number(N)))==null?void 0:d.name)||"Unknown Class"} to ${H}`}),E.success(`Successfully promoted ${w.length} students!`),v(!1),b([]),A({})}catch(B){console.error("Promotion error:",B),E.error("Failed to promote students. Please try again.")}finally{f(!1)}}),se=d=>{switch(d){case"Promote":return e.jsxs(le,{className:"bg-[#28A745] text-white border-0",children:[e.jsx($e,{className:"w-3 h-3 mr-1"}),"Promote"]});case"Trial":return e.jsxs(le,{className:"bg-[#FFC107] text-white border-0",children:[e.jsx(Gs,{className:"w-3 h-3 mr-1"}),"Trial"]});case"Repeat":return e.jsxs(le,{className:"bg-[#DC3545] text-white border-0",children:[e.jsx(is,{className:"w-3 h-3 mr-1"}),"Repeat"]});default:return e.jsx(le,{className:"bg-gray-500 text-white border-0",children:"Pending"})}},Z=d=>{const B=t.find(k=>k.id===d);return B?t.filter(k=>{var p,Q,W,R;if(B.level==="Primary"){const n=parseInt(((p=B.name.match(/\d+/))==null?void 0:p[0])||"0"),m=parseInt(((Q=k.name.match(/\d+/))==null?void 0:Q[0])||"0");if(k.level==="Primary"&&m===n+1||k.level==="Secondary"&&B.name.includes("6")&&k.name.includes("JSS 1"))return!0}if(B.level==="Secondary"){const n=parseInt(((W=B.name.match(/\d+/))==null?void 0:W[0])||"0"),m=parseInt(((R=k.name.match(/\d+/))==null?void 0:R[0])||"0");if(B.name.includes("JSS")&&k.name.includes("JSS")&&m===n+1||B.name==="JSS 3"&&k.name==="SSS 1"||B.name.includes("SSS")&&k.name.includes("SSS")&&m===n+1)return!0}return!1}):[]},U=()=>{const d=["Student Name","Admission No","Current Class","Average Score","Position","Attendance","Status","Next Class"],B=T.map(R=>{var m;const n=y[R.id]?(m=t.find(P=>P.id===y[R.id]))==null?void 0:m.name:"-";return[`${R.firstName} ${R.lastName}`,R.admissionNumber,R.className,R.averageScore.toFixed(1),`${R.position}/${R.totalStudents}`,`${R.attendance.toFixed(0)}%`,R.promotionStatus,n||"-"]}),k=[d,...B].map(R=>R.join(",")).join(`
`),p=new Blob([k],{type:"text/csv"}),Q=URL.createObjectURL(p),W=document.createElement("a");W.href=Q,W.download=`promotion-list-${new Date().toISOString().split("T")[0]}.csv`,W.click(),E.success("Promotion list exported successfully")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-white mb-2",children:"Student Promotion System"}),e.jsx("p",{className:"text-[#C0C8D3]",children:"Promote students to next academic session"})]}),N&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(pe,{className:"w-4 h-4 text-[#1E90FF]"}),e.jsx("p",{className:"text-[#C0C8D3] text-sm",children:"Total"})]}),e.jsx("p",{className:"text-white text-2xl",children:L.totalStudents})]})}),e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx($e,{className:"w-4 h-4 text-[#28A745]"}),e.jsx("p",{className:"text-[#C0C8D3] text-sm",children:"Promote"})]}),e.jsx("p",{className:"text-[#28A745] text-2xl",children:L.toPromote})]})}),e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Gs,{className:"w-4 h-4 text-[#FFC107]"}),e.jsx("p",{className:"text-[#C0C8D3] text-sm",children:"Trial"})]}),e.jsx("p",{className:"text-[#FFC107] text-2xl",children:L.onTrial})]})}),e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(is,{className:"w-4 h-4 text-[#DC3545]"}),e.jsx("p",{className:"text-[#C0C8D3] text-sm",children:"Repeat"})]}),e.jsx("p",{className:"text-[#DC3545] text-2xl",children:L.toRepeat})]})}),e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Qs,{className:"w-4 h-4 text-[#1E90FF]"}),e.jsx("p",{className:"text-[#C0C8D3] text-sm",children:"Pending"})]}),e.jsx("p",{className:"text-white text-2xl",children:L.pending})]})})]}),e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"New Academic Year"}),e.jsxs(ce,{value:H,onValueChange:C,children:[e.jsx(ie,{className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white",children:e.jsx(de,{})}),e.jsxs(oe,{className:"bg-[#0F243E] border-white/10",children:[e.jsx(_,{value:"2025/2026",className:"text-white hover:bg-[#1E90FF]",children:"2025/2026"}),e.jsx(_,{value:"2026/2027",className:"text-white hover:bg-[#1E90FF]",children:"2026/2027"}),e.jsx(_,{value:"2027/2028",className:"text-white hover:bg-[#1E90FF]",children:"2027/2028"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"Source Class *"}),e.jsxs(ce,{value:N,onValueChange:o,children:[e.jsx(ie,{className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white",children:e.jsx(de,{placeholder:"Select class"})}),e.jsx(oe,{className:"bg-[#0F243E] border-white/10",children:t.filter(d=>{var B;return((B=d.status)==null?void 0:B.toLowerCase())==="active"}).map(d=>e.jsxs(_,{value:d.id.toString(),className:"text-white hover:bg-[#1E90FF]",children:[d.name," (",s.filter(B=>B.classId===d.id&&B.status==="Active").length," students)"]},d.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"Filter by Status"}),e.jsxs(ce,{value:I,onValueChange:j,children:[e.jsx(ie,{className:"h-12 rounded-xl border border-white/10 bg-[#0F243E] text-white",children:e.jsx(de,{})}),e.jsxs(oe,{className:"bg-[#0F243E] border-white/10",children:[e.jsx(_,{value:"All",className:"text-white hover:bg-[#1E90FF]",children:"All Students"}),e.jsx(_,{value:"Promote",className:"text-white hover:bg-[#1E90FF]",children:"Promote Only"}),e.jsx(_,{value:"Trial",className:"text-white hover:bg-[#1E90FF]",children:"Trial Only"}),e.jsx(_,{value:"Repeat",className:"text-white hover:bg-[#1E90FF]",children:"Repeat Only"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"text-white",children:"Search Student"}),e.jsxs("div",{className:"relative",children:[e.jsx(Re,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-[#C0C8D3]"}),e.jsx(ae,{value:g,onChange:d=>h(d.target.value),placeholder:"Name or Admission No...",className:"h-12 pl-10 rounded-xl border border-white/10 bg-[#0F243E] text-white"})]})]})]})})}),N?e.jsxs(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:[e.jsx(me,{className:"p-5 border-b border-white/10",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("h3",{className:"text-white flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5"}),"Students for Promotion (",T.length,")"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(G,{onClick:U,variant:"outline",className:"h-10 border-white/10 text-white hover:bg-[#0F243E] rounded-xl",children:[e.jsx(as,{className:"w-4 h-4 mr-2"}),"Export"]}),e.jsx(G,{onClick:ge,disabled:w.length===0||O,className:"h-10 bg-[#28A745] hover:bg-[#28A745]/90 text-white rounded-xl shadow-md",children:O?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 mr-2 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Promoting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(kr,{className:"w-4 h-4 mr-2"}),"Promote Selected (",w.length,")"]})})]})]})}),e.jsx(z,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(De,{children:[e.jsx(Be,{children:e.jsxs(xe,{className:"bg-gradient-to-r from-[#1E90FF] to-[#00BFFF] border-none hover:bg-gradient-to-r",children:[e.jsx(q,{className:"text-white",children:e.jsx(Le,{checked:w.length===T.filter(d=>d.promotionStatus==="Promote").length,onCheckedChange:K,className:"border-white"})}),e.jsx(q,{className:"text-white",children:"Student"}),e.jsx(q,{className:"text-white",children:"Adm. No"}),e.jsx(q,{className:"text-white text-center",children:"Average"}),e.jsx(q,{className:"text-white text-center",children:"Position"}),e.jsx(q,{className:"text-white text-center",children:"Attendance"}),e.jsx(q,{className:"text-white",children:"Status"}),e.jsx(q,{className:"text-white",children:"Destination Class"})]})}),e.jsx(Pe,{children:T.length===0?e.jsx(xe,{className:"bg-[#0F243E] border-b border-white/5",children:e.jsxs(M,{colSpan:8,className:"text-center py-12",children:[e.jsx("p",{className:"text-white mb-2",children:"No students found"}),e.jsx("p",{className:"text-[#C0C8D3] text-sm",children:"Try adjusting your filters"})]})}):T.map(d=>{var k;const B=Z(d.classId);return e.jsxs(xe,{className:"bg-[#0F243E] border-b border-white/5 hover:bg-[#132C4A]",children:[e.jsx(M,{children:e.jsx(Le,{checked:w.includes(d.id),onCheckedChange:p=>ee(d.id,p),disabled:d.promotionStatus==="Repeat",className:"border-white/20"})}),e.jsx(M,{children:e.jsxs("div",{children:[e.jsxs("p",{className:"text-white",children:[d.firstName," ",d.lastName]}),e.jsx("p",{className:"text-xs text-[#C0C8D3]",children:d.className})]})}),e.jsx(M,{className:"text-[#C0C8D3]",children:d.admissionNumber}),e.jsxs(M,{className:"text-center text-white",children:[d.averageScore.toFixed(1),"%"]}),e.jsx(M,{className:"text-center text-[#FFD700]",children:d.position>0?`${d.position}/${d.totalStudents}`:"-"}),e.jsxs(M,{className:"text-center text-[#C0C8D3]",children:[d.attendance.toFixed(0),"%"]}),e.jsx(M,{children:se(d.promotionStatus)}),e.jsx(M,{children:w.includes(d.id)?e.jsxs(ce,{value:((k=y[d.id])==null?void 0:k.toString())||"",onValueChange:p=>re(d.id,Number(p)),children:[e.jsx(ie,{className:"h-10 w-full rounded-xl border border-white/10 bg-[#132C4A] text-white",children:e.jsx(de,{placeholder:"Select class"})}),e.jsx(oe,{className:"bg-[#0F243E] border-white/10",children:B.map(p=>e.jsx(_,{value:p.id.toString(),className:"text-white hover:bg-[#1E90FF]",children:p.name},p.id))})]}):e.jsx("span",{className:"text-[#C0C8D3]",children:"-"})})]},d.id)})})]})})})]}):e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:e.jsxs(z,{className:"p-12 text-center",children:[e.jsx(Me,{className:"w-16 h-16 mx-auto mb-4 text-[#1E90FF]"}),e.jsx("h3",{className:"text-white mb-2",children:"Select a Source Class"}),e.jsx("p",{className:"text-[#C0C8D3]",children:"Choose a class from the dropdown above to view students for promotion"})]})}),e.jsx(xs,{open:D,onOpenChange:v,children:e.jsxs(ms,{className:"bg-[#0F243E] border-white/10",children:[e.jsxs(us,{children:[e.jsx(js,{className:"text-white",children:"Confirm Student Promotion"}),e.jsxs(ps,{className:"text-[#C0C8D3]",children:["You are about to promote ",w.length," student(s) to the ",H," academic year. This action will update their class assignments and academic year records.",e.jsx("br",{}),e.jsx("br",{}),"Are you sure you want to continue?"]})]}),e.jsxs(gs,{children:[e.jsx(bs,{className:"bg-[#132C4A] text-white border-white/10 hover:bg-[#132C4A]/80",children:"Cancel"}),e.jsx(Ns,{onClick:he,disabled:O,className:"bg-[#28A745] hover:bg-[#28A745]/90 text-white",children:O?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 mr-2 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Processing..."]}):"Confirm Promotion"})]})]})})]})}function pc(){const{compiledResults:s,students:t,classes:r}=ve(),[l,i]=c.useState("all"),[a,N]=c.useState("all"),[o,g]=c.useState("all"),h=s.filter(D=>!(l!=="all"&&D.classId!==parseInt(l)||a!=="all"&&D.status!==a||o!=="all"&&D.term!==o)),I=h.length,j=h.filter(D=>D.status==="Approved").length,w=h.filter(D=>D.status==="Submitted").length,b=h.filter(D=>D.status==="Draft").length,y=D=>{E.success(`Opening result details for ID: ${D}`)},A=D=>{E.success(`Downloading result ID: ${D}`)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-[#1F2937] mb-2",children:"View All Results"}),e.jsx("p",{className:"text-[#6B7280]",children:"Browse and manage all compiled student results"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Total Results"}),e.jsx(As,{className:"w-5 h-5 text-[#3B82F6]"})]}),e.jsx("p",{className:"text-[#1F2937] mb-1 font-semibold",children:I}),e.jsx("p",{className:"text-xs text-[#6B7280]",children:"Compiled results"})]})}),e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Approved"}),e.jsx(Qs,{className:"w-5 h-5 text-[#10B981]"})]}),e.jsx("p",{className:"text-[#1F2937] mb-1 font-semibold",children:j}),e.jsx("p",{className:"text-xs text-[#10B981]",children:"Ready for distribution"})]})}),e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Pending"}),e.jsx(ye,{className:"w-5 h-5 text-[#F59E0B]"})]}),e.jsx("p",{className:"text-[#1F2937] mb-1 font-semibold",children:w}),e.jsx("p",{className:"text-xs text-[#F59E0B]",children:"Awaiting approval"})]})}),e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Draft"}),e.jsx(As,{className:"w-5 h-5 text-[#6B7280]"})]}),e.jsx("p",{className:"text-[#1F2937] mb-1 font-semibold",children:b}),e.jsx("p",{className:"text-xs text-[#6B7280]",children:"In progress"})]})})]}),e.jsxs(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:[e.jsx(me,{className:"p-4 border-b border-[#E5E7EB]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_t,{className:"w-5 h-5 text-[#3B82F6]"}),e.jsx("h3",{className:"text-[#1F2937] font-semibold",children:"Filters"})]})}),e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[#1F2937] text-sm",children:"Class"}),e.jsxs(ce,{value:l,onValueChange:i,children:[e.jsx(ie,{className:"h-12 rounded-lg border border-[#E5E7EB] bg-[#F9FAFB] text-[#1F2937]",children:e.jsx(de,{placeholder:"All Classes"})}),e.jsxs(oe,{className:"bg-white border border-[#E5E7EB]",children:[e.jsx(_,{value:"all",children:"All Classes"}),r.map(D=>e.jsx(_,{value:D.id.toString(),children:D.name},D.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[#1F2937] text-sm",children:"Status"}),e.jsxs(ce,{value:a,onValueChange:N,children:[e.jsx(ie,{className:"h-12 rounded-lg border border-[#E5E7EB] bg-[#F9FAFB] text-[#1F2937]",children:e.jsx(de,{placeholder:"All Status"})}),e.jsxs(oe,{className:"bg-white border border-[#E5E7EB]",children:[e.jsx(_,{value:"all",children:"All Status"}),e.jsx(_,{value:"Draft",children:"Draft"}),e.jsx(_,{value:"Submitted",children:"Submitted"}),e.jsx(_,{value:"Approved",children:"Approved"}),e.jsx(_,{value:"Rejected",children:"Rejected"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[#1F2937] text-sm",children:"Term"}),e.jsxs(ce,{value:o,onValueChange:g,children:[e.jsx(ie,{className:"h-12 rounded-lg border border-[#E5E7EB] bg-[#F9FAFB] text-[#1F2937]",children:e.jsx(de,{placeholder:"All Terms"})}),e.jsxs(oe,{className:"bg-white border border-[#E5E7EB]",children:[e.jsx(_,{value:"all",children:"All Terms"}),e.jsx(_,{value:"First Term",children:"First Term"}),e.jsx(_,{value:"Second Term",children:"Second Term"}),e.jsx(_,{value:"Third Term",children:"Third Term"})]})]})]})]})})]}),e.jsxs(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:[e.jsx(me,{className:"p-4 border-b border-[#E5E7EB]",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-[#1F2937] font-semibold",children:["Compiled Results (",h.length,")"]}),e.jsxs(G,{className:"h-10 px-4 bg-[#10B981] text-white hover:bg-[#059669] rounded-lg shadow-clinical",children:[e.jsx(as,{className:"w-4 h-4 mr-2"}),"Export All"]})]})}),e.jsx(z,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(De,{children:[e.jsx(Be,{children:e.jsxs(xe,{className:"bg-[#F9FAFB]",children:[e.jsx(q,{className:"text-[#1F2937]",children:"Student"}),e.jsx(q,{className:"text-[#1F2937]",children:"Admission No."}),e.jsx(q,{className:"text-[#1F2937]",children:"Class"}),e.jsx(q,{className:"text-[#1F2937]",children:"Term"}),e.jsx(q,{className:"text-[#1F2937]",children:"Average"}),e.jsx(q,{className:"text-[#1F2937]",children:"Position"}),e.jsx(q,{className:"text-[#1F2937]",children:"Status"}),e.jsx(q,{className:"text-[#1F2937]",children:"Compiled Date"}),e.jsx(q,{className:"text-[#1F2937]",children:"Actions"})]})}),e.jsxs(Pe,{children:[h.map(D=>{const v=t.find(C=>C.id===D.studentId),H=r.find(C=>C.id===D.classId);return e.jsxs(xe,{className:"border-b border-[#E5E7EB]",children:[e.jsx(M,{className:"text-[#1F2937] font-medium",children:v?`${v.firstName} ${v.lastName}`:"Unknown"}),e.jsx(M,{className:"text-[#1F2937]",children:v==null?void 0:v.admissionNumber}),e.jsx(M,{className:"text-[#1F2937]",children:H==null?void 0:H.name}),e.jsx(M,{className:"text-[#1F2937]",children:D.term}),e.jsxs(M,{className:"text-[#1F2937] font-medium",children:[D.averageScore.toFixed(2),"%"]}),e.jsxs(M,{className:"text-[#1F2937]",children:[D.position,"/",D.totalStudents]}),e.jsx(M,{children:e.jsx(le,{className:`${D.status==="Approved"?"bg-[#10B981] text-white":D.status==="Submitted"?"bg-[#F59E0B] text-white":D.status==="Rejected"?"bg-[#EF4444] text-white":"bg-[#6B7280] text-white"} border-0`,children:D.status})}),e.jsx(M,{className:"text-[#6B7280]",children:D.compiledDate}),e.jsx(M,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(G,{onClick:()=>y(D.id),className:"h-8 px-3 bg-[#3B82F6] text-white hover:bg-[#2563EB] rounded-lg",children:e.jsx(rs,{className:"w-4 h-4"})}),e.jsx(G,{onClick:()=>A(D.id),className:"h-8 px-3 bg-[#10B981] text-white hover:bg-[#059669] rounded-lg",children:e.jsx(as,{className:"w-4 h-4"})})]})})]},D.id)}),h.length===0&&e.jsx(xe,{children:e.jsx(M,{colSpan:9,className:"text-center py-8 text-[#6B7280]",children:"No results found matching the selected filters"})})]})]})})})]})]})}function Nc(s,t=[]){let r=[];function l(a,N){const o=c.createContext(N);o.displayName=a+"Context";const g=r.length;r=[...r,N];const h=j=>{var H;const v=j,{scope:w,children:b}=v,y=X(v,["scope","children"]),A=((H=w==null?void 0:w[s])==null?void 0:H[g])||o,D=c.useMemo(()=>y,Object.values(y));return e.jsx(A.Provider,{value:D,children:b})};h.displayName=a+"Provider";function I(j,w){var A;const b=((A=w==null?void 0:w[s])==null?void 0:A[g])||o,y=c.useContext(b);if(y)return y;if(N!==void 0)return N;throw new Error(`\`${j}\` must be used within \`${a}\``)}return[h,I]}const i=()=>{const a=r.map(N=>c.createContext(N));return function(o){const g=(o==null?void 0:o[s])||a;return c.useMemo(()=>({[`__scope${s}`]:S(x({},o),{[s]:g})}),[o,g])}};return i.scopeName=s,[l,bc(i,...t)]}function bc(...s){const t=s[0];if(s.length===1)return t;const r=()=>{const l=s.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(a){const N=l.reduce((o,{useScope:g,scopeName:h})=>{const j=g(a)[`__scope${h}`];return x(x({},o),j)},{});return c.useMemo(()=>({[`__scope${t.scopeName}`]:N}),[N])}};return r.scopeName=t.scopeName,r}var fc=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],_a=fc.reduce((s,t)=>{const r=Tt(`Primitive.${t}`),l=c.forwardRef((i,a)=>{const h=i,{asChild:N}=h,o=X(h,["asChild"]),g=N?r:t;return typeof window!="undefined"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(g,S(x({},o),{ref:a}))});return l.displayName=`Primitive.${t}`,S(x({},s),{[t]:l})},{}),nt="Progress",ct=100,[vc]=Nc(nt),[wc,yc]=vc(nt),La=c.forwardRef((s,t)=>{const I=s,{__scopeProgress:r,value:l=null,max:i,getValueLabel:a=Cc}=I,N=X(I,["__scopeProgress","value","max","getValueLabel"]);(i||i===0)&&!Et(i)&&console.error(Fc(`${i}`,"Progress"));const o=Et(i)?i:ct;l!==null&&!At(l,o)&&console.error(Sc(`${l}`,"Progress"));const g=At(l,o)?l:null,h=Is(g)?a(g,o):void 0;return e.jsx(wc,{scope:r,value:g,max:o,children:e.jsx(_a.div,S(x({"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":Is(g)?g:void 0,"aria-valuetext":h,role:"progressbar","data-state":Va(g,o),"data-value":g!=null?g:void 0,"data-max":o},N),{ref:t}))})});La.displayName=nt;var Oa="ProgressIndicator",Ua=c.forwardRef((s,t)=>{var N;const a=s,{__scopeProgress:r}=a,l=X(a,["__scopeProgress"]),i=yc(Oa,r);return e.jsx(_a.div,S(x({"data-state":Va(i.value,i.max),"data-value":(N=i.value)!=null?N:void 0,"data-max":i.max},l),{ref:t}))});Ua.displayName=Oa;function Cc(s,t){return`${Math.round(s/t*100)}%`}function Va(s,t){return s==null?"indeterminate":s===t?"complete":"loading"}function Is(s){return typeof s=="number"}function Et(s){return Is(s)&&!isNaN(s)&&s>0}function At(s,t){return Is(s)&&!isNaN(s)&&s<=t&&s>=0}function Fc(s,t){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${ct}\`.`}function Sc(s,t){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${ct} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Ec=La,Ac=Ua;function Dc(l){var i=l,{className:s,value:t}=i,r=X(i,["className","value"]);return e.jsx(Ec,S(x({"data-slot":"progress",className:Ie("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",s)},r),{children:e.jsx(Ac,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}))}function Bc(){const{students:s,teachers:t,parents:r,accountants:l,classes:i,subjects:a,subjectAssignments:N,scores:o,affectiveDomains:g,psychomotorDomains:h,compiledResults:I,feeStructures:j,studentFeeBalances:w,payments:b,users:y,notifications:A,activityLogs:D,schoolSettings:v,currentTerm:H,currentAcademicYear:C}=ve(),[O,f]=c.useState(!1),[F,u]=c.useState(0),T=(te,Y)=>{const ne=te.map(Ne=>Y.map(fe=>{const be=Ne[fe];return Array.isArray(be)?`"${be.join(", ")}"`:typeof be=="object"&&be!==null?`"${JSON.stringify(be)}"`:typeof be=="string"?`"${be.replace(/"/g,'""')}"`:be||""}).join(","));return[Y.join(","),...ne].join(`
`)},L=(te,Y)=>{const ne=new Blob([te],{type:"text/csv;charset=utf-8;"}),Ne=URL.createObjectURL(ne),fe=document.createElement("a");fe.href=Ne,fe.download=Y,fe.click(),URL.revokeObjectURL(Ne)},ee=(te,Y)=>{const ne=JSON.stringify(te,null,2),Ne=new Blob([ne],{type:"application/json;charset=utf-8;"}),fe=URL.createObjectURL(Ne),be=document.createElement("a");be.href=fe,be.download=Y,be.click(),URL.revokeObjectURL(fe)},K=()=>{const Y=T(s,["id","firstName","lastName","admissionNumber","classId","className","level","parentId","dateOfBirth","gender","status","academicYear"]);L(Y,`students_${new Date().toISOString().split("T")[0]}.csv`),E.success(`Exported ${s.length} students`)},re=()=>{const Y=T(t,["id","firstName","lastName","employeeId","email","phone","qualification","specialization","status","isClassTeacher","classTeacherId"]);L(Y,`teachers_${new Date().toISOString().split("T")[0]}.csv`),E.success(`Exported ${t.length} teachers`)},ge=()=>{const Y=T(r,["id","firstName","lastName","email","phone","studentIds","status"]);L(Y,`parents_${new Date().toISOString().split("T")[0]}.csv`),E.success(`Exported ${r.length} parents`)},he=()=>{const Y=T(i,["id","name","level","section","capacity","currentStudents","classTeacherId","classTeacher","academicYear","status"]);L(Y,`classes_${new Date().toISOString().split("T")[0]}.csv`),E.success(`Exported ${i.length} classes`)},se=()=>{const Y=T(a,["id","name","code","department","isCore","status"]);L(Y,`subjects_${new Date().toISOString().split("T")[0]}.csv`),E.success(`Exported ${a.length} subjects`)},Z=()=>{const Y=T(N,["id","subjectId","subjectName","classId","className","teacherId","teacherName","academicYear","term"]);L(Y,`subject_assignments_${new Date().toISOString().split("T")[0]}.csv`),E.success(`Exported ${N.length} subject assignments`)},U=()=>{const Y=T(o,["id","studentId","subjectAssignmentId","subjectName","ca1","ca2","exam","total","classAverage","grade","remark","subjectTeacher","enteredBy","enteredDate","status"]);L(Y,`scores_${new Date().toISOString().split("T")[0]}.csv`),E.success(`Exported ${o.length} score entries`)},d=()=>{const Y=T(I,["id","studentId","classId","term","academicYear","totalScore","averageScore","classAverage","position","totalStudents","timesPresent","timesAbsent","totalAttendanceDays","classTeacherComment","principalComment","status"]);L(Y,`compiled_results_${new Date().toISOString().split("T")[0]}.csv`),E.success(`Exported ${I.length} compiled results`)},B=()=>{const Y=T(j,["id","classId","className","level","term","academicYear","tuitionFee","developmentLevy","sportsFee","examFee","booksFee","uniformFee","transportFee","totalFee"]);L(Y,`fee_structures_${new Date().toISOString().split("T")[0]}.csv`),E.success(`Exported ${j.length} fee structures`)},k=()=>{const Y=T(w,["id","studentId","classId","term","academicYear","totalFeeRequired","totalPaid","balance","status"]);L(Y,`student_fee_balances_${new Date().toISOString().split("T")[0]}.csv`),E.success(`Exported ${w.length} fee balance records`)},p=()=>{const Y=T(b,["id","studentId","studentName","amount","paymentType","term","academicYear","paymentMethod","reference","recordedBy","recordedDate","status","receiptNumber"]);L(Y,`payments_${new Date().toISOString().split("T")[0]}.csv`),E.success(`Exported ${b.length} payment records`)},Q=()=>{const Y=T(D,["id","actor","actorRole","action","target","timestamp","ip","status","details"]);L(Y,`activity_logs_${new Date().toISOString().split("T")[0]}.csv`),E.success(`Exported ${D.length} activity logs`)},W=()=>{const te=y.map(be=>{var Xe=be,{password:Ne}=Xe,fe=X(Xe,["password"]);return fe}),ne=T(te,["id","username","role","linkedId","email","status"]);L(ne,`users_${new Date().toISOString().split("T")[0]}.csv`),E.success(`Exported ${y.length} users (passwords excluded)`)},R=()=>{const Y=T(g,["id","studentId","classId","term","academicYear","attentiveness","attentivenessRemark","honesty","honestyRemark","neatness","neatnessRemark","obedience","obedienceRemark","senseOfResponsibility","senseOfResponsibilityRemark"]);L(Y,`affective_domains_${new Date().toISOString().split("T")[0]}.csv`),E.success(`Exported ${g.length} affective domain records`)},n=()=>{const Y=T(h,["id","studentId","classId","term","academicYear","attentionToDirection","attentionToDirectionRemark","considerateOfOthers","considerateOfOthersRemark","handwriting","handwritingRemark","sports","sportsRemark","verbalFluency","verbalFluencyRemark","worksWellIndependently","worksWellIndependentlyRemark"]);L(Y,`psychomotor_domains_${new Date().toISOString().split("T")[0]}.csv`),E.success(`Exported ${h.length} psychomotor domain records`)},m=()=>ue(this,null,function*(){f(!0),u(0);const te={metadata:{schoolName:v.schoolName,schoolMotto:v.schoolMotto,principalName:v.principalName,currentTerm:H,currentAcademicYear:C,backupDate:new Date().toISOString(),version:"1.0"},students:s,teachers:t,parents:r,accountants:l,classes:i,subjects:a,subjectAssignments:N,scores:o,affectiveDomains:g,psychomotorDomains:h,compiledResults:I,feeStructures:j,studentFeeBalances:w,payments:b,users:y.map(fe=>{var be=fe,{password:ne}=be,Ne=X(be,["password"]);return Ne}),notifications:A,activityLogs:D},Y=setInterval(()=>{u(ne=>ne>=90?(clearInterval(Y),ne):ne+10)},100);setTimeout(()=>{ee(te,`graceland_complete_backup_${new Date().toISOString().split("T")[0]}.json`),u(100),setTimeout(()=>{f(!1),u(0),E.success("Complete system backup downloaded successfully!")},500)},1500)}),P=[{title:"Student Data",icon:e.jsx(Me,{className:"w-5 h-5"}),items:[{name:"Students",count:s.length,export:K,color:"bg-blue-50 text-blue-600"},{name:"Student Fee Balances",count:w.length,export:k,color:"bg-blue-50 text-blue-600"}]},{title:"Staff Data",icon:e.jsx(pe,{className:"w-5 h-5"}),items:[{name:"Teachers",count:t.length,export:re,color:"bg-green-50 text-green-600"},{name:"Parents",count:r.length,export:ge,color:"bg-green-50 text-green-600"},{name:"Accountants",count:l.length,export:()=>{const Y=T(l,["id","firstName","lastName","employeeId","email","phone","department","status"]);L(Y,`accountants_${new Date().toISOString().split("T")[0]}.csv`),E.success(`Exported ${l.length} accountants`)},color:"bg-green-50 text-green-600"},{name:"User Accounts",count:y.length,export:W,color:"bg-green-50 text-green-600"}]},{title:"Academic Data",icon:e.jsx(As,{className:"w-5 h-5"}),items:[{name:"Classes",count:i.length,export:he,color:"bg-purple-50 text-purple-600"},{name:"Subjects",count:a.length,export:se,color:"bg-purple-50 text-purple-600"},{name:"Subject Assignments",count:N.length,export:Z,color:"bg-purple-50 text-purple-600"},{name:"Scores",count:o.length,export:U,color:"bg-purple-50 text-purple-600"},{name:"Compiled Results",count:I.length,export:d,color:"bg-purple-50 text-purple-600"},{name:"Affective Domains",count:g.length,export:R,color:"bg-purple-50 text-purple-600"},{name:"Psychomotor Domains",count:h.length,export:n,color:"bg-purple-50 text-purple-600"}]},{title:"Financial Data",icon:e.jsx(Ds,{className:"w-5 h-5"}),items:[{name:"Fee Structures",count:j.length,export:B,color:"bg-yellow-50 text-yellow-600"},{name:"Payments",count:b.length,export:p,color:"bg-yellow-50 text-yellow-600"}]},{title:"System Data",icon:e.jsx(Js,{className:"w-5 h-5"}),items:[{name:"Activity Logs",count:D.length,export:Q,color:"bg-gray-50 text-gray-600"},{name:"Notifications",count:A.length,export:()=>{const Y=T(A,["id","title","message","type","targetAudience","sentBy","sentDate","isRead"]);L(Y,`notifications_${new Date().toISOString().split("T")[0]}.csv`),E.success(`Exported ${A.length} notifications`)},color:"bg-gray-50 text-gray-600"}]}],J=s.length+t.length+r.length+i.length+a.length+o.length+I.length+b.length+j.length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-[#1F2937] mb-2",children:"Data Backup & Export"}),e.jsx("p",{className:"text-[#6B7280]",children:"Download all system data for backup and archival purposes"})]}),e.jsx(V,{className:"rounded-xl bg-gradient-to-r from-[#2563EB] to-[#3B82F6] border-0 shadow-lg",children:e.jsx(z,{className:"p-6",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Js,{className:"w-6 h-6 text-white"}),e.jsx("h3",{className:"text-white text-xl",children:"Complete System Backup"})]}),e.jsx("p",{className:"text-white/90 mb-4",children:"Download all data in a single JSON file for complete system backup"}),e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs(le,{className:"bg-white/20 text-white border-0 text-sm",children:[e.jsx($e,{className:"w-4 h-4 mr-1"}),J.toLocaleString()," Total Records"]}),e.jsx(le,{className:"bg-white/20 text-white border-0 text-sm",children:"17 Data Tables"})]}),O&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-white text-sm",children:"Preparing backup..."}),e.jsxs("span",{className:"text-white text-sm",children:[F,"%"]})]}),e.jsx(Dc,{value:F,className:"h-2 bg-white/20"})]}),e.jsxs(G,{onClick:m,disabled:O,className:"bg-white hover:bg-white/90 text-[#2563EB] rounded-xl shadow-md px-6",children:[e.jsx(as,{className:"w-5 h-5 mr-2"}),O?"Preparing Backup...":"Download Complete Backup (JSON)"]})]})})})}),e.jsxs(qe,{className:"bg-blue-50 border-blue-200 rounded-xl",children:[e.jsx(ye,{className:"h-4 w-4 text-blue-600"}),e.jsxs(Ge,{className:"text-[#1F2937]",children:[e.jsx("strong",{children:"Backup Best Practices:"})," Download regular backups to prevent data loss. Store backups in a secure location. Complete backup includes all system data in JSON format for easy restoration. Individual CSV exports are provided for specific data tables."]})]}),P.map((te,Y)=>e.jsxs(V,{className:"rounded-xl bg-white border border-[#E5E7EB] shadow-sm",children:[e.jsx(me,{className:"p-5 border-b border-[#E5E7EB]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-[#F3F4F6] rounded-lg",children:te.icon}),e.jsx("h3",{className:"text-[#1F2937]",children:te.title})]})}),e.jsx(z,{className:"p-5",children:e.jsx("div",{className:"grid md:grid-cols-2 gap-3",children:te.items.map((ne,Ne)=>e.jsxs("div",{className:`${ne.color} p-4 rounded-xl flex items-center justify-between`,children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-80 mb-1",children:ne.name}),e.jsxs("p",{className:"font-semibold text-lg",children:[ne.count.toLocaleString()," records"]})]}),e.jsxs(G,{onClick:ne.export,size:"sm",variant:"ghost",className:"hover:bg-white/50 rounded-lg",children:[e.jsx(as,{className:"w-4 h-4 mr-1"}),"CSV"]})]},Ne))})})]},Y)),e.jsx(V,{className:"rounded-xl bg-white border border-[#E5E7EB] shadow-sm",children:e.jsx(z,{className:"p-5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ye,{className:"w-5 h-5 text-[#6B7280] mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[#1F2937] mb-2",children:e.jsx("strong",{children:"About Data Export:"})}),e.jsxs("ul",{className:"text-[#6B7280] text-sm space-y-1",children:[e.jsx("li",{children:"• CSV files can be opened in Excel, Google Sheets, or any spreadsheet software"}),e.jsx("li",{children:"• JSON backup contains all data and can be used for system restoration"}),e.jsx("li",{children:"• User passwords are excluded from exports for security"}),e.jsx("li",{children:"• Backup files are named with today's date for easy identification"}),e.jsx("li",{children:"• Store backups securely and regularly (recommended: weekly backups)"})]})]})]})})})]})}function Pc(){const{activityLogs:s,getActivityLogs:t}=ve(),[r,l]=c.useState(""),[i,a]=c.useState("all"),[N,o]=c.useState("all"),h=t(i,N).filter(v=>v.actor.toLowerCase().includes(r.toLowerCase())||v.target.toLowerCase().includes(r.toLowerCase())||v.action.toLowerCase().includes(r.toLowerCase())),I=v=>v.includes("User")||v.includes("Create")?e.jsx(vt,{className:"w-4 h-4"}):v.includes("Password")?e.jsx(Ur,{className:"w-4 h-4"}):v.includes("Link")||v.includes("Unlink")?e.jsx(Oe,{className:"w-4 h-4"}):v.includes("Deactivate")||v.includes("Activate")?e.jsx(Qe,{className:"w-4 h-4"}):e.jsx(vt,{className:"w-4 h-4"}),j=v=>v.includes("Create")||v.includes("Add")?"bg-[#28A745]":v.includes("Password")||v.includes("Reset")?"bg-[#FFC107]":v.includes("Link")&&!v.includes("Unlink")?"bg-[#1E90FF]":v.includes("Delete")||v.includes("Unlink")||v.includes("Deactivate")?"bg-[#DC3545]":v.includes("Activate")||v.includes("Approve")?"bg-[#28A745]":"bg-[#C0C8D3]",w=()=>{const v=["Timestamp","Actor","Role","Action","Target","IP Address","Status"],H=h.map(u=>[new Date(u.timestamp).toLocaleString(),u.actor,u.actorRole,u.action,u.target,u.ip,u.status]),C=[v,...H].map(u=>u.join(",")).join(`
`),O=new Blob([C],{type:"text/csv"}),f=URL.createObjectURL(O),F=document.createElement("a");F.href=f,F.download=`activity-logs-${new Date().toISOString().split("T")[0]}.csv`,F.click(),E.success("Activity log exported successfully")},b=s.length,y=s.filter(v=>v.action.includes("Create User")||v.action.includes("Add")).length,A=s.filter(v=>v.action.includes("Link")).length,D=s.filter(v=>v.status==="Failed").length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-white mb-2",children:"Activity Logs"}),e.jsx("p",{className:"text-[#C0C8D3]",children:"Audit trail of all administrative actions"})]}),e.jsxs(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:[e.jsx(me,{className:"p-5 border-b border-white/10",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-md w-full",children:[e.jsx(Re,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#C0C8D3]"}),e.jsx(ae,{value:r,onChange:v=>l(v.target.value),placeholder:"Search by actor, action, or target...",className:"h-12 pl-10 rounded-xl border border-white/10 bg-[#0F243E] text-white"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 w-full lg:w-auto",children:[e.jsxs(ce,{value:i,onValueChange:a,children:[e.jsx(ie,{className:"h-12 w-full sm:w-48 rounded-xl border border-white/10 bg-[#0F243E] text-white",children:e.jsx(de,{placeholder:"Filter by action"})}),e.jsxs(oe,{className:"bg-[#0F243E] border-white/10",children:[e.jsx(_,{value:"all",className:"text-white hover:bg-[#1E90FF]",children:"All Actions"}),e.jsx(_,{value:"Create User",className:"text-white hover:bg-[#1E90FF]",children:"Create User"}),e.jsx(_,{value:"Reset Password",className:"text-white hover:bg-[#1E90FF]",children:"Reset Password"}),e.jsx(_,{value:"Link Student-Parent",className:"text-white hover:bg-[#1E90FF]",children:"Link Student-Parent"}),e.jsx(_,{value:"Unlink Student-Parent",className:"text-white hover:bg-[#1E90FF]",children:"Unlink Student-Parent"}),e.jsx(_,{value:"Deactivate User",className:"text-white hover:bg-[#1E90FF]",children:"Deactivate User"})]})]}),e.jsxs(ce,{value:N,onValueChange:o,children:[e.jsx(ie,{className:"h-12 w-full sm:w-36 rounded-xl border border-white/10 bg-[#0F243E] text-white",children:e.jsx(de,{placeholder:"Date range"})}),e.jsxs(oe,{className:"bg-[#0F243E] border-white/10",children:[e.jsx(_,{value:"all",className:"text-white hover:bg-[#1E90FF]",children:"All Time"}),e.jsx(_,{value:"today",className:"text-white hover:bg-[#1E90FF]",children:"Today"}),e.jsx(_,{value:"week",className:"text-white hover:bg-[#1E90FF]",children:"This Week"}),e.jsx(_,{value:"month",className:"text-white hover:bg-[#1E90FF]",children:"This Month"})]})]}),e.jsxs(G,{onClick:w,className:"h-12 bg-[#1E90FF] hover:bg-[#00BFFF] text-white rounded-xl shadow-md hover:scale-105 transition-all whitespace-nowrap",children:[e.jsx(as,{className:"w-5 h-5 mr-2"}),"Export Log"]})]})]})}),e.jsx(z,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(De,{children:[e.jsx(Be,{children:e.jsxs(xe,{className:"bg-gradient-to-r from-[#1E90FF] to-[#00BFFF] border-none hover:bg-gradient-to-r",children:[e.jsx(q,{className:"text-white",children:"Timestamp"}),e.jsx(q,{className:"text-white",children:"Actor"}),e.jsx(q,{className:"text-white",children:"Action"}),e.jsx(q,{className:"text-white",children:"Target"}),e.jsx(q,{className:"text-white",children:"IP Address"}),e.jsx(q,{className:"text-white",children:"Status"})]})}),e.jsx(Pe,{children:h.length===0?e.jsx(xe,{className:"bg-[#0F243E] border-b border-white/5",children:e.jsxs(M,{colSpan:6,className:"text-center py-12",children:[e.jsx("p",{className:"text-white mb-2",children:"No activity logs found"}),e.jsx("p",{className:"text-[#C0C8D3] text-sm",children:"Activity will be logged here automatically"})]})}):h.map(v=>e.jsxs(xe,{className:"bg-[#0F243E] border-b border-white/5 hover:bg-[#132C4A]",children:[e.jsx(M,{className:"text-[#C0C8D3] text-sm font-mono",children:new Date(v.timestamp).toLocaleString()}),e.jsx(M,{children:e.jsxs("div",{children:[e.jsx("p",{className:"text-white",children:v.actor}),e.jsx("p",{className:"text-xs text-[#C0C8D3]",children:v.actorRole})]})}),e.jsx(M,{children:e.jsxs(le,{className:`${j(v.action)} text-white border-0 flex items-center gap-1 w-fit`,children:[I(v.action),v.action]})}),e.jsx(M,{className:"text-white",children:v.target}),e.jsx(M,{className:"text-[#C0C8D3] text-sm font-mono",children:v.ip}),e.jsx(M,{children:e.jsx(le,{className:v.status==="Success"?"bg-[#28A745] text-white border-0":"bg-[#DC3545] text-white border-0",children:v.status})})]},v.id))})]})})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Qe,{className:"w-4 h-4 text-[#1E90FF]"}),e.jsx("p",{className:"text-[#C0C8D3] text-sm",children:"Total Actions"})]}),e.jsx("p",{className:"text-white text-xl",children:b})]})}),e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:e.jsxs(z,{className:"p-4",children:[e.jsx("p",{className:"text-[#C0C8D3] mb-1 text-sm",children:"Users Created"}),e.jsx("p",{className:"text-[#28A745] text-xl",children:y})]})}),e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:e.jsxs(z,{className:"p-4",children:[e.jsx("p",{className:"text-[#C0C8D3] mb-1 text-sm",children:"Links Created"}),e.jsx("p",{className:"text-[#1E90FF] text-xl",children:A})]})}),e.jsx(V,{className:"rounded-xl bg-[#132C4A] border border-white/10 shadow-lg",children:e.jsxs(z,{className:"p-4",children:[e.jsx("p",{className:"text-[#C0C8D3] mb-1 text-sm",children:"Failed Actions"}),e.jsx("p",{className:"text-[#DC3545] text-xl",children:D})]})})]})]})}function Ic(){const{feeStructures:s,classes:t,students:r,studentFeeBalances:l,payments:i}=ve(),[a,N]=c.useState("overview"),o=b=>{E.info(`Edit fee structure for ${b.className}`)},g=b=>{E.info(`View fee structure for ${b.className}`)},h=s.reduce((b,y)=>{var v;const A=t.find(H=>H.id===y.classId),D=(v=A==null?void 0:A.currentStudents)!=null?v:0;return b+y.totalFee*D},0),I=i.filter(b=>b.status==="Verified").reduce((b,y)=>b+y.amount,0),j=l.reduce((b,y)=>b+y.balance,0),w=l.filter(b=>b.balance>0).length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-[#1F2937] mb-2",children:"Fee Management"}),e.jsx("p",{className:"text-[#6B7280]",children:"Oversee fee structures and student payment status"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Expected Revenue"}),e.jsx(Qs,{className:"w-5 h-5 text-[#3B82F6]"})]}),e.jsxs("p",{className:"text-[#1F2937] mb-1 font-semibold",children:["₦",h.toLocaleString()]}),e.jsx("p",{className:"text-xs text-[#6B7280]",children:"This term"})]})}),e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Total Collected"}),e.jsx(Ds,{className:"w-5 h-5 text-[#10B981]"})]}),e.jsxs("p",{className:"text-[#1F2937] mb-1 font-semibold",children:["₦",I.toLocaleString()]}),e.jsxs("p",{className:"text-xs text-[#10B981]",children:[h>0?(I/h*100).toFixed(1):0,"% collected"]})]})}),e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Outstanding"}),e.jsx(ye,{className:"w-5 h-5 text-[#F59E0B]"})]}),e.jsxs("p",{className:"text-[#1F2937] mb-1 font-semibold",children:["₦",j.toLocaleString()]}),e.jsx("p",{className:"text-xs text-[#F59E0B]",children:"Unpaid balances"})]})}),e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Students w/ Balance"}),e.jsx(pe,{className:"w-5 h-5 text-[#EF4444]"})]}),e.jsx("p",{className:"text-[#1F2937] mb-1 font-semibold",children:w}),e.jsxs("p",{className:"text-xs text-[#6B7280]",children:["Out of ",r.length," students"]})]})})]}),e.jsxs("div",{className:"flex gap-2 border-b border-[#E5E7EB]",children:[e.jsx("button",{onClick:()=>N("overview"),className:`px-4 py-2 rounded-t-lg transition-all ${a==="overview"?"bg-[#3B82F6] text-white":"text-[#6B7280] hover:bg-[#F3F4F6]"}`,children:"Overview"}),e.jsx("button",{onClick:()=>N("structures"),className:`px-4 py-2 rounded-t-lg transition-all ${a==="structures"?"bg-[#3B82F6] text-white":"text-[#6B7280] hover:bg-[#F3F4F6]"}`,children:"Fee Structures"}),e.jsx("button",{onClick:()=>N("balances"),className:`px-4 py-2 rounded-t-lg transition-all ${a==="balances"?"bg-[#3B82F6] text-white":"text-[#6B7280] hover:bg-[#F3F4F6]"}`,children:"Student Balances"})]}),a==="structures"&&e.jsxs(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:[e.jsx(me,{className:"p-4 border-b border-[#E5E7EB]",children:e.jsx("h3",{className:"text-[#1F2937] font-semibold",children:"Fee Structures by Class"})}),e.jsx(z,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(De,{children:[e.jsx(Be,{children:e.jsxs(xe,{className:"bg-[#F9FAFB]",children:[e.jsx(q,{className:"text-[#1F2937]",children:"Class"}),e.jsx(q,{className:"text-[#1F2937]",children:"Tuition"}),e.jsx(q,{className:"text-[#1F2937]",children:"Development"}),e.jsx(q,{className:"text-[#1F2937]",children:"Exam"}),e.jsx(q,{className:"text-[#1F2937]",children:"Books"}),e.jsx(q,{className:"text-[#1F2937]",children:"Transport"}),e.jsx(q,{className:"text-[#1F2937]",children:"Total Fee"}),e.jsx(q,{className:"text-[#1F2937]",children:"Actions"})]})}),e.jsx(Pe,{children:s.map(b=>e.jsxs(xe,{className:"border-b border-[#E5E7EB]",children:[e.jsx(M,{className:"text-[#1F2937] font-medium",children:b.className}),e.jsxs(M,{className:"text-[#1F2937]",children:["₦",b.tuitionFee.toLocaleString()]}),e.jsxs(M,{className:"text-[#1F2937]",children:["₦",b.developmentLevy.toLocaleString()]}),e.jsxs(M,{className:"text-[#1F2937]",children:["₦",b.examFee.toLocaleString()]}),e.jsxs(M,{className:"text-[#1F2937]",children:["₦",b.booksFee.toLocaleString()]}),e.jsxs(M,{className:"text-[#1F2937]",children:["₦",b.transportFee.toLocaleString()]}),e.jsxs(M,{className:"text-[#1F2937] font-semibold",children:["₦",b.totalFee.toLocaleString()]}),e.jsx(M,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(G,{onClick:()=>o(b),className:"h-8 px-3 bg-[#3B82F6] text-white hover:bg-[#2563EB] rounded-lg",children:e.jsx(ls,{className:"w-4 h-4"})}),e.jsx(G,{onClick:()=>g(b),className:"h-8 px-3 bg-[#10B981] text-white hover:bg-[#059669] rounded-lg",children:e.jsx(rs,{className:"w-4 h-4"})})]})})]},b.id))})]})})})]}),a==="balances"&&e.jsxs(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:[e.jsx(me,{className:"p-4 border-b border-[#E5E7EB]",children:e.jsx("h3",{className:"text-[#1F2937] font-semibold",children:"Student Fee Balances"})}),e.jsx(z,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(De,{children:[e.jsx(Be,{children:e.jsxs(xe,{className:"bg-[#F9FAFB]",children:[e.jsx(q,{className:"text-[#1F2937]",children:"Student ID"}),e.jsx(q,{className:"text-[#1F2937]",children:"Student Name"}),e.jsx(q,{className:"text-[#1F2937]",children:"Class"}),e.jsx(q,{className:"text-[#1F2937]",children:"Total Fee"}),e.jsx(q,{className:"text-[#1F2937]",children:"Paid"}),e.jsx(q,{className:"text-[#1F2937]",children:"Balance"}),e.jsx(q,{className:"text-[#1F2937]",children:"Status"})]})}),e.jsx(Pe,{children:l.map(b=>{const y=r.find(A=>A.id===b.studentId);return e.jsxs(xe,{className:"border-b border-[#E5E7EB]",children:[e.jsx(M,{className:"text-[#1F2937]",children:y==null?void 0:y.admissionNumber}),e.jsx(M,{className:"text-[#1F2937] font-medium",children:y?`${y.firstName} ${y.lastName}`:"Unknown"}),e.jsx(M,{className:"text-[#1F2937]",children:y==null?void 0:y.className}),e.jsxs(M,{className:"text-[#1F2937]",children:["₦",b.totalFeeRequired.toLocaleString()]}),e.jsxs(M,{className:"text-[#10B981]",children:["₦",b.totalPaid.toLocaleString()]}),e.jsxs(M,{className:"text-[#EF4444] font-medium",children:["₦",b.balance.toLocaleString()]}),e.jsx(M,{children:e.jsx(le,{className:`${b.status==="Paid"?"bg-[#10B981] text-white":b.status==="Partial"?"bg-[#F59E0B] text-white":"bg-[#EF4444] text-white"} border-0`,children:b.status})})]},b.id)})})]})})})]}),a==="overview"&&e.jsxs("div",{className:"grid lg:grid-cols-2 gap-4",children:[e.jsxs(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:[e.jsx(me,{className:"p-4 border-b border-[#E5E7EB]",children:e.jsx("h3",{className:"text-[#1F2937] font-semibold",children:"Collection Rate by Class"})}),e.jsx(z,{className:"p-4 space-y-3",children:t.slice(0,5).map(b=>{const y=s.find(O=>O.classId===b.id),A=r.filter(O=>O.classId===b.id),D=l.filter(O=>O.classId===b.id),v=y?y.totalFee*A.length:0,H=D.reduce((O,f)=>O+f.totalPaid,0),C=v>0?H/v*100:0;return e.jsxs("div",{className:"p-3 bg-[#F9FAFB] rounded-lg border border-[#E5E7EB]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-[#1F2937] font-medium",children:b.name}),e.jsxs("span",{className:"text-[#3B82F6] font-medium",children:[C.toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full bg-[#E5E7EB] rounded-full h-2",children:e.jsx("div",{className:"bg-[#3B82F6] h-2 rounded-full transition-all",style:{width:`${C}%`}})})]},b.id)})})]}),e.jsxs(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:[e.jsx(me,{className:"p-4 border-b border-[#E5E7EB]",children:e.jsx("h3",{className:"text-[#1F2937] font-semibold",children:"Recent Payment Activity"})}),e.jsx(z,{className:"p-4 space-y-3",children:i.slice(-5).reverse().map(b=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#F9FAFB] rounded-lg border border-[#E5E7EB]",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[#1F2937] font-medium",children:b.studentName}),e.jsx("p",{className:"text-xs text-[#6B7280]",children:b.recordedDate})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-[#10B981] font-medium",children:["₦",b.amount.toLocaleString()]}),e.jsx(le,{className:`${b.status==="Verified"?"bg-[#10B981]":"bg-[#F59E0B]"} text-white border-0 text-xs`,children:b.status})]})]},b.id))})]})]})]})}function Xc(){var se,Z,U;const{logout:s,permissions:t}=mt(),{user:r}=mt(),{students:l,teachers:i,getPendingApprovals:a,currentUser:N,getUnreadNotifications:o}=ve(),[g,h]=c.useState("dashboard"),[I,j]=c.useState(null),[w,b]=c.useState(null),[y,A]=c.useState(!0),[D,v]=c.useState(null),[H,C]=c.useState(!1),[O,f]=c.useState(null),F=(N==null?void 0:N.permissions)||[];c.useEffect(()=>{ue(this,null,function*(){try{A(!0);const[B,k]=yield Promise.all([Ys.getActive(),Ks.getActive()]);j(B),b(k)}catch(B){console.error("Error fetching session/term:",B),j({name:"2024/2025"}),b({name:"Second Term",status:"In Progress"})}finally{A(!1)}})},[]),c.useEffect(()=>{ue(this,null,function*(){try{C(!0);const B=yield ut.getDashboardData();v(B)}catch(B){console.error("Error fetching dashboard stats:",B),f((B==null?void 0:B.message)||"Failed to load dashboard statistics")}finally{C(!1)}})},[]);const u=()=>ue(this,null,function*(){f(null);try{C(!0);const d=yield ut.getDashboardData();v(d),f(null)}catch(d){console.error("Error retrying dashboard stats:",d),f((d==null?void 0:d.message)||"Failed to load dashboard statistics")}finally{C(!1)}}),T=l.filter(d=>d.status==="Active").length,L=i.filter(d=>d.status==="Active").length,ee=a().length,K=N?o(N.id,N.role):[],re=[{icon:e.jsx(rr,{className:"w-5 h-5"}),label:"Dashboard",id:"dashboard"},...t.canManageUsers?[{icon:e.jsx(_e,{className:"w-5 h-5"}),label:"Register User",id:"register-user"},{icon:e.jsx(pe,{className:"w-5 h-5"}),label:"Manage Teachers",id:"manage-teachers"},{icon:e.jsx(pe,{className:"w-5 h-5"}),label:"Manage Parents",id:"manage-parents"}]:[],...t.canManageStudents?[{icon:e.jsx(Me,{className:"w-5 h-5"}),label:"Add Student",id:"add-student"},{icon:e.jsx(pe,{className:"w-5 h-5"}),label:"Manage Students",id:"manage-students"},{icon:e.jsx(Oe,{className:"w-5 h-5"}),label:"Link Student-Parent",id:"link-student-parent"}]:[],...t.canManageClasses?[{icon:e.jsx(we,{className:"w-5 h-5"}),label:"Manage Classes",id:"manage-classes"}]:[],...t.canManageSubjects?[{icon:e.jsx(qr,{className:"w-5 h-5"}),label:"Manage Subjects",id:"manage-subjects"},{icon:e.jsx(we,{className:"w-5 h-5"}),label:"Subject Registration",id:"subject-registration"}]:[],...t.canManageAssignments?[{icon:e.jsx(cs,{className:"w-5 h-5"}),label:"Teacher Assignments",id:"teacher-assignments"}]:[],...t.canApproveResults?[{icon:e.jsx($e,{className:"w-5 h-5"}),label:"Approve Results",id:"approve-results"}]:[],...t.canViewReports?[{icon:e.jsx(dr,{className:"w-5 h-5"}),label:"View All Results",id:"view-results"}]:[],...t.canManagePayments?[{icon:e.jsx(Ds,{className:"w-5 h-5"}),label:"Fee Management",id:"fee-management"}]:[],{icon:e.jsx(Er,{className:"w-5 h-5"}),label:"Notifications",id:"send-notifications"},{icon:e.jsx(Es,{className:"w-5 h-5"}),label:"View Notifications",id:"notifications"},...t.canManageSettings?[{icon:e.jsx(Br,{className:"w-5 h-5"}),label:"Activity Logs",id:"activity-logs"},{icon:e.jsx(Js,{className:"w-5 h-5"}),label:"Data Backup",id:"data-backup"},{icon:e.jsx(zs,{className:"w-5 h-5"}),label:"Settings",id:"settings"}]:[]].filter(Boolean),ge=d=>{d==="logout"?s():h(d)},he=(r==null?void 0:r.name)||"Administrator";return e.jsxs("div",{className:"min-h-screen bg-[#F4F6F9]",children:[e.jsx(lr,{items:re,activeItem:g,onItemClick:ge}),e.jsxs("div",{className:"lg:pl-64",children:[e.jsx(nr,{userName:he,userRole:(r==null?void 0:r.role)||"admin",notificationCount:K.length,onLogout:s,onNotificationClick:()=>h("notifications")}),e.jsxs("main",{className:"p-4 md:p-6 max-w-7xl mx-auto",children:[g==="dashboard"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-[#1F2937] mb-2",children:"Admin Dashboard"}),e.jsx("p",{className:"text-[#6B7280]",children:"System Overview & Management"})]}),H?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(4)].map((d,B)=>e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-3"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded"})]})})},B))}):O?e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-red-800 font-semibold",children:"Error Loading Dashboard"}),e.jsx("p",{className:"text-red-600 text-sm",children:O})]}),e.jsx(G,{onClick:u,size:"sm",variant:"outline",children:"Retry"})]})}):D?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Total Users"}),e.jsx(pe,{className:"w-5 h-5 text-[#3B82F6]"})]}),e.jsx("p",{className:"text-[#1F2937] mb-1 font-semibold",children:D.totalUsers})]})}),e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Registered Students"}),e.jsx(Me,{className:"w-5 h-5 text-[#10B981]"})]}),e.jsx("p",{className:"text-[#1F2937] mb-1 font-semibold",children:D.totalStudents})]})}),e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Classes"}),e.jsx(we,{className:"w-5 h-5 text-[#6366F1]"})]}),e.jsx("p",{className:"text-[#1F2937] mb-1 font-semibold",children:D.totalClasses})]})}),e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Total Payments"}),e.jsx(Ds,{className:"w-5 h-5 text-[#10B981]"})]}),e.jsxs("p",{className:"text-[#1F2937] mb-1 font-semibold",children:["₦",D.totalPayments.toLocaleString()]})]})})]}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"No dashboard data available"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical hover:shadow-clinical-lg transition-all hover-lift group cursor-pointer",onClick:()=>h("manage-students"),children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Total Students"}),e.jsx(pe,{className:"w-5 h-5 text-[#3B82F6] group-hover:scale-110 transition-transform"})]}),e.jsx("p",{className:"text-[#1F2937] mb-1 font-semibold",children:T}),e.jsx("p",{className:"text-xs text-[#10B981]",children:"Active students"})]})}),e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical hover:shadow-clinical-lg transition-all hover-lift group cursor-pointer",onClick:()=>h("manage-teachers"),children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Teaching Staff"}),e.jsx(Me,{className:"w-5 h-5 text-[#10B981] group-hover:scale-110 transition-transform"})]}),e.jsx("p",{className:"text-[#1F2937] mb-1 font-semibold",children:L}),e.jsx("p",{className:"text-xs text-[#10B981]",children:"Active teachers"})]})}),e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical hover:shadow-clinical-lg transition-all hover-lift group cursor-pointer",onClick:()=>h("approve-results"),children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Pending Results"}),e.jsx(As,{className:"w-5 h-5 text-[#F59E0B] group-hover:scale-110 transition-transform"})]}),e.jsx("p",{className:"text-[#1F2937] mb-1 font-semibold",children:ee}),e.jsx("p",{className:"text-xs text-[#F59E0B]",children:ee>0?"Awaiting approval":"All approved"})]})}),e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical hover:shadow-clinical-lg transition-all hover-lift group cursor-pointer",onClick:()=>h("notifications"),children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Notifications"}),e.jsx(Es,{className:"w-5 h-5 text-[#3B82F6] group-hover:scale-110 transition-transform"})]}),e.jsx("p",{className:"text-[#1F2937] mb-1 font-semibold",children:K.length}),e.jsx("p",{className:"text-xs text-[#6B7280]",children:"Unread messages"})]})})]}),e.jsxs(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:[e.jsx(me,{className:"bg-[#3B82F6] rounded-t-lg p-4 border-b border-[#E5E7EB]",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-white font-semibold",children:"Active Session & Term"}),e.jsx(le,{className:"bg-[#10B981] text-white border-0 text-xs",children:y?"Loading...":"Active"})]})}),e.jsx(z,{className:"p-4",children:y?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(Ms,{className:"w-5 h-5 text-[#3B82F6] animate-spin mr-2"}),e.jsx("p",{className:"text-[#6B7280]",children:"Loading session and term..."})]}):e.jsxs("div",{className:"grid md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-3 bg-[#F9FAFB] rounded-lg border border-[#E5E7EB]",children:[e.jsx("p",{className:"text-[#6B7280] mb-1 text-sm",children:"Academic Session"}),e.jsx("p",{className:"text-[#1F2937] font-medium",children:(I==null?void 0:I.name)||"2024/2025"})]}),e.jsxs("div",{className:"p-3 bg-[#F9FAFB] rounded-lg border border-[#E5E7EB]",children:[e.jsx("p",{className:"text-[#6B7280] mb-1 text-sm",children:"Current Term"}),e.jsx("p",{className:"text-[#1F2937] font-medium",children:(w==null?void 0:w.name)||"Second Term"})]}),e.jsxs("div",{className:"p-3 bg-[#F9FAFB] rounded-lg border border-[#E5E7EB]",children:[e.jsx("p",{className:"text-[#6B7280] mb-1 text-sm",children:"Status"}),e.jsx("p",{className:"text-[#10B981] font-medium",children:(w==null?void 0:w.status)||"In Progress"})]})]})})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:[e.jsx(me,{className:"border-b border-[#E5E7EB] p-5",children:e.jsxs("h3",{className:"text-[#1F2937] font-semibold flex items-center gap-2",children:[e.jsx(zs,{className:"w-5 h-5 text-[#3B82F6]"}),"My Administrative Responsibilities"]})}),e.jsxs(z,{className:"p-5 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-[#DBEAFE] rounded-lg border border-[#3B82F6]/20",children:[e.jsx(_e,{className:"w-5 h-5 text-[#3B82F6]"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[#1F2937] font-medium text-sm",children:"User Management"}),e.jsx("p",{className:"text-[#6B7280] text-xs",children:"Register and manage all system users"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-[#D1FAE5] rounded-lg border border-[#10B981]/20",children:[e.jsx(Me,{className:"w-5 h-5 text-[#10B981]"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[#1F2937] font-medium text-sm",children:"Student Administration"}),e.jsx("p",{className:"text-[#6B7280] text-xs",children:"Manage student records and enrollment"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-[#FEF3C7] rounded-lg border border-[#F59E0B]/20",children:[e.jsx($e,{className:"w-5 h-5 text-[#F59E0B]"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[#1F2937] font-medium text-sm",children:"Results Approval"}),e.jsx("p",{className:"text-[#6B7280] text-xs",children:"Review and approve academic results"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-[#F3F4F6] rounded-lg border border-[#6B7280]/20",children:[e.jsx(we,{className:"w-5 h-5 text-[#6B7280]"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[#1F2937] font-medium text-sm",children:"Academic Configuration"}),e.jsx("p",{className:"text-[#6B7280] text-xs",children:"Setup classes, subjects, and assignments"})]})]})]})]}),e.jsxs(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical",children:[e.jsx(me,{className:"border-b border-[#E5E7EB] p-5",children:e.jsxs("h3",{className:"text-[#1F2937] font-semibold flex items-center gap-2",children:[e.jsx(Qe,{className:"w-5 h-5 text-[#10B981]"}),"System Access & Permissions"]})}),e.jsxs(z,{className:"p-5 space-y-3",children:[F.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Qe,{className:"w-12 h-12 text-[#9CA3AF] mx-auto mb-3"}),e.jsx("p",{className:"text-[#6B7280]",children:"No specific permissions assigned"}),e.jsx("p",{className:"text-[#9CA3AF] text-sm mt-1",children:"Contact administrator to get permissions"})]}):F.map((d,B)=>{const k=Q=>Q.includes("User")?e.jsx(_e,{className:"w-5 h-5 text-[#3B82F6]"}):Q.includes("Student")?e.jsx(Me,{className:"w-5 h-5 text-[#10B981]"}):Q.includes("Result")?e.jsx($e,{className:"w-5 h-5 text-[#F59E0B]"}):Q.includes("Academic")?e.jsx(we,{className:"w-5 h-5 text-[#6B7280]"}):Q.includes("System")?e.jsx(zs,{className:"w-5 h-5 text-[#8B5CF6]"}):e.jsx(Qe,{className:"w-5 h-5 text-[#007C91]"}),p=Q=>Q.includes("User")?"bg-[#DBEAFE] border-[#3B82F6]/20":Q.includes("Student")?"bg-[#D1FAE5] border-[#10B981]/20":Q.includes("Result")?"bg-[#FEF3C7] border-[#F59E0B]/20":Q.includes("Academic")?"bg-[#F3F4F6] border-[#6B7280]/20":Q.includes("System")?"bg-[#EDE9FE] border-[#8B5CF6]/20":"bg-[#E0F2FE] border-[#007C91]/20";return e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg border ${p(d)}`,children:[k(d),e.jsxs("div",{children:[e.jsx("p",{className:"text-[#1F2937] font-medium text-sm",children:d}),e.jsxs("p",{className:"text-[#6B7280] text-xs",children:[d.includes("User")&&"Manage user accounts and permissions",d.includes("Student")&&"Handle student enrollment and records",d.includes("Result")&&"Approve and manage academic results",d.includes("Academic")&&"Configure classes and subjects",d.includes("System")&&"Access system settings and configuration"]})]})]},B)}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-[#E0F2FE] rounded-lg border border-[#007C91]/20",children:[e.jsx(Qe,{className:"w-5 h-5 text-[#007C91]"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[#1F2937] font-medium text-sm",children:"Full System Access"}),e.jsx("p",{className:"text-[#6B7280] text-xs",children:"Complete administrative privileges"})]})]})]})]})]}),e.jsx(V,{className:"rounded-lg bg-gradient-to-r from-[#3B82F6]/10 to-[#2563EB]/5 border border-[#3B82F6]/20",children:e.jsx(z,{className:"p-5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx($e,{className:"w-6 h-6 text-[#3B82F6] mt-1 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[#1F2937] font-medium mb-2",children:"Quick Actions Available"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-3 bg-white rounded-lg border border-[#E5E7EB]",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Use floating buttons (bottom right) for quick access to:"}),e.jsxs("ul",{className:"text-xs text-[#1F2937] mt-2 space-y-1",children:[e.jsx("li",{children:"• Register New User"}),e.jsx("li",{children:"• Add Student"}),e.jsx("li",{children:"• Approve Results"})]})]}),e.jsxs("div",{className:"p-3 bg-white rounded-lg border border-[#E5E7EB]",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"Use sidebar menu to:"}),e.jsxs("ul",{className:"text-xs text-[#1F2937] mt-2 space-y-1",children:[e.jsx("li",{children:"• Manage all users"}),e.jsx("li",{children:"• Configure classes & subjects"}),e.jsx("li",{children:"• Set teacher assignments"})]})]}),e.jsxs("div",{className:"p-3 bg-white rounded-lg border border-[#E5E7EB]",children:[e.jsx("p",{className:"text-[#6B7280] text-sm",children:"System features:"}),e.jsxs("ul",{className:"text-xs text-[#1F2937] mt-2 space-y-1",children:[e.jsx("li",{children:"• Real-time notifications"}),e.jsx("li",{children:"• Student promotion"}),e.jsx("li",{children:"• Results approval workflow"})]})]})]})]})]})})}),e.jsxs("div",{className:"fixed bottom-6 right-6 flex flex-col gap-3 z-30",children:[e.jsx(G,{onClick:()=>h("register-user"),className:"w-12 h-12 rounded-lg bg-[#F59E0B] hover:bg-[#D97706] shadow-lg hover:shadow-xl transition-all hover-lift",title:"Register User",children:e.jsx(_e,{className:"w-5 h-5 text-white"})}),e.jsx(G,{onClick:()=>h("add-student"),className:"w-12 h-12 rounded-lg bg-[#3B82F6] hover:bg-[#2563EB] shadow-lg hover:shadow-xl transition-all hover-lift",title:"Add Student",children:e.jsx(Me,{className:"w-5 h-5 text-white"})}),e.jsx(G,{onClick:()=>h("approve-results"),className:"w-12 h-12 rounded-lg bg-[#10B981] hover:bg-[#059669] shadow-lg hover:shadow-xl transition-all hover-lift",title:"Approve Results",children:e.jsx($e,{className:"w-5 h-5 text-white"})})]})]}),e.jsxs(jt,{children:[g==="register-user"&&e.jsx(Jr,{}),g==="add-student"&&e.jsx(Wr,{}),g==="manage-students"&&e.jsx(wt,{onNavigateToLink:()=>h("link-student-parent")}),g==="manage-teachers"&&e.jsx(yt,{}),g==="manage-parents"&&e.jsx(Ct,{onNavigateToLink:()=>h("link-student-parent")}),g==="manage-classes"&&null,g==="create-class"&&e.jsx(uc,{onBack:()=>h("manage-classes"),onSuccess:()=>h("manage-classes")}),g==="manage-students"&&e.jsx(wt,{onNavigateToLink:()=>h("link-student-parent")}),g==="manage-teachers"&&e.jsx(yt,{}),g==="manage-parents"&&e.jsx(Ct,{onNavigateToLink:()=>h("link-student-parent")}),g==="manage-classes"&&e.jsx(dc,{onNavigateToCreate:()=>h("create-class")}),g==="manage-subjects"&&e.jsx(hc,{}),g==="subject-registration"&&e.jsx(mc,{}),g==="teacher-assignments"&&e.jsx(gc,{}),g==="promotion-system"&&e.jsx(jc,{}),g==="approve-results"&&e.jsx(fl,{}),g==="view-results"&&e.jsx(pc,{}),g==="link-student-parent"&&e.jsx(Ml,{}),g==="fee-management"&&e.jsx(Ic,{}),g==="send-notifications"&&e.jsx(bl,{}),g==="notifications"&&e.jsx(cr,{}),g==="activity-logs"&&e.jsx(Pc,{})]}),e.jsxs(jt,{children:[g==="data-backup"&&e.jsx(Bc,{}),g==="settings"&&e.jsx(Al,{})]}),!["dashboard","register-user","add-student","manage-students","manage-teachers","manage-parents","manage-classes","manage-subjects","subject-registration","teacher-assignments","promotion-system","approve-results","view-results","link-student-parent","fee-management","send-notifications","notifications","activity-logs","data-backup","settings"].includes(g)&&e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(V,{className:"rounded-lg bg-white border border-[#E5E7EB] shadow-clinical max-w-md w-full",children:e.jsxs(z,{className:"p-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-lg bg-[#3B82F6] flex items-center justify-center mx-auto mb-4",children:(se=re.find(d=>d.id===g))==null?void 0:se.icon}),e.jsx("h3",{className:"text-[#1F2937] mb-3 font-semibold",children:(Z=re.find(d=>d.id===g))==null?void 0:Z.label}),e.jsxs("p",{className:"text-[#6B7280]",children:["This section contains the functionality for ",(U=re.find(d=>d.id===g))==null?void 0:U.label.toLowerCase(),"."]})]})})})})]})]})]})}export{Xc as AdminDashboard};
